diff --git a/apps/frontend/config/error/error.html.php b/apps/frontend/config/error/error.html.php
old mode 100644
new mode 100755
diff --git a/apps/frontend/lib/aws_sdk/README.md b/apps/frontend/lib/aws_sdk/README.md
old mode 100644
new mode 100755
diff --git a/apps/frontend/lib/aws_sdk/_compatibility_test/README.md b/apps/frontend/lib/aws_sdk/_compatibility_test/README.md
old mode 100644
new mode 100755
diff --git a/apps/frontend/lib/aws_sdk/_compatibility_test/sdk_compatibility.inc.php b/apps/frontend/lib/aws_sdk/_compatibility_test/sdk_compatibility.inc.php
old mode 100644
new mode 100755
diff --git a/apps/frontend/lib/aws_sdk/_compatibility_test/sdk_compatibility_test.php b/apps/frontend/lib/aws_sdk/_compatibility_test/sdk_compatibility_test.php
old mode 100644
new mode 100755
diff --git a/apps/frontend/lib/aws_sdk/_docs/CHANGELOG.md b/apps/frontend/lib/aws_sdk/_docs/CHANGELOG.md
old mode 100644
new mode 100755
diff --git a/apps/frontend/lib/aws_sdk/_docs/CONTRIBUTORS.md b/apps/frontend/lib/aws_sdk/_docs/CONTRIBUTORS.md
old mode 100644
new mode 100755
diff --git a/apps/frontend/lib/aws_sdk/_docs/DYNAMODBSESSIONHANDLER.html b/apps/frontend/lib/aws_sdk/_docs/DYNAMODBSESSIONHANDLER.html
old mode 100644
new mode 100755
diff --git a/apps/frontend/lib/aws_sdk/_docs/KNOWNISSUES.md b/apps/frontend/lib/aws_sdk/_docs/KNOWNISSUES.md
old mode 100644
new mode 100755
diff --git a/apps/frontend/lib/aws_sdk/_docs/LICENSE.md b/apps/frontend/lib/aws_sdk/_docs/LICENSE.md
old mode 100644
new mode 100755
diff --git a/apps/frontend/lib/aws_sdk/_docs/NOTICE.md b/apps/frontend/lib/aws_sdk/_docs/NOTICE.md
old mode 100644
new mode 100755
diff --git a/apps/frontend/lib/aws_sdk/_docs/STREAMWRAPPER_README.html b/apps/frontend/lib/aws_sdk/_docs/STREAMWRAPPER_README.html
old mode 100644
new mode 100755
diff --git a/apps/frontend/lib/aws_sdk/_docs/WHERE_IS_THE_API_REFERENCE.md b/apps/frontend/lib/aws_sdk/_docs/WHERE_IS_THE_API_REFERENCE.md
old mode 100644
new mode 100755
diff --git a/apps/frontend/lib/aws_sdk/_samples/AmazonSimpleWorkflow/cron/BasicActivityWorker.php b/apps/frontend/lib/aws_sdk/_samples/AmazonSimpleWorkflow/cron/BasicActivityWorker.php
old mode 100644
new mode 100755
diff --git a/apps/frontend/lib/aws_sdk/_samples/AmazonSimpleWorkflow/cron/BasicWorkflowWorker.php b/apps/frontend/lib/aws_sdk/_samples/AmazonSimpleWorkflow/cron/BasicWorkflowWorker.php
old mode 100644
new mode 100755
diff --git a/apps/frontend/lib/aws_sdk/_samples/AmazonSimpleWorkflow/cron/HistoryEventIterator.php b/apps/frontend/lib/aws_sdk/_samples/AmazonSimpleWorkflow/cron/HistoryEventIterator.php
old mode 100644
new mode 100755
diff --git a/apps/frontend/lib/aws_sdk/_samples/AmazonSimpleWorkflow/cron/LICENSE b/apps/frontend/lib/aws_sdk/_samples/AmazonSimpleWorkflow/cron/LICENSE
old mode 100644
new mode 100755
diff --git a/apps/frontend/lib/aws_sdk/_samples/AmazonSimpleWorkflow/cron/README.md b/apps/frontend/lib/aws_sdk/_samples/AmazonSimpleWorkflow/cron/README.md
old mode 100644
new mode 100755
diff --git a/apps/frontend/lib/aws_sdk/_samples/AmazonSimpleWorkflow/cron/cron_example_utils.php b/apps/frontend/lib/aws_sdk/_samples/AmazonSimpleWorkflow/cron/cron_example_utils.php
old mode 100644
new mode 100755
diff --git a/apps/frontend/lib/aws_sdk/_samples/AmazonSimpleWorkflow/cron/start_cron_example_activity_workers.php b/apps/frontend/lib/aws_sdk/_samples/AmazonSimpleWorkflow/cron/start_cron_example_activity_workers.php
old mode 100644
new mode 100755
diff --git a/apps/frontend/lib/aws_sdk/_samples/AmazonSimpleWorkflow/cron/start_cron_example_workflow.php b/apps/frontend/lib/aws_sdk/_samples/AmazonSimpleWorkflow/cron/start_cron_example_workflow.php
old mode 100644
new mode 100755
diff --git a/apps/frontend/lib/aws_sdk/_samples/AmazonSimpleWorkflow/cron/start_cron_example_workflow_workers.php b/apps/frontend/lib/aws_sdk/_samples/AmazonSimpleWorkflow/cron/start_cron_example_workflow_workers.php
old mode 100644
new mode 100755
diff --git a/apps/frontend/lib/aws_sdk/_samples/README.md b/apps/frontend/lib/aws_sdk/_samples/README.md
old mode 100644
new mode 100755
diff --git a/apps/frontend/lib/aws_sdk/_samples/html-dynamodb_sessions_login.php b/apps/frontend/lib/aws_sdk/_samples/html-dynamodb_sessions_login.php
old mode 100644
new mode 100755
diff --git a/apps/frontend/lib/aws_sdk/_samples/lib/ProgressBar.php b/apps/frontend/lib/aws_sdk/_samples/lib/ProgressBar.php
old mode 100644
new mode 100755
diff --git a/apps/frontend/lib/aws_sdk/_samples/test_files/audio.wav b/apps/frontend/lib/aws_sdk/_samples/test_files/audio.wav
old mode 100644
new mode 100755
diff --git a/apps/frontend/lib/aws_sdk/_samples/test_files/plain.txt b/apps/frontend/lib/aws_sdk/_samples/test_files/plain.txt
old mode 100644
new mode 100755
diff --git a/apps/frontend/lib/aws_sdk/_samples/test_files/video.mp4 b/apps/frontend/lib/aws_sdk/_samples/test_files/video.mp4
old mode 100644
new mode 100755
diff --git a/apps/frontend/lib/aws_sdk/_samples/test_files/word.doc b/apps/frontend/lib/aws_sdk/_samples/test_files/word.doc
old mode 100644
new mode 100755
diff --git a/apps/frontend/lib/aws_sdk/authentication/signable.interface.php b/apps/frontend/lib/aws_sdk/authentication/signable.interface.php
old mode 100644
new mode 100755
diff --git a/apps/frontend/lib/aws_sdk/authentication/signature_v2query.class.php b/apps/frontend/lib/aws_sdk/authentication/signature_v2query.class.php
old mode 100644
new mode 100755
diff --git a/apps/frontend/lib/aws_sdk/authentication/signature_v3json.class.php b/apps/frontend/lib/aws_sdk/authentication/signature_v3json.class.php
old mode 100644
new mode 100755
diff --git a/apps/frontend/lib/aws_sdk/authentication/signature_v3query.class.php b/apps/frontend/lib/aws_sdk/authentication/signature_v3query.class.php
old mode 100644
new mode 100755
diff --git a/apps/frontend/lib/aws_sdk/authentication/signature_v4json.class.php b/apps/frontend/lib/aws_sdk/authentication/signature_v4json.class.php
old mode 100644
new mode 100755
diff --git a/apps/frontend/lib/aws_sdk/authentication/signature_v4query.class.php b/apps/frontend/lib/aws_sdk/authentication/signature_v4query.class.php
old mode 100644
new mode 100755
diff --git a/apps/frontend/lib/aws_sdk/authentication/signer.abstract.php b/apps/frontend/lib/aws_sdk/authentication/signer.abstract.php
old mode 100644
new mode 100755
diff --git a/apps/frontend/lib/aws_sdk/composer.json b/apps/frontend/lib/aws_sdk/composer.json
old mode 100644
new mode 100755
diff --git a/apps/frontend/lib/aws_sdk/extensions/dynamodbsessionhandler.class.php b/apps/frontend/lib/aws_sdk/extensions/dynamodbsessionhandler.class.php
old mode 100644
new mode 100755
diff --git a/apps/frontend/lib/aws_sdk/extensions/s3browserupload.class.php b/apps/frontend/lib/aws_sdk/extensions/s3browserupload.class.php
old mode 100644
new mode 100755
diff --git a/apps/frontend/lib/aws_sdk/extensions/s3streamwrapper.class.php b/apps/frontend/lib/aws_sdk/extensions/s3streamwrapper.class.php
old mode 100644
new mode 100755
diff --git a/apps/frontend/lib/aws_sdk/lib/dom/ArrayToDOMDocument.php b/apps/frontend/lib/aws_sdk/lib/dom/ArrayToDOMDocument.php
old mode 100644
new mode 100755
diff --git a/apps/frontend/lib/aws_sdk/lib/dom/Transmogrifier.php b/apps/frontend/lib/aws_sdk/lib/dom/Transmogrifier.php
old mode 100644
new mode 100755
diff --git a/apps/frontend/lib/aws_sdk/lib/dom/_tests/books.phpt b/apps/frontend/lib/aws_sdk/lib/dom/_tests/books.phpt
old mode 100644
new mode 100755
diff --git a/apps/frontend/lib/aws_sdk/lib/dom/_tests/ddb_get.phpt b/apps/frontend/lib/aws_sdk/lib/dom/_tests/ddb_get.phpt
old mode 100644
new mode 100755
diff --git a/apps/frontend/lib/aws_sdk/lib/dom/_tests/ddb_scan.phpt b/apps/frontend/lib/aws_sdk/lib/dom/_tests/ddb_scan.phpt
old mode 100644
new mode 100755
diff --git a/apps/frontend/lib/aws_sdk/lib/dom/_tests/different_root_nodes.phpt b/apps/frontend/lib/aws_sdk/lib/dom/_tests/different_root_nodes.phpt
old mode 100644
new mode 100755
diff --git a/apps/frontend/lib/aws_sdk/lib/dom/_tests/empty_inner.phpt b/apps/frontend/lib/aws_sdk/lib/dom/_tests/empty_inner.phpt
old mode 100644
new mode 100755
diff --git a/apps/frontend/lib/aws_sdk/lib/dom/_tests/empty_outer.phpt b/apps/frontend/lib/aws_sdk/lib/dom/_tests/empty_outer.phpt
old mode 100644
new mode 100755
diff --git a/apps/frontend/lib/aws_sdk/lib/dom/_tests/indexed.phpt b/apps/frontend/lib/aws_sdk/lib/dom/_tests/indexed.phpt
old mode 100644
new mode 100755
diff --git a/apps/frontend/lib/aws_sdk/lib/dom/_tests/list_of_hashes.phpt b/apps/frontend/lib/aws_sdk/lib/dom/_tests/list_of_hashes.phpt
old mode 100644
new mode 100755
diff --git a/apps/frontend/lib/aws_sdk/lib/dom/_tests/list_of_hashes2.phpt b/apps/frontend/lib/aws_sdk/lib/dom/_tests/list_of_hashes2.phpt
old mode 100644
new mode 100755
diff --git a/apps/frontend/lib/aws_sdk/lib/dom/_tests/list_of_hashes3.phpt b/apps/frontend/lib/aws_sdk/lib/dom/_tests/list_of_hashes3.phpt
old mode 100644
new mode 100755
diff --git a/apps/frontend/lib/aws_sdk/lib/dom/_tests/null_bytes.phpt b/apps/frontend/lib/aws_sdk/lib/dom/_tests/null_bytes.phpt
old mode 100644
new mode 100755
diff --git a/apps/frontend/lib/aws_sdk/lib/dom/_tests/same_root_nodes.phpt b/apps/frontend/lib/aws_sdk/lib/dom/_tests/same_root_nodes.phpt
old mode 100644
new mode 100755
diff --git a/apps/frontend/lib/aws_sdk/lib/dom/_tests/simple.phpt b/apps/frontend/lib/aws_sdk/lib/dom/_tests/simple.phpt
old mode 100644
new mode 100755
diff --git a/apps/frontend/lib/aws_sdk/lib/yaml/LICENSE b/apps/frontend/lib/aws_sdk/lib/yaml/LICENSE
old mode 100644
new mode 100755
diff --git a/apps/frontend/lib/aws_sdk/lib/yaml/README.markdown b/apps/frontend/lib/aws_sdk/lib/yaml/README.markdown
old mode 100644
new mode 100755
diff --git a/apps/frontend/lib/aws_sdk/lib/yaml/lib/sfYaml.php b/apps/frontend/lib/aws_sdk/lib/yaml/lib/sfYaml.php
old mode 100644
new mode 100755
diff --git a/apps/frontend/lib/aws_sdk/lib/yaml/lib/sfYamlDumper.php b/apps/frontend/lib/aws_sdk/lib/yaml/lib/sfYamlDumper.php
old mode 100644
new mode 100755
diff --git a/apps/frontend/lib/aws_sdk/lib/yaml/lib/sfYamlInline.php b/apps/frontend/lib/aws_sdk/lib/yaml/lib/sfYamlInline.php
old mode 100644
new mode 100755
diff --git a/apps/frontend/lib/aws_sdk/lib/yaml/lib/sfYamlParser.php b/apps/frontend/lib/aws_sdk/lib/yaml/lib/sfYamlParser.php
old mode 100644
new mode 100755
diff --git a/apps/frontend/lib/aws_sdk/package.xml b/apps/frontend/lib/aws_sdk/package.xml
old mode 100644
new mode 100755
diff --git a/apps/frontend/lib/aws_sdk/services/as.class.php b/apps/frontend/lib/aws_sdk/services/as.class.php
old mode 100644
new mode 100755
diff --git a/apps/frontend/lib/aws_sdk/services/cloudformation.class.php b/apps/frontend/lib/aws_sdk/services/cloudformation.class.php
old mode 100644
new mode 100755
diff --git a/apps/frontend/lib/aws_sdk/services/cloudsearch.class.php b/apps/frontend/lib/aws_sdk/services/cloudsearch.class.php
old mode 100644
new mode 100755
diff --git a/apps/frontend/lib/aws_sdk/services/cloudwatch.class.php b/apps/frontend/lib/aws_sdk/services/cloudwatch.class.php
old mode 100644
new mode 100755
diff --git a/apps/frontend/lib/aws_sdk/services/dynamodb.class.php b/apps/frontend/lib/aws_sdk/services/dynamodb.class.php
old mode 100644
new mode 100755
diff --git a/apps/frontend/lib/aws_sdk/services/ec2.class.php b/apps/frontend/lib/aws_sdk/services/ec2.class.php
old mode 100644
new mode 100755
diff --git a/apps/frontend/lib/aws_sdk/services/elasticache.class.php b/apps/frontend/lib/aws_sdk/services/elasticache.class.php
old mode 100644
new mode 100755
diff --git a/apps/frontend/lib/aws_sdk/services/elasticbeanstalk.class.php b/apps/frontend/lib/aws_sdk/services/elasticbeanstalk.class.php
old mode 100644
new mode 100755
diff --git a/apps/frontend/lib/aws_sdk/services/elb.class.php b/apps/frontend/lib/aws_sdk/services/elb.class.php
old mode 100644
new mode 100755
diff --git a/apps/frontend/lib/aws_sdk/services/emr.class.php b/apps/frontend/lib/aws_sdk/services/emr.class.php
old mode 100644
new mode 100755
diff --git a/apps/frontend/lib/aws_sdk/services/iam.class.php b/apps/frontend/lib/aws_sdk/services/iam.class.php
old mode 100644
new mode 100755
diff --git a/apps/frontend/lib/aws_sdk/services/importexport.class.php b/apps/frontend/lib/aws_sdk/services/importexport.class.php
old mode 100644
new mode 100755
diff --git a/apps/frontend/lib/aws_sdk/services/rds.class.php b/apps/frontend/lib/aws_sdk/services/rds.class.php
old mode 100644
new mode 100755
diff --git a/apps/frontend/lib/aws_sdk/services/sdb.class.php b/apps/frontend/lib/aws_sdk/services/sdb.class.php
old mode 100644
new mode 100755
diff --git a/apps/frontend/lib/aws_sdk/services/ses.class.php b/apps/frontend/lib/aws_sdk/services/ses.class.php
old mode 100644
new mode 100755
diff --git a/apps/frontend/lib/aws_sdk/services/sns.class.php b/apps/frontend/lib/aws_sdk/services/sns.class.php
old mode 100644
new mode 100755
diff --git a/apps/frontend/lib/aws_sdk/services/sqs.class.php b/apps/frontend/lib/aws_sdk/services/sqs.class.php
old mode 100644
new mode 100755
diff --git a/apps/frontend/lib/aws_sdk/services/storagegateway.class.php b/apps/frontend/lib/aws_sdk/services/storagegateway.class.php
old mode 100644
new mode 100755
diff --git a/apps/frontend/lib/aws_sdk/services/sts.class.php b/apps/frontend/lib/aws_sdk/services/sts.class.php
old mode 100644
new mode 100755
diff --git a/apps/frontend/lib/aws_sdk/services/swf.class.php b/apps/frontend/lib/aws_sdk/services/swf.class.php
old mode 100644
new mode 100755
diff --git a/apps/frontend/lib/aws_sdk/utilities/array.class.php b/apps/frontend/lib/aws_sdk/utilities/array.class.php
old mode 100644
new mode 100755
diff --git a/apps/frontend/lib/aws_sdk/utilities/batchrequest.class.php b/apps/frontend/lib/aws_sdk/utilities/batchrequest.class.php
old mode 100644
new mode 100755
diff --git a/apps/frontend/lib/aws_sdk/utilities/complextype.class.php b/apps/frontend/lib/aws_sdk/utilities/complextype.class.php
old mode 100644
new mode 100755
diff --git a/apps/frontend/lib/aws_sdk/utilities/credential.class.php b/apps/frontend/lib/aws_sdk/utilities/credential.class.php
old mode 100644
new mode 100755
diff --git a/apps/frontend/lib/aws_sdk/utilities/credentials.class.php b/apps/frontend/lib/aws_sdk/utilities/credentials.class.php
old mode 100644
new mode 100755
diff --git a/apps/frontend/lib/aws_sdk/utilities/gzipdecode.class.php b/apps/frontend/lib/aws_sdk/utilities/gzipdecode.class.php
old mode 100644
new mode 100755
diff --git a/apps/frontend/lib/aws_sdk/utilities/hadoopbase.class.php b/apps/frontend/lib/aws_sdk/utilities/hadoopbase.class.php
old mode 100644
new mode 100755
diff --git a/apps/frontend/lib/aws_sdk/utilities/hadoopbootstrap.class.php b/apps/frontend/lib/aws_sdk/utilities/hadoopbootstrap.class.php
old mode 100644
new mode 100755
diff --git a/apps/frontend/lib/aws_sdk/utilities/hadoopstep.class.php b/apps/frontend/lib/aws_sdk/utilities/hadoopstep.class.php
old mode 100644
new mode 100755
diff --git a/apps/frontend/lib/aws_sdk/utilities/info.class.php b/apps/frontend/lib/aws_sdk/utilities/info.class.php
old mode 100644
new mode 100755
diff --git a/apps/frontend/lib/aws_sdk/utilities/json.class.php b/apps/frontend/lib/aws_sdk/utilities/json.class.php
old mode 100644
new mode 100755
diff --git a/apps/frontend/lib/aws_sdk/utilities/manifest.class.php b/apps/frontend/lib/aws_sdk/utilities/manifest.class.php
old mode 100644
new mode 100755
diff --git a/apps/frontend/lib/aws_sdk/utilities/mimetypes.class.php b/apps/frontend/lib/aws_sdk/utilities/mimetypes.class.php
old mode 100644
new mode 100755
diff --git a/apps/frontend/lib/aws_sdk/utilities/policy.class.php b/apps/frontend/lib/aws_sdk/utilities/policy.class.php
old mode 100644
new mode 100755
diff --git a/apps/frontend/lib/aws_sdk/utilities/request.class.php b/apps/frontend/lib/aws_sdk/utilities/request.class.php
old mode 100644
new mode 100755
diff --git a/apps/frontend/lib/aws_sdk/utilities/response.class.php b/apps/frontend/lib/aws_sdk/utilities/response.class.php
old mode 100644
new mode 100755
diff --git a/apps/frontend/lib/aws_sdk/utilities/simplexml.class.php b/apps/frontend/lib/aws_sdk/utilities/simplexml.class.php
old mode 100644
new mode 100755
diff --git a/apps/frontend/lib/aws_sdk/utilities/stacktemplate.class.php b/apps/frontend/lib/aws_sdk/utilities/stacktemplate.class.php
old mode 100644
new mode 100755
diff --git a/apps/frontend/lib/aws_sdk/utilities/stepconfig.class.php b/apps/frontend/lib/aws_sdk/utilities/stepconfig.class.php
old mode 100644
new mode 100755
diff --git a/apps/frontend/lib/mail/Mail/mime.php b/apps/frontend/lib/mail/Mail/mime.php
new file mode 100755
index 0000000..4218554
--- /dev/null
+++ b/apps/frontend/lib/mail/Mail/mime.php
@@ -0,0 +1,1493 @@
+<?php
+/**
+ * The Mail_Mime class is used to create MIME E-mail messages
+ *
+ * The Mail_Mime class provides an OO interface to create MIME
+ * enabled email messages. This way you can create emails that
+ * contain plain-text bodies, HTML bodies, attachments, inline
+ * images and specific headers.
+ *
+ * Compatible with PHP versions 4 and 5
+ *
+ * LICENSE: This LICENSE is in the BSD license style.
+ * Copyright (c) 2002-2003, Richard Heyes <richard@phpguru.org>
+ * Copyright (c) 2003-2006, PEAR <pear-group@php.net>
+ * All rights reserved.
+ *
+ * Redistribution and use in source and binary forms, with or
+ * without modification, are permitted provided that the following
+ * conditions are met:
+ *
+ * - Redistributions of source code must retain the above copyright
+ *   notice, this list of conditions and the following disclaimer.
+ * - Redistributions in binary form must reproduce the above copyright
+ *   notice, this list of conditions and the following disclaimer in the
+ *   documentation and/or other materials provided with the distribution.
+ * - Neither the name of the authors, nor the names of its contributors 
+ *   may be used to endorse or promote products derived from this 
+ *   software without specific prior written permission.
+ *
+ * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"
+ * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
+ * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
+ * ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE
+ * LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR
+ * CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF
+ * SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS
+ * INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
+ * CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
+ * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF
+ * THE POSSIBILITY OF SUCH DAMAGE.
+ *
+ * @category  Mail
+ * @package   Mail_Mime
+ * @author    Richard Heyes  <richard@phpguru.org>
+ * @author    Tomas V.V. Cox <cox@idecnet.com>
+ * @author    Cipriano Groenendal <cipri@php.net>
+ * @author    Sean Coates <sean@php.net>
+ * @author    Aleksander Machniak <alec@php.net>
+ * @copyright 2003-2006 PEAR <pear-group@php.net>
+ * @license   http://www.opensource.org/licenses/bsd-license.php BSD License
+ * @version   CVS: $Id$
+ * @link      http://pear.php.net/package/Mail_mime
+ *
+ *            This class is based on HTML Mime Mail class from
+ *            Richard Heyes <richard@phpguru.org> which was based also
+ *            in the mime_mail.class by Tobias Ratschiller <tobias@dnet.it>
+ *            and Sascha Schumann <sascha@schumann.cx>
+ */
+
+
+/**
+ * require PEAR
+ *
+ * This package depends on PEAR to raise errors.
+ */
+require_once 'PEAR.php';
+
+/**
+ * require Mail_mimePart
+ *
+ * Mail_mimePart contains the code required to
+ * create all the different parts a mail can
+ * consist of.
+ */
+require_once 'Mail/mimePart.php';
+
+
+/**
+ * The Mail_Mime class provides an OO interface to create MIME
+ * enabled email messages. This way you can create emails that
+ * contain plain-text bodies, HTML bodies, attachments, inline
+ * images and specific headers.
+ *
+ * @category  Mail
+ * @package   Mail_Mime
+ * @author    Richard Heyes  <richard@phpguru.org>
+ * @author    Tomas V.V. Cox <cox@idecnet.com>
+ * @author    Cipriano Groenendal <cipri@php.net>
+ * @author    Sean Coates <sean@php.net>
+ * @copyright 2003-2006 PEAR <pear-group@php.net>
+ * @license   http://www.opensource.org/licenses/bsd-license.php BSD License
+ * @version   Release: @package_version@
+ * @link      http://pear.php.net/package/Mail_mime
+ */
+class Mail_mime
+{
+    /**
+     * Contains the plain text part of the email
+     *
+     * @var string
+     * @access private
+     */
+    var $_txtbody;
+
+    /**
+     * Contains the html part of the email
+     *
+     * @var string
+     * @access private
+     */
+    var $_htmlbody;
+
+    /**
+     * list of the attached images
+     *
+     * @var array
+     * @access private
+     */
+    var $_html_images = array();
+
+    /**
+     * list of the attachements
+     *
+     * @var array
+     * @access private
+     */
+    var $_parts = array();
+
+    /**
+     * Headers for the mail
+     *
+     * @var array
+     * @access private
+     */
+    var $_headers = array();
+
+    /**
+     * Build parameters
+     *
+     * @var array
+     * @access private
+     */
+    var $_build_params = array(
+        // What encoding to use for the headers
+        // Options: quoted-printable or base64
+        'head_encoding' => 'quoted-printable',
+        // What encoding to use for plain text
+        // Options: 7bit, 8bit, base64, or quoted-printable
+        'text_encoding' => 'quoted-printable',
+        // What encoding to use for html
+        // Options: 7bit, 8bit, base64, or quoted-printable
+        'html_encoding' => 'quoted-printable',
+        // The character set to use for html
+        'html_charset'  => 'ISO-8859-1',
+        // The character set to use for text
+        'text_charset'  => 'ISO-8859-1',
+        // The character set to use for headers
+        'head_charset'  => 'ISO-8859-1',
+        // End-of-line sequence
+        'eol'           => "\r\n",
+        // Delay attachment files IO until building the message
+        'delay_file_io' => false
+    );
+
+    /**
+     * Constructor function
+     *
+     * @param mixed $params Build parameters that change the way the email
+     *                      is built. Should be an associative array.
+     *                      See $_build_params.
+     *
+     * @return void
+     * @access public
+     */
+    function Mail_mime($params = array())
+    {
+        // Backward-compatible EOL setting
+        if (is_string($params)) {
+            $this->_build_params['eol'] = $params;
+        } else if (defined('MAIL_MIME_CRLF') && !isset($params['eol'])) {
+            $this->_build_params['eol'] = MAIL_MIME_CRLF;
+        }
+
+        // Update build parameters
+        if (!empty($params) && is_array($params)) {
+            while (list($key, $value) = each($params)) {
+                $this->_build_params[$key] = $value;
+            }
+        }
+    }
+
+    /**
+     * Set build parameter value
+     *
+     * @param string $name  Parameter name
+     * @param string $value Parameter value
+     *
+     * @return void
+     * @access public
+     * @since 1.6.0
+     */
+    function setParam($name, $value)
+    {
+        $this->_build_params[$name] = $value;
+    }
+
+    /**
+     * Get build parameter value
+     *
+     * @param string $name Parameter name
+     *
+     * @return mixed Parameter value
+     * @access public
+     * @since 1.6.0
+     */
+    function getParam($name)
+    {
+        return isset($this->_build_params[$name]) ? $this->_build_params[$name] : null;
+    }
+
+    /**
+     * Accessor function to set the body text. Body text is used if
+     * it's not an html mail being sent or else is used to fill the
+     * text/plain part that emails clients who don't support
+     * html should show.
+     *
+     * @param string $data   Either a string or
+     *                       the file name with the contents
+     * @param bool   $isfile If true the first param should be treated
+     *                       as a file name, else as a string (default)
+     * @param bool   $append If true the text or file is appended to
+     *                       the existing body, else the old body is
+     *                       overwritten
+     *
+     * @return mixed         True on success or PEAR_Error object
+     * @access public
+     */
+    function setTXTBody($data, $isfile = false, $append = false)
+    {
+        if (!$isfile) {
+            if (!$append) {
+                $this->_txtbody = $data;
+            } else {
+                $this->_txtbody .= $data;
+            }
+        } else {
+            $cont = $this->_file2str($data);
+            if ($this->_isError($cont)) {
+                return $cont;
+            }
+            if (!$append) {
+                $this->_txtbody = $cont;
+            } else {
+                $this->_txtbody .= $cont;
+            }
+        }
+        return true;
+    }
+
+    /**
+     * Get message text body
+     *
+     * @return string Text body
+     * @access public
+     * @since 1.6.0
+     */
+    function getTXTBody()
+    {
+        return $this->_txtbody;
+    }
+
+    /**
+     * Adds a html part to the mail.
+     *
+     * @param string $data   Either a string or the file name with the
+     *                       contents
+     * @param bool   $isfile A flag that determines whether $data is a
+     *                       filename, or a string(false, default)
+     *
+     * @return bool          True on success
+     * @access public
+     */
+    function setHTMLBody($data, $isfile = false)
+    {
+        if (!$isfile) {
+            $this->_htmlbody = $data;
+        } else {
+            $cont = $this->_file2str($data);
+            if ($this->_isError($cont)) {
+                return $cont;
+            }
+            $this->_htmlbody = $cont;
+        }
+
+        return true;
+    }
+
+    /**
+     * Get message HTML body
+     *
+     * @return string HTML body
+     * @access public
+     * @since 1.6.0
+     */
+    function getHTMLBody()
+    {
+        return $this->_htmlbody;
+    }
+
+    /**
+     * Adds an image to the list of embedded images.
+     *
+     * @param string $file       The image file name OR image data itself
+     * @param string $c_type     The content type
+     * @param string $name       The filename of the image.
+     *                           Only used if $file is the image data.
+     * @param bool   $isfile     Whether $file is a filename or not.
+     *                           Defaults to true
+     * @param string $content_id Desired Content-ID of MIME part
+     *                           Defaults to generated unique ID
+     *
+     * @return bool          True on success
+     * @access public
+     */
+    function addHTMLImage($file,
+        $c_type='application/octet-stream',
+        $name = '',
+        $isfile = true,
+        $content_id = null
+    ) {
+        $bodyfile = null;
+
+        if ($isfile) {
+            // Don't load file into memory
+            if ($this->_build_params['delay_file_io']) {
+                $filedata = null;
+                $bodyfile = $file;
+            } else {
+                if ($this->_isError($filedata = $this->_file2str($file))) {
+                    return $filedata;
+                }
+            }
+            $filename = ($name ? $name : $file);
+        } else {
+            $filedata = $file;
+            $filename = $name;
+        }
+
+        if (!$content_id) {
+            $content_id = md5(uniqid(time()));
+        }
+
+        $this->_html_images[] = array(
+            'body'      => $filedata,
+            'body_file' => $bodyfile,
+            'name'      => $filename,
+            'c_type'    => $c_type,
+            'cid'       => $content_id
+        );
+
+        return true;
+    }
+
+    /**
+     * Adds a file to the list of attachments.
+     *
+     * @param string $file        The file name of the file to attach
+     *                            or the file contents itself
+     * @param string $c_type      The content type
+     * @param string $name        The filename of the attachment
+     *                            Only use if $file is the contents
+     * @param bool   $isfile      Whether $file is a filename or not. Defaults to true
+     * @param string $encoding    The type of encoding to use. Defaults to base64.
+     *                            Possible values: 7bit, 8bit, base64 or quoted-printable.
+     * @param string $disposition The content-disposition of this file
+     *                            Defaults to attachment.
+     *                            Possible values: attachment, inline.
+     * @param string $charset     The character set of attachment's content.
+     * @param string $language    The language of the attachment
+     * @param string $location    The RFC 2557.4 location of the attachment
+     * @param string $n_encoding  Encoding of the attachment's name in Content-Type
+     *                            By default filenames are encoded using RFC2231 method
+     *                            Here you can set RFC2047 encoding (quoted-printable
+     *                            or base64) instead
+     * @param string $f_encoding  Encoding of the attachment's filename
+     *                            in Content-Disposition header.
+     * @param string $description Content-Description header
+     * @param string $h_charset   The character set of the headers e.g. filename
+     *                            If not specified, $charset will be used
+     * @param array  $add_headers Additional part headers. Array keys can be in form
+     *                            of <header_name>:<parameter_name>
+     *
+     * @return mixed              True on success or PEAR_Error object
+     * @access public
+     */
+    function addAttachment($file,
+        $c_type      = 'application/octet-stream',
+        $name        = '',
+        $isfile      = true,
+        $encoding    = 'base64',
+        $disposition = 'attachment',
+        $charset     = '',
+        $language    = '',
+        $location    = '',
+        $n_encoding  = null,
+        $f_encoding  = null,
+        $description = '',
+        $h_charset   = null,
+        $add_headers = array()
+    ) {
+        $bodyfile = null;
+
+        if ($isfile) {
+            // Don't load file into memory
+            if ($this->_build_params['delay_file_io']) {
+                $filedata = null;
+                $bodyfile = $file;
+            } else {
+                if ($this->_isError($filedata = $this->_file2str($file))) {
+                    return $filedata;
+                }
+            }
+            // Force the name the user supplied, otherwise use $file
+            $filename = ($name ? $name : $this->_basename($file));
+        } else {
+            $filedata = $file;
+            $filename = $name;
+        }
+
+        if (!strlen($filename)) {
+            $msg = "The supplied filename for the attachment can't be empty";
+            $err = PEAR::raiseError($msg);
+            return $err;
+        }
+
+        $this->_parts[] = array(
+            'body'        => $filedata,
+            'body_file'   => $bodyfile,
+            'name'        => $filename,
+            'c_type'      => $c_type,
+            'charset'     => $charset,
+            'encoding'    => $encoding,
+            'language'    => $language,
+            'location'    => $location,
+            'disposition' => $disposition,
+            'description' => $description,
+            'add_headers' => $add_headers,
+            'name_encoding'     => $n_encoding,
+            'filename_encoding' => $f_encoding,
+            'headers_charset'   => $h_charset,
+        );
+
+        return true;
+    }
+
+    /**
+     * Get the contents of the given file name as string
+     *
+     * @param string $file_name Path of file to process
+     *
+     * @return string           Contents of $file_name
+     * @access private
+     */
+    function _file2str($file_name)
+    {
+        // Check state of file and raise an error properly
+        if (!file_exists($file_name)) {
+            $err = PEAR::raiseError('File not found: ' . $file_name);
+            return $err;
+        }
+        if (!is_file($file_name)) {
+            $err = PEAR::raiseError('Not a regular file: ' . $file_name);
+            return $err;
+        }
+        if (!is_readable($file_name)) {
+            $err = PEAR::raiseError('File is not readable: ' . $file_name);
+            return $err;
+        }
+
+        // Temporarily reset magic_quotes_runtime and read file contents
+        if ($magic_quote_setting = get_magic_quotes_runtime()) {
+            @ini_set('magic_quotes_runtime', 0);
+        }
+        $cont = file_get_contents($file_name);
+        if ($magic_quote_setting) {
+            @ini_set('magic_quotes_runtime', $magic_quote_setting);
+        }
+
+        return $cont;
+    }
+
+    /**
+     * Adds a text subpart to the mimePart object and
+     * returns it during the build process.
+     *
+     * @param mixed  &$obj The object to add the part to, or
+     *                     null if a new object is to be created.
+     * @param string $text The text to add.
+     *
+     * @return object      The text mimePart object
+     * @access private
+     */
+    function _addTextPart(&$obj, $text)
+    {
+        $params['content_type'] = 'text/plain';
+        $params['encoding']     = $this->_build_params['text_encoding'];
+        $params['charset']      = $this->_build_params['text_charset'];
+        $params['eol']          = $this->_build_params['eol'];
+
+        if (is_object($obj)) {
+            $ret = $obj->addSubpart($text, $params);
+            return $ret;
+        } else {
+            $ret = new Mail_mimePart($text, $params);
+            return $ret;
+        }
+    }
+
+    /**
+     * Adds a html subpart to the mimePart object and
+     * returns it during the build process.
+     *
+     * @param mixed &$obj The object to add the part to, or
+     *                    null if a new object is to be created.
+     *
+     * @return object     The html mimePart object
+     * @access private
+     */
+    function _addHtmlPart(&$obj)
+    {
+        $params['content_type'] = 'text/html';
+        $params['encoding']     = $this->_build_params['html_encoding'];
+        $params['charset']      = $this->_build_params['html_charset'];
+        $params['eol']          = $this->_build_params['eol'];
+
+        if (is_object($obj)) {
+            $ret = $obj->addSubpart($this->_htmlbody, $params);
+            return $ret;
+        } else {
+            $ret = new Mail_mimePart($this->_htmlbody, $params);
+            return $ret;
+        }
+    }
+
+    /**
+     * Creates a new mimePart object, using multipart/mixed as
+     * the initial content-type and returns it during the
+     * build process.
+     *
+     * @return object The multipart/mixed mimePart object
+     * @access private
+     */
+    function _addMixedPart()
+    {
+        $params                 = array();
+        $params['content_type'] = 'multipart/mixed';
+        $params['eol']          = $this->_build_params['eol'];
+
+        // Create empty multipart/mixed Mail_mimePart object to return
+        $ret = new Mail_mimePart('', $params);
+        return $ret;
+    }
+
+    /**
+     * Adds a multipart/alternative part to a mimePart
+     * object (or creates one), and returns it during
+     * the build process.
+     *
+     * @param mixed &$obj The object to add the part to, or
+     *                    null if a new object is to be created.
+     *
+     * @return object     The multipart/mixed mimePart object
+     * @access private
+     */
+    function _addAlternativePart(&$obj)
+    {
+        $params['content_type'] = 'multipart/alternative';
+        $params['eol']          = $this->_build_params['eol'];
+
+        if (is_object($obj)) {
+            return $obj->addSubpart('', $params);
+        } else {
+            $ret = new Mail_mimePart('', $params);
+            return $ret;
+        }
+    }
+
+    /**
+     * Adds a multipart/related part to a mimePart
+     * object (or creates one), and returns it during
+     * the build process.
+     *
+     * @param mixed &$obj The object to add the part to, or
+     *                    null if a new object is to be created
+     *
+     * @return object     The multipart/mixed mimePart object
+     * @access private
+     */
+    function _addRelatedPart(&$obj)
+    {
+        $params['content_type'] = 'multipart/related';
+        $params['eol']          = $this->_build_params['eol'];
+
+        if (is_object($obj)) {
+            return $obj->addSubpart('', $params);
+        } else {
+            $ret = new Mail_mimePart('', $params);
+            return $ret;
+        }
+    }
+
+    /**
+     * Adds an html image subpart to a mimePart object
+     * and returns it during the build process.
+     *
+     * @param object &$obj  The mimePart to add the image to
+     * @param array  $value The image information
+     *
+     * @return object       The image mimePart object
+     * @access private
+     */
+    function _addHtmlImagePart(&$obj, $value)
+    {
+        $params['content_type'] = $value['c_type'];
+        $params['encoding']     = 'base64';
+        $params['disposition']  = 'inline';
+        $params['filename']     = $value['name'];
+        $params['cid']          = $value['cid'];
+        $params['body_file']    = $value['body_file'];
+        $params['eol']          = $this->_build_params['eol'];
+
+        if (!empty($value['name_encoding'])) {
+            $params['name_encoding'] = $value['name_encoding'];
+        }
+        if (!empty($value['filename_encoding'])) {
+            $params['filename_encoding'] = $value['filename_encoding'];
+        }
+
+        $ret = $obj->addSubpart($value['body'], $params);
+        return $ret;
+    }
+
+    /**
+     * Adds an attachment subpart to a mimePart object
+     * and returns it during the build process.
+     *
+     * @param object &$obj  The mimePart to add the image to
+     * @param array  $value The attachment information
+     *
+     * @return object       The image mimePart object
+     * @access private
+     */
+    function _addAttachmentPart(&$obj, $value)
+    {
+        $params['eol']          = $this->_build_params['eol'];
+        $params['filename']     = $value['name'];
+        $params['encoding']     = $value['encoding'];
+        $params['content_type'] = $value['c_type'];
+        $params['body_file']    = $value['body_file'];
+        $params['disposition']  = isset($value['disposition']) ? 
+                                  $value['disposition'] : 'attachment';
+
+        // content charset
+        if (!empty($value['charset'])) {
+            $params['charset'] = $value['charset'];
+        }
+        // headers charset (filename, description)
+        if (!empty($value['headers_charset'])) {
+            $params['headers_charset'] = $value['headers_charset'];
+        }
+        if (!empty($value['language'])) {
+            $params['language'] = $value['language'];
+        }
+        if (!empty($value['location'])) {
+            $params['location'] = $value['location'];
+        }
+        if (!empty($value['name_encoding'])) {
+            $params['name_encoding'] = $value['name_encoding'];
+        }
+        if (!empty($value['filename_encoding'])) {
+            $params['filename_encoding'] = $value['filename_encoding'];
+        }
+        if (!empty($value['description'])) {
+            $params['description'] = $value['description'];
+        }
+        if (is_array($value['add_headers'])) {
+            $params['headers'] = $value['add_headers'];
+        }
+
+        $ret = $obj->addSubpart($value['body'], $params);
+        return $ret;
+    }
+
+    /**
+     * Returns the complete e-mail, ready to send using an alternative
+     * mail delivery method. Note that only the mailpart that is made
+     * with Mail_Mime is created. This means that,
+     * YOU WILL HAVE NO TO: HEADERS UNLESS YOU SET IT YOURSELF 
+     * using the $headers parameter!
+     * 
+     * @param string $separation The separation between these two parts.
+     * @param array  $params     The Build parameters passed to the
+     *                           &get() function. See &get for more info.
+     * @param array  $headers    The extra headers that should be passed
+     *                           to the &headers() function.
+     *                           See that function for more info.
+     * @param bool   $overwrite  Overwrite the existing headers with new.
+     *
+     * @return mixed The complete e-mail or PEAR error object
+     * @access public
+     */
+    function getMessage($separation = null, $params = null, $headers = null,
+        $overwrite = false
+    ) {
+        if ($separation === null) {
+            $separation = $this->_build_params['eol'];
+        }
+
+        $body = $this->get($params);
+
+        if ($this->_isError($body)) {
+            return $body;
+        }
+
+        $head = $this->txtHeaders($headers, $overwrite);
+        $mail = $head . $separation . $body;
+        return $mail;
+    }
+
+    /**
+     * Returns the complete e-mail body, ready to send using an alternative
+     * mail delivery method.
+     * 
+     * @param array $params The Build parameters passed to the
+     *                      &get() function. See &get for more info.
+     *
+     * @return mixed The e-mail body or PEAR error object
+     * @access public
+     * @since 1.6.0
+     */
+    function getMessageBody($params = null)
+    {
+        return $this->get($params, null, true);
+    }
+
+    /**
+     * Writes (appends) the complete e-mail into file.
+     * 
+     * @param string $filename  Output file location
+     * @param array  $params    The Build parameters passed to the
+     *                          &get() function. See &get for more info.
+     * @param array  $headers   The extra headers that should be passed
+     *                          to the &headers() function.
+     *                          See that function for more info.
+     * @param bool   $overwrite Overwrite the existing headers with new.
+     *
+     * @return mixed True or PEAR error object
+     * @access public
+     * @since 1.6.0
+     */
+    function saveMessage($filename, $params = null, $headers = null, $overwrite = false)
+    {
+        // Check state of file and raise an error properly
+        if (file_exists($filename) && !is_writable($filename)) {
+            $err = PEAR::raiseError('File is not writable: ' . $filename);
+            return $err;
+        }
+
+        // Temporarily reset magic_quotes_runtime and read file contents
+        if ($magic_quote_setting = get_magic_quotes_runtime()) {
+            @ini_set('magic_quotes_runtime', 0);
+        }
+
+        if (!($fh = fopen($filename, 'ab'))) {
+            $err = PEAR::raiseError('Unable to open file: ' . $filename);
+            return $err;
+        }
+
+        // Write message headers into file (skipping Content-* headers)
+        $head = $this->txtHeaders($headers, $overwrite, true);
+        if (fwrite($fh, $head) === false) {
+            $err = PEAR::raiseError('Error writing to file: ' . $filename);
+            return $err;
+        }
+
+        fclose($fh);
+
+        if ($magic_quote_setting) {
+            @ini_set('magic_quotes_runtime', $magic_quote_setting);
+        }
+
+        // Write the rest of the message into file
+        $res = $this->get($params, $filename);
+
+        return $res ? $res : true;
+    }
+
+    /**
+     * Writes (appends) the complete e-mail body into file.
+     * 
+     * @param string $filename Output file location
+     * @param array  $params   The Build parameters passed to the
+     *                         &get() function. See &get for more info.
+     *
+     * @return mixed True or PEAR error object
+     * @access public
+     * @since 1.6.0
+     */
+    function saveMessageBody($filename, $params = null)
+    {
+        // Check state of file and raise an error properly
+        if (file_exists($filename) && !is_writable($filename)) {
+            $err = PEAR::raiseError('File is not writable: ' . $filename);
+            return $err;
+        }
+
+        // Temporarily reset magic_quotes_runtime and read file contents
+        if ($magic_quote_setting = get_magic_quotes_runtime()) {
+            @ini_set('magic_quotes_runtime', 0);
+        }
+
+        if (!($fh = fopen($filename, 'ab'))) {
+            $err = PEAR::raiseError('Unable to open file: ' . $filename);
+            return $err;
+        }
+
+        // Write the rest of the message into file
+        $res = $this->get($params, $filename, true);
+
+        return $res ? $res : true;
+    }
+
+    /**
+     * Builds the multipart message from the list ($this->_parts) and
+     * returns the mime content.
+     *
+     * @param array    $params    Build parameters that change the way the email
+     *                            is built. Should be associative. See $_build_params.
+     * @param resource $filename  Output file where to save the message instead of
+     *                            returning it
+     * @param boolean  $skip_head True if you want to return/save only the message
+     *                            without headers
+     *
+     * @return mixed The MIME message content string, null or PEAR error object
+     * @access public
+     */
+    function &get($params = null, $filename = null, $skip_head = false)
+    {
+        if (isset($params)) {
+            while (list($key, $value) = each($params)) {
+                $this->_build_params[$key] = $value;
+            }
+        }
+
+        if (isset($this->_headers['From'])) {
+            // Bug #11381: Illegal characters in domain ID
+            if (preg_match('#(@[0-9a-zA-Z\-\.]+)#', $this->_headers['From'], $matches)) {
+                $domainID = $matches[1];
+            } else {
+                $domainID = '@localhost';
+            }
+            foreach ($this->_html_images as $i => $img) {
+                $cid = $this->_html_images[$i]['cid']; 
+                if (!preg_match('#'.preg_quote($domainID).'$#', $cid)) {
+                    $this->_html_images[$i]['cid'] = $cid . $domainID;
+                }
+            }
+        }
+
+        if (count($this->_html_images) && isset($this->_htmlbody)) {
+            foreach ($this->_html_images as $key => $value) {
+                $regex   = array();
+                $regex[] = '#(\s)((?i)src|background|href(?-i))\s*=\s*(["\']?)' .
+                            preg_quote($value['name'], '#') . '\3#';
+                $regex[] = '#(?i)url(?-i)\(\s*(["\']?)' .
+                            preg_quote($value['name'], '#') . '\1\s*\)#';
+
+                $rep   = array();
+                $rep[] = '\1\2=\3cid:' . $value['cid'] .'\3';
+                $rep[] = 'url(\1cid:' . $value['cid'] . '\1)';
+
+                $this->_htmlbody = preg_replace($regex, $rep, $this->_htmlbody);
+                $this->_html_images[$key]['name']
+                    = $this->_basename($this->_html_images[$key]['name']);
+            }
+        }
+
+        $this->_checkParams();
+
+        $null        = null;
+        $attachments = count($this->_parts)                 ? true : false;
+        $html_images = count($this->_html_images)           ? true : false;
+        $html        = strlen($this->_htmlbody)             ? true : false;
+        $text        = (!$html && strlen($this->_txtbody))  ? true : false;
+
+        switch (true) {
+        case $text && !$attachments:
+            $message =& $this->_addTextPart($null, $this->_txtbody);
+            break;
+
+        case !$text && !$html && $attachments:
+            $message =& $this->_addMixedPart();
+            for ($i = 0; $i < count($this->_parts); $i++) {
+                $this->_addAttachmentPart($message, $this->_parts[$i]);
+            }
+            break;
+
+        case $text && $attachments:
+            $message =& $this->_addMixedPart();
+            $this->_addTextPart($message, $this->_txtbody);
+            for ($i = 0; $i < count($this->_parts); $i++) {
+                $this->_addAttachmentPart($message, $this->_parts[$i]);
+            }
+            break;
+
+        case $html && !$attachments && !$html_images:
+            if (isset($this->_txtbody)) {
+                $message =& $this->_addAlternativePart($null);
+                $this->_addTextPart($message, $this->_txtbody);
+                $this->_addHtmlPart($message);
+            } else {
+                $message =& $this->_addHtmlPart($null);
+            }
+            break;
+
+        case $html && !$attachments && $html_images:
+            // * Content-Type: multipart/alternative;
+            //    * text
+            //    * Content-Type: multipart/related;
+            //       * html
+            //       * image...
+            if (isset($this->_txtbody)) {
+                $message =& $this->_addAlternativePart($null);
+                $this->_addTextPart($message, $this->_txtbody);
+
+                $ht =& $this->_addRelatedPart($message);
+                $this->_addHtmlPart($ht);
+                for ($i = 0; $i < count($this->_html_images); $i++) {
+                    $this->_addHtmlImagePart($ht, $this->_html_images[$i]);
+                }
+            } else {
+                // * Content-Type: multipart/related;
+                //    * html
+                //    * image...
+                $message =& $this->_addRelatedPart($null);
+                $this->_addHtmlPart($message);
+                for ($i = 0; $i < count($this->_html_images); $i++) {
+                    $this->_addHtmlImagePart($message, $this->_html_images[$i]);
+                }
+            }
+            /*
+            // #13444, #9725: the code below was a non-RFC compliant hack
+            // * Content-Type: multipart/related;
+            //    * Content-Type: multipart/alternative;
+            //        * text
+            //        * html
+            //    * image...
+            $message =& $this->_addRelatedPart($null);
+            if (isset($this->_txtbody)) {
+                $alt =& $this->_addAlternativePart($message);
+                $this->_addTextPart($alt, $this->_txtbody);
+                $this->_addHtmlPart($alt);
+            } else {
+                $this->_addHtmlPart($message);
+            }
+            for ($i = 0; $i < count($this->_html_images); $i++) {
+                $this->_addHtmlImagePart($message, $this->_html_images[$i]);
+            }
+            */
+            break;
+
+        case $html && $attachments && !$html_images:
+            $message =& $this->_addMixedPart();
+            if (isset($this->_txtbody)) {
+                $alt =& $this->_addAlternativePart($message);
+                $this->_addTextPart($alt, $this->_txtbody);
+                $this->_addHtmlPart($alt);
+            } else {
+                $this->_addHtmlPart($message);
+            }
+            for ($i = 0; $i < count($this->_parts); $i++) {
+                $this->_addAttachmentPart($message, $this->_parts[$i]);
+            }
+            break;
+
+        case $html && $attachments && $html_images:
+            $message =& $this->_addMixedPart();
+            if (isset($this->_txtbody)) {
+                $alt =& $this->_addAlternativePart($message);
+                $this->_addTextPart($alt, $this->_txtbody);
+                $rel =& $this->_addRelatedPart($alt);
+            } else {
+                $rel =& $this->_addRelatedPart($message);
+            }
+            $this->_addHtmlPart($rel);
+            for ($i = 0; $i < count($this->_html_images); $i++) {
+                $this->_addHtmlImagePart($rel, $this->_html_images[$i]);
+            }
+            for ($i = 0; $i < count($this->_parts); $i++) {
+                $this->_addAttachmentPart($message, $this->_parts[$i]);
+            }
+            break;
+
+        }
+
+        if (!isset($message)) {
+            $ret = null;
+            return $ret;
+        }
+
+        // Use saved boundary
+        if (!empty($this->_build_params['boundary'])) {
+            $boundary = $this->_build_params['boundary'];
+        } else {
+            $boundary = null;
+        }
+
+        // Write output to file
+        if ($filename) {
+            // Append mimePart message headers and body into file
+            $headers = $message->encodeToFile($filename, $boundary, $skip_head);
+            if ($this->_isError($headers)) {
+                return $headers;
+            }
+            $this->_headers = array_merge($this->_headers, $headers);
+            $ret = null;
+            return $ret;
+        } else {
+            $output = $message->encode($boundary, $skip_head);
+            if ($this->_isError($output)) {
+                return $output;
+            }
+            $this->_headers = array_merge($this->_headers, $output['headers']);
+            $body = $output['body'];
+            return $body;
+        }
+    }
+
+    /**
+     * Returns an array with the headers needed to prepend to the email
+     * (MIME-Version and Content-Type). Format of argument is:
+     * $array['header-name'] = 'header-value';
+     *
+     * @param array $xtra_headers Assoc array with any extra headers (optional)
+     *                            (Don't set Content-Type for multipart messages here!)
+     * @param bool  $overwrite    Overwrite already existing headers.
+     * @param bool  $skip_content Don't return content headers: Content-Type,
+     *                            Content-Disposition and Content-Transfer-Encoding
+     * 
+     * @return array              Assoc array with the mime headers
+     * @access public
+     */
+    function &headers($xtra_headers = null, $overwrite = false, $skip_content = false)
+    {
+        // Add mime version header
+        $headers['MIME-Version'] = '1.0';
+
+        // Content-Type and Content-Transfer-Encoding headers should already
+        // be present if get() was called, but we'll re-set them to make sure
+        // we got them when called before get() or something in the message
+        // has been changed after get() [#14780]
+        if (!$skip_content) {
+            $headers += $this->_contentHeaders();
+        }
+
+        if (!empty($xtra_headers)) {
+            $headers = array_merge($headers, $xtra_headers);
+        }
+
+        if ($overwrite) {
+            $this->_headers = array_merge($this->_headers, $headers);
+        } else {
+            $this->_headers = array_merge($headers, $this->_headers);
+        }
+
+        $headers = $this->_headers;
+
+        if ($skip_content) {
+            unset($headers['Content-Type']);
+            unset($headers['Content-Transfer-Encoding']);
+            unset($headers['Content-Disposition']);
+        } else if (!empty($this->_build_params['ctype'])) {
+            $headers['Content-Type'] = $this->_build_params['ctype'];
+        }
+
+        $encodedHeaders = $this->_encodeHeaders($headers);
+        return $encodedHeaders;
+    }
+
+    /**
+     * Get the text version of the headers
+     * (usefull if you want to use the PHP mail() function)
+     *
+     * @param array $xtra_headers Assoc array with any extra headers (optional)
+     *                            (Don't set Content-Type for multipart messages here!)
+     * @param bool  $overwrite    Overwrite the existing headers with new.
+     * @param bool  $skip_content Don't return content headers: Content-Type,
+     *                            Content-Disposition and Content-Transfer-Encoding
+     *
+     * @return string             Plain text headers
+     * @access public
+     */
+    function txtHeaders($xtra_headers = null, $overwrite = false, $skip_content = false)
+    {
+        $headers = $this->headers($xtra_headers, $overwrite, $skip_content);
+
+        // Place Received: headers at the beginning of the message
+        // Spam detectors often flag messages with it after the Subject: as spam
+        if (isset($headers['Received'])) {
+            $received = $headers['Received'];
+            unset($headers['Received']);
+            $headers = array('Received' => $received) + $headers;
+        }
+
+        $ret = '';
+        $eol = $this->_build_params['eol'];
+
+        foreach ($headers as $key => $val) {
+            if (is_array($val)) {
+                foreach ($val as $value) {
+                    $ret .= "$key: $value" . $eol;
+                }
+            } else {
+                $ret .= "$key: $val" . $eol;
+            }
+        }
+
+        return $ret;
+    }
+
+    /**
+     * Sets message Content-Type header.
+     * Use it to build messages with various content-types e.g. miltipart/raport
+     * not supported by _contentHeaders() function.
+     *
+     * @param string $type   Type name
+     * @param array  $params Hash array of header parameters
+     *
+     * @return void
+     * @access public
+     * @since 1.7.0
+     */
+    function setContentType($type, $params = array())
+    {
+        $header = $type;
+
+        $eol = !empty($this->_build_params['eol'])
+            ? $this->_build_params['eol'] : "\r\n";
+
+        // add parameters
+        $token_regexp = '#([^\x21\x23-\x27\x2A\x2B\x2D'
+            . '\x2E\x30-\x39\x41-\x5A\x5E-\x7E])#';
+        if (is_array($params)) {
+            foreach ($params as $name => $value) {
+                if ($name == 'boundary') {
+                    $this->_build_params['boundary'] = $value;
+                }
+                if (!preg_match($token_regexp, $value)) {
+                    $header .= ";$eol $name=$value";
+                } else {
+                    $value = addcslashes($value, '\\"');
+                    $header .= ";$eol $name=\"$value\"";
+                }
+            }
+        }
+
+        // add required boundary parameter if not defined
+        if (preg_match('/^multipart\//i', $type)) {
+            if (empty($this->_build_params['boundary'])) {
+                $this->_build_params['boundary'] = '=_' . md5(rand() . microtime());
+            }
+
+            $header .= ";$eol boundary=\"".$this->_build_params['boundary']."\"";
+        }
+
+        $this->_build_params['ctype'] = $header;
+    }
+
+    /**
+     * Sets the Subject header
+     *
+     * @param string $subject String to set the subject to.
+     *
+     * @return void
+     * @access public
+     */
+    function setSubject($subject)
+    {
+        $this->_headers['Subject'] = $subject;
+    }
+
+    /**
+     * Set an email to the From (the sender) header
+     *
+     * @param string $email The email address to use
+     *
+     * @return void
+     * @access public
+     */
+    function setFrom($email)
+    {
+        $this->_headers['From'] = $email;
+    }
+
+    /**
+     * Add an email to the To header
+     * (multiple calls to this method are allowed)
+     *
+     * @param string $email The email direction to add
+     *
+     * @return void
+     * @access public
+     */
+    function addTo($email)
+    {
+        if (isset($this->_headers['To'])) {
+            $this->_headers['To'] .= ", $email";
+        } else {
+            $this->_headers['To'] = $email;
+        }
+    }
+
+    /**
+     * Add an email to the Cc (carbon copy) header
+     * (multiple calls to this method are allowed)
+     *
+     * @param string $email The email direction to add
+     *
+     * @return void
+     * @access public
+     */
+    function addCc($email)
+    {
+        if (isset($this->_headers['Cc'])) {
+            $this->_headers['Cc'] .= ", $email";
+        } else {
+            $this->_headers['Cc'] = $email;
+        }
+    }
+
+    /**
+     * Add an email to the Bcc (blank carbon copy) header
+     * (multiple calls to this method are allowed)
+     *
+     * @param string $email The email direction to add
+     *
+     * @return void
+     * @access public
+     */
+    function addBcc($email)
+    {
+        if (isset($this->_headers['Bcc'])) {
+            $this->_headers['Bcc'] .= ", $email";
+        } else {
+            $this->_headers['Bcc'] = $email;
+        }
+    }
+
+    /**
+     * Since the PHP send function requires you to specify
+     * recipients (To: header) separately from the other
+     * headers, the To: header is not properly encoded.
+     * To fix this, you can use this public method to 
+     * encode your recipients before sending to the send
+     * function
+     *
+     * @param string $recipients A comma-delimited list of recipients
+     *
+     * @return string            Encoded data
+     * @access public
+     */
+    function encodeRecipients($recipients)
+    {
+        $input = array("To" => $recipients);
+        $retval = $this->_encodeHeaders($input);
+        return $retval["To"] ;
+    }
+
+    /**
+     * Encodes headers as per RFC2047
+     *
+     * @param array $input  The header data to encode
+     * @param array $params Extra build parameters
+     *
+     * @return array        Encoded data
+     * @access private
+     */
+    function _encodeHeaders($input, $params = array())
+    {
+        $build_params = $this->_build_params;
+        while (list($key, $value) = each($params)) {
+            $build_params[$key] = $value;
+        }
+
+        foreach ($input as $hdr_name => $hdr_value) {
+            if (is_array($hdr_value)) {
+                foreach ($hdr_value as $idx => $value) {
+                    $input[$hdr_name][$idx] = $this->encodeHeader(
+                        $hdr_name, $value,
+                        $build_params['head_charset'], $build_params['head_encoding']
+                    );
+                }
+            } else {
+                $input[$hdr_name] = $this->encodeHeader(
+                    $hdr_name, $hdr_value,
+                    $build_params['head_charset'], $build_params['head_encoding']
+                );
+            }
+        }
+
+        return $input;
+    }
+
+    /**
+     * Encodes a header as per RFC2047
+     *
+     * @param string $name     The header name
+     * @param string $value    The header data to encode
+     * @param string $charset  Character set name
+     * @param string $encoding Encoding name (base64 or quoted-printable)
+     *
+     * @return string          Encoded header data (without a name)
+     * @access public
+     * @since 1.5.3
+     */
+    function encodeHeader($name, $value, $charset, $encoding)
+    {
+        $mime_part = new Mail_mimePart;
+        return $mime_part->encodeHeader(
+            $name, $value, $charset, $encoding, $this->_build_params['eol']
+        );
+    }
+
+    /**
+     * Get file's basename (locale independent) 
+     *
+     * @param string $filename Filename
+     *
+     * @return string          Basename
+     * @access private
+     */
+    function _basename($filename)
+    {
+        // basename() is not unicode safe and locale dependent
+        if (stristr(PHP_OS, 'win') || stristr(PHP_OS, 'netware')) {
+            return preg_replace('/^.*[\\\\\\/]/', '', $filename);
+        } else {
+            return preg_replace('/^.*[\/]/', '', $filename);
+        }
+    }
+
+    /**
+     * Get Content-Type and Content-Transfer-Encoding headers of the message
+     *
+     * @return array Headers array
+     * @access private
+     */
+    function _contentHeaders()
+    {
+        $attachments = count($this->_parts)                 ? true : false;
+        $html_images = count($this->_html_images)           ? true : false;
+        $html        = strlen($this->_htmlbody)             ? true : false;
+        $text        = (!$html && strlen($this->_txtbody))  ? true : false;
+        $headers     = array();
+
+        // See get()
+        switch (true) {
+        case $text && !$attachments:
+            $headers['Content-Type'] = 'text/plain';
+            break;
+
+        case !$text && !$html && $attachments:
+        case $text && $attachments:
+        case $html && $attachments && !$html_images:
+        case $html && $attachments && $html_images:
+            $headers['Content-Type'] = 'multipart/mixed';
+            break;
+
+        case $html && !$attachments && !$html_images && isset($this->_txtbody):
+        case $html && !$attachments && $html_images && isset($this->_txtbody):
+            $headers['Content-Type'] = 'multipart/alternative';
+            break;
+
+        case $html && !$attachments && !$html_images && !isset($this->_txtbody):
+            $headers['Content-Type'] = 'text/html';
+            break;
+
+        case $html && !$attachments && $html_images && !isset($this->_txtbody):
+            $headers['Content-Type'] = 'multipart/related';
+            break;
+
+        default:
+            return $headers;
+        }
+
+        $this->_checkParams();
+
+        $eol = !empty($this->_build_params['eol'])
+            ? $this->_build_params['eol'] : "\r\n";
+
+        if ($headers['Content-Type'] == 'text/plain') {
+            // single-part message: add charset and encoding
+            $charset = 'charset=' . $this->_build_params['text_charset'];
+            // place charset parameter in the same line, if possible
+            // 26 = strlen("Content-Type: text/plain; ")
+            $headers['Content-Type']
+                .= (strlen($charset) + 26 <= 76) ? "; $charset" : ";$eol $charset";
+            $headers['Content-Transfer-Encoding']
+                = $this->_build_params['text_encoding'];
+        } else if ($headers['Content-Type'] == 'text/html') {
+            // single-part message: add charset and encoding
+            $charset = 'charset=' . $this->_build_params['html_charset'];
+            // place charset parameter in the same line, if possible
+            $headers['Content-Type']
+                .= (strlen($charset) + 25 <= 76) ? "; $charset" : ";$eol $charset";
+            $headers['Content-Transfer-Encoding']
+                = $this->_build_params['html_encoding'];
+        } else {
+            // multipart message: and boundary
+            if (!empty($this->_build_params['boundary'])) {
+                $boundary = $this->_build_params['boundary'];
+            } else if (!empty($this->_headers['Content-Type'])
+                && preg_match('/boundary="([^"]+)"/', $this->_headers['Content-Type'], $m)
+            ) {
+                $boundary = $m[1];
+            } else {
+                $boundary = '=_' . md5(rand() . microtime());
+            }
+
+            $this->_build_params['boundary'] = $boundary;
+            $headers['Content-Type'] .= ";$eol boundary=\"$boundary\"";
+        }
+
+        return $headers;
+    }
+
+    /**
+     * Validate and set build parameters
+     *
+     * @return void
+     * @access private
+     */
+    function _checkParams()
+    {
+        $encodings = array('7bit', '8bit', 'base64', 'quoted-printable');
+
+        $this->_build_params['text_encoding']
+            = strtolower($this->_build_params['text_encoding']);
+        $this->_build_params['html_encoding']
+            = strtolower($this->_build_params['html_encoding']);
+
+        if (!in_array($this->_build_params['text_encoding'], $encodings)) {
+            $this->_build_params['text_encoding'] = '7bit';
+        }
+        if (!in_array($this->_build_params['html_encoding'], $encodings)) {
+            $this->_build_params['html_encoding'] = '7bit';
+        }
+
+        // text body
+        if ($this->_build_params['text_encoding'] == '7bit'
+            && !preg_match('/ascii/i', $this->_build_params['text_charset'])
+            && preg_match('/[^\x00-\x7F]/', $this->_txtbody)
+        ) {
+            $this->_build_params['text_encoding'] = 'quoted-printable';
+        }
+        // html body
+        if ($this->_build_params['html_encoding'] == '7bit'
+            && !preg_match('/ascii/i', $this->_build_params['html_charset'])
+            && preg_match('/[^\x00-\x7F]/', $this->_htmlbody)
+        ) {
+            $this->_build_params['html_encoding'] = 'quoted-printable';
+        }
+    }
+
+    /**
+     * PEAR::isError wrapper
+     *
+     * @param mixed $data Object
+     *
+     * @return bool True if object is an instance of PEAR_Error
+     * @access private
+     */
+    function _isError($data)
+    {
+        // PEAR::isError() is not PHP 5.4 compatible (see Bug #19473)
+        if (is_object($data) && is_a($data, 'PEAR_Error')) {
+            return true;
+        }
+
+        return false;
+    }
+
+} // End of class
diff --git a/apps/frontend/lib/mail/Mail/mimePart.php b/apps/frontend/lib/mail/Mail/mimePart.php
new file mode 100755
index 0000000..ce53a7b
--- /dev/null
+++ b/apps/frontend/lib/mail/Mail/mimePart.php
@@ -0,0 +1,1247 @@
+<?php
+/**
+ * The Mail_mimePart class is used to create MIME E-mail messages
+ *
+ * This class enables you to manipulate and build a mime email
+ * from the ground up. The Mail_Mime class is a userfriendly api
+ * to this class for people who aren't interested in the internals
+ * of mime mail.
+ * This class however allows full control over the email.
+ *
+ * Compatible with PHP versions 4 and 5
+ *
+ * LICENSE: This LICENSE is in the BSD license style.
+ * Copyright (c) 2002-2003, Richard Heyes <richard@phpguru.org>
+ * Copyright (c) 2003-2006, PEAR <pear-group@php.net>
+ * All rights reserved.
+ *
+ * Redistribution and use in source and binary forms, with or
+ * without modification, are permitted provided that the following
+ * conditions are met:
+ *
+ * - Redistributions of source code must retain the above copyright
+ *   notice, this list of conditions and the following disclaimer.
+ * - Redistributions in binary form must reproduce the above copyright
+ *   notice, this list of conditions and the following disclaimer in the
+ *   documentation and/or other materials provided with the distribution.
+ * - Neither the name of the authors, nor the names of its contributors 
+ *   may be used to endorse or promote products derived from this 
+ *   software without specific prior written permission.
+ *
+ * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"
+ * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
+ * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
+ * ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE
+ * LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR
+ * CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF
+ * SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS
+ * INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
+ * CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
+ * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF
+ * THE POSSIBILITY OF SUCH DAMAGE.
+ *
+ * @category  Mail
+ * @package   Mail_Mime
+ * @author    Richard Heyes  <richard@phpguru.org>
+ * @author    Cipriano Groenendal <cipri@php.net>
+ * @author    Sean Coates <sean@php.net>
+ * @author    Aleksander Machniak <alec@php.net>
+ * @copyright 2003-2006 PEAR <pear-group@php.net>
+ * @license   http://www.opensource.org/licenses/bsd-license.php BSD License
+ * @version   CVS: $Id$
+ * @link      http://pear.php.net/package/Mail_mime
+ */
+
+
+/**
+ * The Mail_mimePart class is used to create MIME E-mail messages
+ *
+ * This class enables you to manipulate and build a mime email
+ * from the ground up. The Mail_Mime class is a userfriendly api
+ * to this class for people who aren't interested in the internals
+ * of mime mail.
+ * This class however allows full control over the email.
+ *
+ * @category  Mail
+ * @package   Mail_Mime
+ * @author    Richard Heyes  <richard@phpguru.org>
+ * @author    Cipriano Groenendal <cipri@php.net>
+ * @author    Sean Coates <sean@php.net>
+ * @author    Aleksander Machniak <alec@php.net>
+ * @copyright 2003-2006 PEAR <pear-group@php.net>
+ * @license   http://www.opensource.org/licenses/bsd-license.php BSD License
+ * @version   Release: @package_version@
+ * @link      http://pear.php.net/package/Mail_mime
+ */
+class Mail_mimePart
+{
+    /**
+    * The encoding type of this part
+    *
+    * @var string
+    * @access private
+    */
+    var $_encoding;
+
+    /**
+    * An array of subparts
+    *
+    * @var array
+    * @access private
+    */
+    var $_subparts;
+
+    /**
+    * The output of this part after being built
+    *
+    * @var string
+    * @access private
+    */
+    var $_encoded;
+
+    /**
+    * Headers for this part
+    *
+    * @var array
+    * @access private
+    */
+    var $_headers;
+
+    /**
+    * The body of this part (not encoded)
+    *
+    * @var string
+    * @access private
+    */
+    var $_body;
+
+    /**
+    * The location of file with body of this part (not encoded)
+    *
+    * @var string
+    * @access private
+    */
+    var $_body_file;
+
+    /**
+    * The end-of-line sequence
+    *
+    * @var string
+    * @access private
+    */
+    var $_eol = "\r\n";
+
+
+    /**
+    * Constructor.
+    *
+    * Sets up the object.
+    *
+    * @param string $body   The body of the mime part if any.
+    * @param array  $params An associative array of optional parameters:
+    *     content_type      - The content type for this part eg multipart/mixed
+    *     encoding          - The encoding to use, 7bit, 8bit,
+    *                         base64, or quoted-printable
+    *     charset           - Content character set
+    *     cid               - Content ID to apply
+    *     disposition       - Content disposition, inline or attachment
+    *     filename          - Filename parameter for content disposition
+    *     description       - Content description
+    *     name_encoding     - Encoding of the attachment name (Content-Type)
+    *                         By default filenames are encoded using RFC2231
+    *                         Here you can set RFC2047 encoding (quoted-printable
+    *                         or base64) instead
+    *     filename_encoding - Encoding of the attachment filename (Content-Disposition)
+    *                         See 'name_encoding'
+    *     headers_charset   - Charset of the headers e.g. filename, description.
+    *                         If not set, 'charset' will be used
+    *     eol               - End of line sequence. Default: "\r\n"
+    *     headers           - Hash array with additional part headers. Array keys can be
+    *                         in form of <header_name>:<parameter_name>
+    *     body_file         - Location of file with part's body (instead of $body)
+    *
+    * @access public
+    */
+    function Mail_mimePart($body = '', $params = array())
+    {
+        if (!empty($params['eol'])) {
+            $this->_eol = $params['eol'];
+        } else if (defined('MAIL_MIMEPART_CRLF')) { // backward-copat.
+            $this->_eol = MAIL_MIMEPART_CRLF;
+        }
+
+        // Additional part headers
+        if (!empty($params['headers']) && is_array($params['headers'])) {
+            $headers = $params['headers'];
+        }
+
+        foreach ($params as $key => $value) {
+            switch ($key) {
+            case 'encoding':
+                $this->_encoding = $value;
+                $headers['Content-Transfer-Encoding'] = $value;
+                break;
+
+            case 'cid':
+                $headers['Content-ID'] = '<' . $value . '>';
+                break;
+
+            case 'location':
+                $headers['Content-Location'] = $value;
+                break;
+
+            case 'body_file':
+                $this->_body_file = $value;
+                break;
+
+            // for backward compatibility
+            case 'dfilename':
+                $params['filename'] = $value;
+                break;
+            }
+        }
+
+        // Default content-type
+        if (empty($params['content_type'])) {
+            $params['content_type'] = 'text/plain';
+        }
+
+        // Content-Type
+        $headers['Content-Type'] = $params['content_type'];
+        if (!empty($params['charset'])) {
+            $charset = "charset={$params['charset']}";
+            // place charset parameter in the same line, if possible
+            if ((strlen($headers['Content-Type']) + strlen($charset) + 16) <= 76) {
+                $headers['Content-Type'] .= '; ';
+            } else {
+                $headers['Content-Type'] .= ';' . $this->_eol . ' ';
+            }
+            $headers['Content-Type'] .= $charset;
+
+            // Default headers charset
+            if (!isset($params['headers_charset'])) {
+                $params['headers_charset'] = $params['charset'];
+            }
+        }
+
+        // header values encoding parameters
+        $h_charset  = !empty($params['headers_charset']) ? $params['headers_charset'] : 'US-ASCII';
+        $h_language = !empty($params['language']) ? $params['language'] : null;
+        $h_encoding = !empty($params['name_encoding']) ? $params['name_encoding'] : null;
+
+
+        if (!empty($params['filename'])) {
+            $headers['Content-Type'] .= ';' . $this->_eol;
+            $headers['Content-Type'] .= $this->_buildHeaderParam(
+                'name', $params['filename'], $h_charset, $h_language, $h_encoding
+            );
+        }
+
+        // Content-Disposition
+        if (!empty($params['disposition'])) {
+            $headers['Content-Disposition'] = $params['disposition'];
+            if (!empty($params['filename'])) {
+                $headers['Content-Disposition'] .= ';' . $this->_eol;
+                $headers['Content-Disposition'] .= $this->_buildHeaderParam(
+                    'filename', $params['filename'], $h_charset, $h_language,
+                    !empty($params['filename_encoding']) ? $params['filename_encoding'] : null
+                );
+            }
+
+            // add attachment size
+            $size = $this->_body_file ? filesize($this->_body_file) : strlen($body);
+            if ($size) {
+                $headers['Content-Disposition'] .= ';' . $this->_eol . ' size=' . $size;
+            }
+        }
+
+        if (!empty($params['description'])) {
+            $headers['Content-Description'] = $this->encodeHeader(
+                'Content-Description', $params['description'], $h_charset, $h_encoding,
+                $this->_eol
+            );
+        }
+
+        // Search and add existing headers' parameters
+        foreach ($headers as $key => $value) {
+            $items = explode(':', $key);
+            if (count($items) == 2) {
+                $header = $items[0];
+                $param  = $items[1];
+                if (isset($headers[$header])) {
+                    $headers[$header] .= ';' . $this->_eol;
+                }
+                $headers[$header] .= $this->_buildHeaderParam(
+                    $param, $value, $h_charset, $h_language, $h_encoding
+                );
+                unset($headers[$key]);
+            }
+        }
+
+        // Default encoding
+        if (!isset($this->_encoding)) {
+            $this->_encoding = '7bit';
+        }
+
+        // Assign stuff to member variables
+        $this->_encoded  = array();
+        $this->_headers  = $headers;
+        $this->_body     = $body;
+    }
+
+    /**
+     * Encodes and returns the email. Also stores
+     * it in the encoded member variable
+     *
+     * @param string $boundary Pre-defined boundary string
+     *
+     * @return An associative array containing two elements,
+     *         body and headers. The headers element is itself
+     *         an indexed array. On error returns PEAR error object.
+     * @access public
+     */
+    function encode($boundary=null)
+    {
+        $encoded =& $this->_encoded;
+
+        if (count($this->_subparts)) {
+            $boundary = $boundary ? $boundary : '=_' . md5(rand() . microtime());
+            $eol = $this->_eol;
+
+            $this->_headers['Content-Type'] .= ";$eol boundary=\"$boundary\"";
+
+            $encoded['body'] = ''; 
+
+            for ($i = 0; $i < count($this->_subparts); $i++) {
+                $encoded['body'] .= '--' . $boundary . $eol;
+                $tmp = $this->_subparts[$i]->encode();
+                if ($this->_isError($tmp)) {
+                    return $tmp;
+                }
+                foreach ($tmp['headers'] as $key => $value) {
+                    $encoded['body'] .= $key . ': ' . $value . $eol;
+                }
+                $encoded['body'] .= $eol . $tmp['body'] . $eol;
+            }
+
+            $encoded['body'] .= '--' . $boundary . '--' . $eol;
+
+        } else if ($this->_body) {
+            $encoded['body'] = $this->_getEncodedData($this->_body, $this->_encoding);
+        } else if ($this->_body_file) {
+            // Temporarily reset magic_quotes_runtime for file reads and writes
+            if ($magic_quote_setting = get_magic_quotes_runtime()) {
+                @ini_set('magic_quotes_runtime', 0);
+            }
+            $body = $this->_getEncodedDataFromFile($this->_body_file, $this->_encoding);
+            if ($magic_quote_setting) {
+                @ini_set('magic_quotes_runtime', $magic_quote_setting);
+            }
+
+            if ($this->_isError($body)) {
+                return $body;
+            }
+            $encoded['body'] = $body;
+        } else {
+            $encoded['body'] = '';
+        }
+
+        // Add headers to $encoded
+        $encoded['headers'] =& $this->_headers;
+
+        return $encoded;
+    }
+
+    /**
+     * Encodes and saves the email into file. File must exist.
+     * Data will be appended to the file.
+     *
+     * @param string  $filename  Output file location
+     * @param string  $boundary  Pre-defined boundary string
+     * @param boolean $skip_head True if you don't want to save headers
+     *
+     * @return array An associative array containing message headers
+     *               or PEAR error object
+     * @access public
+     * @since 1.6.0
+     */
+    function encodeToFile($filename, $boundary=null, $skip_head=false)
+    {
+        if (file_exists($filename) && !is_writable($filename)) {
+            $err = PEAR::raiseError('File is not writeable: ' . $filename);
+            return $err;
+        }
+
+        if (!($fh = fopen($filename, 'ab'))) {
+            $err = PEAR::raiseError('Unable to open file: ' . $filename);
+            return $err;
+        }
+
+        // Temporarily reset magic_quotes_runtime for file reads and writes
+        if ($magic_quote_setting = get_magic_quotes_runtime()) {
+            @ini_set('magic_quotes_runtime', 0);
+        }
+
+        $res = $this->_encodePartToFile($fh, $boundary, $skip_head);
+
+        fclose($fh);
+
+        if ($magic_quote_setting) {
+            @ini_set('magic_quotes_runtime', $magic_quote_setting);
+        }
+
+        return $this->_isError($res) ? $res : $this->_headers;
+    }
+
+    /**
+     * Encodes given email part into file
+     *
+     * @param string  $fh        Output file handle
+     * @param string  $boundary  Pre-defined boundary string
+     * @param boolean $skip_head True if you don't want to save headers
+     *
+     * @return array True on sucess or PEAR error object
+     * @access private
+     */
+    function _encodePartToFile($fh, $boundary=null, $skip_head=false)
+    {
+        $eol = $this->_eol;
+
+        if (count($this->_subparts)) {
+            $boundary = $boundary ? $boundary : '=_' . md5(rand() . microtime());
+            $this->_headers['Content-Type'] .= ";$eol boundary=\"$boundary\"";
+        }
+
+        if (!$skip_head) {
+            foreach ($this->_headers as $key => $value) {
+                fwrite($fh, $key . ': ' . $value . $eol);
+            }
+            $f_eol = $eol;
+        } else {
+            $f_eol = '';
+        }
+
+        if (count($this->_subparts)) {
+            for ($i = 0; $i < count($this->_subparts); $i++) {
+                fwrite($fh, $f_eol . '--' . $boundary . $eol);
+                $res = $this->_subparts[$i]->_encodePartToFile($fh);
+                if ($this->_isError($res)) {
+                    return $res;
+                }
+                $f_eol = $eol;
+            }
+
+            fwrite($fh, $eol . '--' . $boundary . '--' . $eol);
+
+        } else if ($this->_body) {
+            fwrite($fh, $f_eol . $this->_getEncodedData($this->_body, $this->_encoding));
+        } else if ($this->_body_file) {
+            fwrite($fh, $f_eol);
+            $res = $this->_getEncodedDataFromFile(
+                $this->_body_file, $this->_encoding, $fh
+            );
+            if ($this->_isError($res)) {
+                return $res;
+            }
+        }
+
+        return true;
+    }
+
+    /**
+     * Adds a subpart to current mime part and returns
+     * a reference to it
+     *
+     * @param string $body   The body of the subpart, if any.
+     * @param array  $params The parameters for the subpart, same
+     *                       as the $params argument for constructor.
+     *
+     * @return Mail_mimePart A reference to the part you just added. It is
+     *                       crucial if using multipart/* in your subparts that
+     *                       you use =& in your script when calling this function,
+     *                       otherwise you will not be able to add further subparts.
+     * @access public
+     */
+    function &addSubpart($body, $params)
+    {
+        $this->_subparts[] = new Mail_mimePart($body, $params);
+        return $this->_subparts[count($this->_subparts) - 1];
+    }
+
+    /**
+     * Returns encoded data based upon encoding passed to it
+     *
+     * @param string $data     The data to encode.
+     * @param string $encoding The encoding type to use, 7bit, base64,
+     *                         or quoted-printable.
+     *
+     * @return string
+     * @access private
+     */
+    function _getEncodedData($data, $encoding)
+    {
+        switch ($encoding) {
+        case 'quoted-printable':
+            return $this->_quotedPrintableEncode($data);
+            break;
+
+        case 'base64':
+            return rtrim(chunk_split(base64_encode($data), 76, $this->_eol));
+            break;
+
+        case '8bit':
+        case '7bit':
+        default:
+            return $data;
+        }
+    }
+
+    /**
+     * Returns encoded data based upon encoding passed to it
+     *
+     * @param string   $filename Data file location
+     * @param string   $encoding The encoding type to use, 7bit, base64,
+     *                           or quoted-printable.
+     * @param resource $fh       Output file handle. If set, data will be
+     *                           stored into it instead of returning it
+     *
+     * @return string Encoded data or PEAR error object
+     * @access private
+     */
+    function _getEncodedDataFromFile($filename, $encoding, $fh=null)
+    {
+        if (!is_readable($filename)) {
+            $err = PEAR::raiseError('Unable to read file: ' . $filename);
+            return $err;
+        }
+
+        if (!($fd = fopen($filename, 'rb'))) {
+            $err = PEAR::raiseError('Could not open file: ' . $filename);
+            return $err;
+        }
+
+        $data = '';
+
+        switch ($encoding) {
+        case 'quoted-printable':
+            while (!feof($fd)) {
+                $buffer = $this->_quotedPrintableEncode(fgets($fd));
+                if ($fh) {
+                    fwrite($fh, $buffer);
+                } else {
+                    $data .= $buffer;
+                }
+            }
+            break;
+
+        case 'base64':
+            while (!feof($fd)) {
+                // Should read in a multiple of 57 bytes so that
+                // the output is 76 bytes per line. Don't use big chunks
+                // because base64 encoding is memory expensive
+                $buffer = fread($fd, 57 * 9198); // ca. 0.5 MB
+                $buffer = base64_encode($buffer);
+                $buffer = chunk_split($buffer, 76, $this->_eol);
+                if (feof($fd)) {
+                    $buffer = rtrim($buffer);
+                }
+
+                if ($fh) {
+                    fwrite($fh, $buffer);
+                } else {
+                    $data .= $buffer;
+                }
+            }
+            break;
+
+        case '8bit':
+        case '7bit':
+        default:
+            while (!feof($fd)) {
+                $buffer = fread($fd, 1048576); // 1 MB
+                if ($fh) {
+                    fwrite($fh, $buffer);
+                } else {
+                    $data .= $buffer;
+                }
+            }
+        }
+
+        fclose($fd);
+
+        if (!$fh) {
+            return $data;
+        }
+    }
+
+    /**
+     * Encodes data to quoted-printable standard.
+     *
+     * @param string $input    The data to encode
+     * @param int    $line_max Optional max line length. Should
+     *                         not be more than 76 chars
+     *
+     * @return string Encoded data
+     *
+     * @access private
+     */
+    function _quotedPrintableEncode($input , $line_max = 76)
+    {
+        $eol = $this->_eol;
+        /*
+        // imap_8bit() is extremely fast, but doesn't handle properly some characters
+        if (function_exists('imap_8bit') && $line_max == 76) {
+            $input = preg_replace('/\r?\n/', "\r\n", $input);
+            $input = imap_8bit($input);
+            if ($eol != "\r\n") {
+                $input = str_replace("\r\n", $eol, $input);
+            }
+            return $input;
+        }
+        */
+        $lines  = preg_split("/\r?\n/", $input);
+        $escape = '=';
+        $output = '';
+
+        while (list($idx, $line) = each($lines)) {
+            $newline = '';
+            $i = 0;
+
+            while (isset($line[$i])) {
+                $char = $line[$i];
+                $dec  = ord($char);
+                $i++;
+
+                if (($dec == 32) && (!isset($line[$i]))) {
+                    // convert space at eol only
+                    $char = '=20';
+                } elseif ($dec == 9 && isset($line[$i])) {
+                    ; // Do nothing if a TAB is not on eol
+                } elseif (($dec == 61) || ($dec < 32) || ($dec > 126)) {
+                    $char = $escape . sprintf('%02X', $dec);
+                } elseif (($dec == 46) && (($newline == '')
+                    || ((strlen($newline) + strlen("=2E")) >= $line_max))
+                ) {
+                    // Bug #9722: convert full-stop at bol,
+                    // some Windows servers need this, won't break anything (cipri)
+                    // Bug #11731: full-stop at bol also needs to be encoded
+                    // if this line would push us over the line_max limit.
+                    $char = '=2E';
+                }
+
+                // Note, when changing this line, also change the ($dec == 46)
+                // check line, as it mimics this line due to Bug #11731
+                // EOL is not counted
+                if ((strlen($newline) + strlen($char)) >= $line_max) {
+                    // soft line break; " =\r\n" is okay
+                    $output  .= $newline . $escape . $eol;
+                    $newline  = '';
+                }
+                $newline .= $char;
+            } // end of for
+            $output .= $newline . $eol;
+            unset($lines[$idx]);
+        }
+        // Don't want last crlf
+        $output = substr($output, 0, -1 * strlen($eol));
+        return $output;
+    }
+
+    /**
+     * Encodes the paramater of a header.
+     *
+     * @param string $name      The name of the header-parameter
+     * @param string $value     The value of the paramter
+     * @param string $charset   The characterset of $value
+     * @param string $language  The language used in $value
+     * @param string $encoding  Parameter encoding. If not set, parameter value
+     *                          is encoded according to RFC2231
+     * @param int    $maxLength The maximum length of a line. Defauls to 75
+     *
+     * @return string
+     *
+     * @access private
+     */
+    function _buildHeaderParam($name, $value, $charset=null, $language=null,
+        $encoding=null, $maxLength=75
+    ) {
+        // RFC 2045:
+        // value needs encoding if contains non-ASCII chars or is longer than 78 chars
+        if (!preg_match('#[^\x20-\x7E]#', $value)) {
+            $token_regexp = '#([^\x21\x23-\x27\x2A\x2B\x2D'
+                . '\x2E\x30-\x39\x41-\x5A\x5E-\x7E])#';
+            if (!preg_match($token_regexp, $value)) {
+                // token
+                if (strlen($name) + strlen($value) + 3 <= $maxLength) {
+                    return " {$name}={$value}";
+                }
+            } else {
+                // quoted-string
+                $quoted = addcslashes($value, '\\"');
+                if (strlen($name) + strlen($quoted) + 5 <= $maxLength) {
+                    return " {$name}=\"{$quoted}\"";
+                }
+            }
+        }
+
+        // RFC2047: use quoted-printable/base64 encoding
+        if ($encoding == 'quoted-printable' || $encoding == 'base64') {
+            return $this->_buildRFC2047Param($name, $value, $charset, $encoding);
+        }
+
+        // RFC2231:
+        $encValue = preg_replace_callback(
+            '/([^\x21\x23\x24\x26\x2B\x2D\x2E\x30-\x39\x41-\x5A\x5E-\x7E])/',
+            array($this, '_encodeReplaceCallback'), $value
+        );
+        $value = "$charset'$language'$encValue";
+
+        $header = " {$name}*={$value}";
+        if (strlen($header) <= $maxLength) {
+            return $header;
+        }
+
+        $preLength = strlen(" {$name}*0*=");
+        $maxLength = max(16, $maxLength - $preLength - 3);
+        $maxLengthReg = "|(.{0,$maxLength}[^\%][^\%])|";
+
+        $headers = array();
+        $headCount = 0;
+        while ($value) {
+            $matches = array();
+            $found = preg_match($maxLengthReg, $value, $matches);
+            if ($found) {
+                $headers[] = " {$name}*{$headCount}*={$matches[0]}";
+                $value = substr($value, strlen($matches[0]));
+            } else {
+                $headers[] = " {$name}*{$headCount}*={$value}";
+                $value = '';
+            }
+            $headCount++;
+        }
+
+        $headers = implode(';' . $this->_eol, $headers);
+        return $headers;
+    }
+
+    /**
+     * Encodes header parameter as per RFC2047 if needed
+     *
+     * @param string $name      The parameter name
+     * @param string $value     The parameter value
+     * @param string $charset   The parameter charset
+     * @param string $encoding  Encoding type (quoted-printable or base64)
+     * @param int    $maxLength Encoded parameter max length. Default: 76
+     *
+     * @return string Parameter line
+     * @access private
+     */
+    function _buildRFC2047Param($name, $value, $charset,
+        $encoding='quoted-printable', $maxLength=76
+    ) {
+        // WARNING: RFC 2047 says: "An 'encoded-word' MUST NOT be used in
+        // parameter of a MIME Content-Type or Content-Disposition field",
+        // but... it's supported by many clients/servers
+        $quoted = '';
+
+        if ($encoding == 'base64') {
+            $value = base64_encode($value);
+            $prefix = '=?' . $charset . '?B?';
+            $suffix = '?=';
+
+            // 2 x SPACE, 2 x '"', '=', ';'
+            $add_len = strlen($prefix . $suffix) + strlen($name) + 6;
+            $len = $add_len + strlen($value);
+
+            while ($len > $maxLength) { 
+                // We can cut base64-encoded string every 4 characters
+                $real_len = floor(($maxLength - $add_len) / 4) * 4;
+                $_quote = substr($value, 0, $real_len);
+                $value = substr($value, $real_len);
+
+                $quoted .= $prefix . $_quote . $suffix . $this->_eol . ' ';
+                $add_len = strlen($prefix . $suffix) + 4; // 2 x SPACE, '"', ';'
+                $len = strlen($value) + $add_len;
+            }
+            $quoted .= $prefix . $value . $suffix;
+
+        } else {
+            // quoted-printable
+            $value = $this->encodeQP($value);
+            $prefix = '=?' . $charset . '?Q?';
+            $suffix = '?=';
+
+            // 2 x SPACE, 2 x '"', '=', ';'
+            $add_len = strlen($prefix . $suffix) + strlen($name) + 6;
+            $len = $add_len + strlen($value);
+
+            while ($len > $maxLength) {
+                $length = $maxLength - $add_len;
+                // don't break any encoded letters
+                if (preg_match("/^(.{0,$length}[^\=][^\=])/", $value, $matches)) {
+                    $_quote = $matches[1];
+                }
+
+                $quoted .= $prefix . $_quote . $suffix . $this->_eol . ' ';
+                $value = substr($value, strlen($_quote));
+                $add_len = strlen($prefix . $suffix) + 4; // 2 x SPACE, '"', ';'
+                $len = strlen($value) + $add_len;
+            }
+
+            $quoted .= $prefix . $value . $suffix;
+        }
+
+        return " {$name}=\"{$quoted}\"";
+    }
+
+    /**
+     * Encodes a header as per RFC2047
+     *
+     * @param string $name     The header name
+     * @param string $value    The header data to encode
+     * @param string $charset  Character set name
+     * @param string $encoding Encoding name (base64 or quoted-printable)
+     * @param string $eol      End-of-line sequence. Default: "\r\n"
+     *
+     * @return string          Encoded header data (without a name)
+     * @access public
+     * @since 1.6.1
+     */
+    function encodeHeader($name, $value, $charset='ISO-8859-1',
+        $encoding='quoted-printable', $eol="\r\n"
+    ) {
+        // Structured headers
+        $comma_headers = array(
+            'from', 'to', 'cc', 'bcc', 'sender', 'reply-to',
+            'resent-from', 'resent-to', 'resent-cc', 'resent-bcc',
+            'resent-sender', 'resent-reply-to',
+            'mail-reply-to', 'mail-followup-to',
+            'return-receipt-to', 'disposition-notification-to',
+        );
+        $other_headers = array(
+            'references', 'in-reply-to', 'message-id', 'resent-message-id',
+        );
+
+        $name = strtolower($name);
+
+        if (in_array($name, $comma_headers)) {
+            $separator = ',';
+        } else if (in_array($name, $other_headers)) {
+            $separator = ' ';
+        }
+
+        if (!$charset) {
+            $charset = 'ISO-8859-1';
+        }
+
+        // Structured header (make sure addr-spec inside is not encoded)
+        if (!empty($separator)) {
+            // Simple e-mail address regexp
+            $email_regexp = '([^\s<]+|("[^\r\n"]+"))@\S+';
+
+            $parts = Mail_mimePart::_explodeQuotedString($separator, $value);
+            $value = '';
+
+            foreach ($parts as $part) {
+                $part = preg_replace('/\r?\n[\s\t]*/', $eol . ' ', $part);
+                $part = trim($part);
+
+                if (!$part) {
+                    continue;
+                }
+                if ($value) {
+                    $value .= $separator==',' ? $separator.' ' : ' ';
+                } else {
+                    $value = $name . ': ';
+                }
+
+                // let's find phrase (name) and/or addr-spec
+                if (preg_match('/^<' . $email_regexp . '>$/', $part)) {
+                    $value .= $part;
+                } else if (preg_match('/^' . $email_regexp . '$/', $part)) {
+                    // address without brackets and without name
+                    $value .= $part;
+                } else if (preg_match('/<*' . $email_regexp . '>*$/', $part, $matches)) {
+                    // address with name (handle name)
+                    $address = $matches[0];
+                    $word = str_replace($address, '', $part);
+                    $word = trim($word);
+                    // check if phrase requires quoting
+                    if ($word) {
+                        // non-ASCII: require encoding
+                        if (preg_match('#([\x80-\xFF]){1}#', $word)) {
+                            if ($word[0] == '"' && $word[strlen($word)-1] == '"') {
+                                // de-quote quoted-string, encoding changes
+                                // string to atom
+                                $search = array("\\\"", "\\\\");
+                                $replace = array("\"", "\\");
+                                $word = str_replace($search, $replace, $word);
+                                $word = substr($word, 1, -1);
+                            }
+                            // find length of last line
+                            if (($pos = strrpos($value, $eol)) !== false) {
+                                $last_len = strlen($value) - $pos;
+                            } else {
+                                $last_len = strlen($value);
+                            }
+                            $word = Mail_mimePart::encodeHeaderValue(
+                                $word, $charset, $encoding, $last_len, $eol
+                            );
+                        } else if (($word[0] != '"' || $word[strlen($word)-1] != '"')
+                            && preg_match('/[\(\)\<\>\\\.\[\]@,;:"]/', $word)
+                        ) {
+                            // ASCII: quote string if needed
+                            $word = '"'.addcslashes($word, '\\"').'"';
+                        }
+                    }
+                    $value .= $word.' '.$address;
+                } else {
+                    // addr-spec not found, don't encode (?)
+                    $value .= $part;
+                }
+
+                // RFC2822 recommends 78 characters limit, use 76 from RFC2047
+                $value = wordwrap($value, 76, $eol . ' ');
+            }
+
+            // remove header name prefix (there could be EOL too)
+            $value = preg_replace(
+                '/^'.$name.':('.preg_quote($eol, '/').')* /', '', $value
+            );
+
+        } else {
+            // Unstructured header
+            // non-ASCII: require encoding
+            if (preg_match('#([\x80-\xFF]){1}#', $value)) {
+                if ($value[0] == '"' && $value[strlen($value)-1] == '"') {
+                    // de-quote quoted-string, encoding changes
+                    // string to atom
+                    $search = array("\\\"", "\\\\");
+                    $replace = array("\"", "\\");
+                    $value = str_replace($search, $replace, $value);
+                    $value = substr($value, 1, -1);
+                }
+                $value = Mail_mimePart::encodeHeaderValue(
+                    $value, $charset, $encoding, strlen($name) + 2, $eol
+                );
+            } else if (strlen($name.': '.$value) > 78) {
+                // ASCII: check if header line isn't too long and use folding
+                $value = preg_replace('/\r?\n[\s\t]*/', $eol . ' ', $value);
+                $tmp = wordwrap($name.': '.$value, 78, $eol . ' ');
+                $value = preg_replace('/^'.$name.':\s*/', '', $tmp);
+                // hard limit 998 (RFC2822)
+                $value = wordwrap($value, 998, $eol . ' ', true);
+            }
+        }
+
+        return $value;
+    }
+
+    /**
+     * Explode quoted string
+     *
+     * @param string $delimiter Delimiter expression string for preg_match()
+     * @param string $string    Input string
+     *
+     * @return array            String tokens array
+     * @access private
+     */
+    function _explodeQuotedString($delimiter, $string)
+    {
+        $result = array();
+        $strlen = strlen($string);
+
+        for ($q=$p=$i=0; $i < $strlen; $i++) {
+            if ($string[$i] == "\""
+                && (empty($string[$i-1]) || $string[$i-1] != "\\")
+            ) {
+                $q = $q ? false : true;
+            } else if (!$q && preg_match("/$delimiter/", $string[$i])) {
+                $result[] = substr($string, $p, $i - $p);
+                $p = $i + 1;
+            }
+        }
+
+        $result[] = substr($string, $p);
+        return $result;
+    }
+
+    /**
+     * Encodes a header value as per RFC2047
+     *
+     * @param string $value      The header data to encode
+     * @param string $charset    Character set name
+     * @param string $encoding   Encoding name (base64 or quoted-printable)
+     * @param int    $prefix_len Prefix length. Default: 0
+     * @param string $eol        End-of-line sequence. Default: "\r\n"
+     *
+     * @return string            Encoded header data
+     * @access public
+     * @since 1.6.1
+     */
+    function encodeHeaderValue($value, $charset, $encoding, $prefix_len=0, $eol="\r\n")
+    {
+        // #17311: Use multibyte aware method (requires mbstring extension)
+        if ($result = Mail_mimePart::encodeMB($value, $charset, $encoding, $prefix_len, $eol)) {
+            return $result;
+        }
+
+        // Generate the header using the specified params and dynamicly
+        // determine the maximum length of such strings.
+        // 75 is the value specified in the RFC.
+        $encoding = $encoding == 'base64' ? 'B' : 'Q';
+        $prefix = '=?' . $charset . '?' . $encoding .'?';
+        $suffix = '?=';
+        $maxLength = 75 - strlen($prefix . $suffix);
+        $maxLength1stLine = $maxLength - $prefix_len;
+
+        if ($encoding == 'B') {
+            // Base64 encode the entire string
+            $value = base64_encode($value);
+
+            // We can cut base64 every 4 characters, so the real max
+            // we can get must be rounded down.
+            $maxLength = $maxLength - ($maxLength % 4);
+            $maxLength1stLine = $maxLength1stLine - ($maxLength1stLine % 4);
+
+            $cutpoint = $maxLength1stLine;
+            $output = '';
+
+            while ($value) {
+                // Split translated string at every $maxLength
+                $part = substr($value, 0, $cutpoint);
+                $value = substr($value, $cutpoint);
+                $cutpoint = $maxLength;
+                // RFC 2047 specifies that any split header should
+                // be seperated by a CRLF SPACE.
+                if ($output) {
+                    $output .= $eol . ' ';
+                }
+                $output .= $prefix . $part . $suffix;
+            }
+            $value = $output;
+        } else {
+            // quoted-printable encoding has been selected
+            $value = Mail_mimePart::encodeQP($value);
+
+            // This regexp will break QP-encoded text at every $maxLength
+            // but will not break any encoded letters.
+            $reg1st = "|(.{0,$maxLength1stLine}[^\=][^\=])|";
+            $reg2nd = "|(.{0,$maxLength}[^\=][^\=])|";
+
+            if (strlen($value) > $maxLength1stLine) {
+                // Begin with the regexp for the first line.
+                $reg = $reg1st;
+                $output = '';
+                while ($value) {
+                    // Split translated string at every $maxLength
+                    // But make sure not to break any translated chars.
+                    $found = preg_match($reg, $value, $matches);
+
+                    // After this first line, we need to use a different
+                    // regexp for the first line.
+                    $reg = $reg2nd;
+
+                    // Save the found part and encapsulate it in the
+                    // prefix & suffix. Then remove the part from the
+                    // $value_out variable.
+                    if ($found) {
+                        $part = $matches[0];
+                        $len = strlen($matches[0]);
+                        $value = substr($value, $len);
+                    } else {
+                        $part = $value;
+                        $value = '';
+                    }
+
+                    // RFC 2047 specifies that any split header should
+                    // be seperated by a CRLF SPACE
+                    if ($output) {
+                        $output .= $eol . ' ';
+                    }
+                    $output .= $prefix . $part . $suffix;
+                }
+                $value = $output;
+            } else {
+                $value = $prefix . $value . $suffix;
+            }
+        }
+
+        return $value;
+    }
+
+    /**
+     * Encodes the given string using quoted-printable
+     *
+     * @param string $str String to encode
+     *
+     * @return string     Encoded string
+     * @access public
+     * @since 1.6.0
+     */
+    function encodeQP($str)
+    {
+        // Bug #17226 RFC 2047 restricts some characters
+        // if the word is inside a phrase, permitted chars are only:
+        // ASCII letters, decimal digits, "!", "*", "+", "-", "/", "=", and "_"
+
+        // "=",  "_",  "?" must be encoded
+        $regexp = '/([\x22-\x29\x2C\x2E\x3A-\x40\x5B-\x60\x7B-\x7E\x80-\xFF])/';
+        $str = preg_replace_callback(
+            $regexp, array('Mail_mimePart', '_qpReplaceCallback'), $str
+        );
+
+        return str_replace(' ', '_', $str);
+    }
+
+    /**
+     * Encodes the given string using base64 or quoted-printable.
+     * This method makes sure that encoded-word represents an integral
+     * number of characters as per RFC2047.
+     *
+     * @param string $str        String to encode
+     * @param string $charset    Character set name
+     * @param string $encoding   Encoding name (base64 or quoted-printable)
+     * @param int    $prefix_len Prefix length. Default: 0
+     * @param string $eol        End-of-line sequence. Default: "\r\n"
+     *
+     * @return string     Encoded string
+     * @access public
+     * @since 1.8.0
+     */
+    function encodeMB($str, $charset, $encoding, $prefix_len=0, $eol="\r\n")
+    {
+        if (!function_exists('mb_substr') || !function_exists('mb_strlen')) {
+            return;
+        }
+
+        $encoding = $encoding == 'base64' ? 'B' : 'Q';
+        // 75 is the value specified in the RFC
+        $prefix = '=?' . $charset . '?'.$encoding.'?';
+        $suffix = '?=';
+        $maxLength = 75 - strlen($prefix . $suffix);
+
+        // A multi-octet character may not be split across adjacent encoded-words
+        // So, we'll loop over each character
+        // mb_stlen() with wrong charset will generate a warning here and return null
+        $length      = mb_strlen($str, $charset);
+        $result      = '';
+        $line_length = $prefix_len;
+
+        if ($encoding == 'B') {
+            // base64
+            $start = 0;
+            $prev  = '';
+
+            for ($i=1; $i<=$length; $i++) {
+                // See #17311
+                $chunk = mb_substr($str, $start, $i-$start, $charset);
+                $chunk = base64_encode($chunk);
+                $chunk_len = strlen($chunk);
+
+                if ($line_length + $chunk_len == $maxLength || $i == $length) {
+                    if ($result) {
+                        $result .= "\n";
+                    }
+                    $result .= $chunk;
+                    $line_length = 0;
+                    $start = $i;
+                } else if ($line_length + $chunk_len > $maxLength) {
+                    if ($result) {
+                        $result .= "\n";
+                    }
+                    if ($prev) {
+                        $result .= $prev;
+                    }
+                    $line_length = 0;
+                    $start = $i - 1;
+                } else {
+                    $prev = $chunk;
+                }
+            }
+        } else {
+            // quoted-printable
+            // see encodeQP()
+            $regexp = '/([\x22-\x29\x2C\x2E\x3A-\x40\x5B-\x60\x7B-\x7E\x80-\xFF])/';
+
+            for ($i=0; $i<=$length; $i++) {
+                $char = mb_substr($str, $i, 1, $charset);
+                // RFC recommends underline (instead of =20) in place of the space
+                // that's one of the reasons why we're not using iconv_mime_encode()
+                if ($char == ' ') {
+                    $char = '_';
+                    $char_len = 1;
+                } else {
+                    $char = preg_replace_callback(
+                        $regexp, array('Mail_mimePart', '_qpReplaceCallback'), $char
+                    );
+                    $char_len = strlen($char);
+                }
+
+                if ($line_length + $char_len > $maxLength) {
+                    if ($result) {
+                        $result .= "\n";
+                    }
+                    $line_length = 0;
+                }
+
+                $result      .= $char;
+                $line_length += $char_len;
+            }
+        }
+
+        if ($result) {
+            $result = $prefix
+                .str_replace("\n", $suffix.$eol.' '.$prefix, $result).$suffix;
+        }
+
+        return $result;
+    }
+
+    /**
+     * Callback function to replace extended characters (\x80-xFF) with their
+     * ASCII values (RFC2047: quoted-printable)
+     *
+     * @param array $matches Preg_replace's matches array
+     *
+     * @return string        Encoded character string
+     * @access private
+     */
+    function _qpReplaceCallback($matches)
+    {
+        return sprintf('=%02X', ord($matches[1]));
+    }
+
+    /**
+     * Callback function to replace extended characters (\x80-xFF) with their
+     * ASCII values (RFC2231)
+     *
+     * @param array $matches Preg_replace's matches array
+     *
+     * @return string        Encoded character string
+     * @access private
+     */
+    function _encodeReplaceCallback($matches)
+    {
+        return sprintf('%%%02X', ord($matches[1]));
+    }
+
+    /**
+     * PEAR::isError wrapper
+     *
+     * @param mixed $data Object
+     *
+     * @return bool True if object is an instance of PEAR_Error
+     * @access private
+     */
+    function _isError($data)
+    {
+        // PEAR::isError() is not PHP 5.4 compatible (see Bug #19473)
+        if (is_object($data) && is_a($data, 'PEAR_Error')) {
+            return true;
+        }
+
+        return false;
+    }
+
+} // End of class
diff --git a/apps/frontend/lib/mail/Mail/subida.txt b/apps/frontend/lib/mail/Mail/subida.txt
new file mode 100755
index 0000000..facee5f
--- /dev/null
+++ b/apps/frontend/lib/mail/Mail/subida.txt
@@ -0,0 +1 @@
+hola!!
diff --git a/apps/frontend/lib/mail/mail.php b/apps/frontend/lib/mail/mail.php
new file mode 100755
index 0000000..4b68ab8
--- /dev/null
+++ b/apps/frontend/lib/mail/mail.php
@@ -0,0 +1,84 @@
+<?php
+
+include('Mail.php');
+include('Mail/mime.php');
+
+class Email{
+	private $headers = array(
+                        'From'          => 'Mauri<mauri-tkd@hotmail.com>',
+                        'Return-Path'   => 'Mauri<mauri-tkd@hotmail.com>',
+                        'Subject'       => 'Arriendas S.A.'
+                        );
+	private $mime_params = array(
+						'text_charset'  => 'UTF-8',
+						'html_charset'  => 'UTF-8',
+						'head_charset'  => 'UTF-8'
+						);
+	private $to = 'Mauri<mauri-tkd@hotmail.com>';
+	private $html = '';
+	private $crlf = "\n";
+
+	private $files;
+	//private $file_name = "nombreArchivo.txt";
+	//private $content_type = 'application/pdf';
+	//private $content_type = "text/plain";
+	//private $content_type = "application/octet-stream";
+	//private $content_type = "image/jpg";
+
+	function __constructor(){   
+	}
+
+	public function setTo($to){
+		$this->to = $to;
+	}
+
+	//destinatario
+	public function setFrom($from){
+		$this->headers['From'] = $from;
+		$this->headers['Return-Path'] = $from;
+	}
+
+	//asunto
+	public function setSubject($subject){
+		$this->headers['Subject'] = $subject;
+	}
+
+	//cuerpo del mensaje en html
+	public function setBody($html){
+		$this->html = $html;
+	}
+
+	//adjunta archivo
+	public function setFile($file){
+		$this->files[] = $file;
+
+		$file = explode('.', $file);
+		$file = $file[count($file)-1];
+
+	}
+
+	//enva mail
+	public function submit(){
+		$mime = new Mail_mime(array('eol' => $this->crlf));
+		$mime->setHTMLBody($this->html);
+
+		foreach ($this->files as $file){
+			$mime->addAttachment($file);
+		}
+
+		$body = $mime->get($this->mime_params);
+        $headers = $mime->headers($this->headers);
+ 
+        // Sending the email
+        $mail =& Mail::factory('mail');
+        if($mail->send($this->to, $headers, $body)){
+        	return true;
+        }else{
+        	return false;
+        }        
+
+	}
+
+}
+
+?> 
\ No newline at end of file
diff --git a/apps/frontend/lib/mail/scripts/phail.php b/apps/frontend/lib/mail/scripts/phail.php
new file mode 100755
index 0000000..16755bb
--- /dev/null
+++ b/apps/frontend/lib/mail/scripts/phail.php
@@ -0,0 +1,47 @@
+#!@prefix@/bin/php -Cq
+<?php
+/**
+* PHAIL - stands for PHP Mail
+* @author Tomas V.V.Cox <cox@idecnet.com>
+*/
+require_once 'Mail.php';
+require_once 'Mail/mime.php';
+require_once 'Console/Getopt.php';
+
+$argv = Console_Getopt::readPHPArgv();
+$opts = Console_Getopt::getOpt($argv, 'f:c:s:t:a:b:');
+if (PEAR::isError($opts)) {
+    usage($opts->getMessage());
+}
+
+PEAR::setErrorHandling(PEAR_ERROR_DIE);
+$mime = &new Mail_Mime;
+foreach ($opts[0] as $opt) {
+    $param = $opt[1];
+    switch ($opt[0]) {
+        case 'f':
+            $headers['From'] = $param; break;
+        case 'c':
+            $headers['Cc'] = $param; break;
+        case 's':
+            $headers['Subject'] = $param; break;
+        case 't':
+            $to = $param; break;
+        case 'a':
+            $mime->addAttachment($param); break;
+        case 'b':
+            $isfile = @is_file($param) ? true : false;
+            $mime->setTXTBody($param, $isfile); break;
+    }
+}
+
+$mbody = $mime->get();
+$headers = $mime->headers($headers);
+$mail =& Mail::factory('mail');
+$mail->send($to, $headers, $mbody);
+
+function usage($error)
+{
+    die($error);
+}
+?>
\ No newline at end of file
diff --git a/apps/frontend/lib/mail/subida.jpg b/apps/frontend/lib/mail/subida.jpg
new file mode 100644
index 0000000..68b85ac
Binary files /dev/null and b/apps/frontend/lib/mail/subida.jpg differ
diff --git a/apps/frontend/lib/mail/subida.pdf b/apps/frontend/lib/mail/subida.pdf
new file mode 100755
index 0000000..b97e443
Binary files /dev/null and b/apps/frontend/lib/mail/subida.pdf differ
diff --git a/apps/frontend/lib/mail/subida.txt b/apps/frontend/lib/mail/subida.txt
new file mode 100755
index 0000000..facee5f
--- /dev/null
+++ b/apps/frontend/lib/mail/subida.txt
@@ -0,0 +1 @@
+hola!!
diff --git a/apps/frontend/lib/mail/subida.txt~ b/apps/frontend/lib/mail/subida.txt~
new file mode 100755
index 0000000..e69de29
diff --git a/apps/frontend/lib/mail/tests/class-filename.phpt b/apps/frontend/lib/mail/tests/class-filename.phpt
new file mode 100755
index 0000000..e383bf8
--- /dev/null
+++ b/apps/frontend/lib/mail/tests/class-filename.phpt
@@ -0,0 +1,13 @@
+--TEST--
+Test class filename (bug #24)
+--SKIPIF--
+<?php
+echo "skip This will be broken until Mail_Mime2";
+?>
+--FILE--
+<?php
+@include('Mail/Mime.php');
+echo class_exists('Mail_Mime') ? 'Include OK' : 'Include failed';
+?>
+--EXPECT--
+Include OK
diff --git a/apps/frontend/lib/mail/tests/encoding_case.phpt b/apps/frontend/lib/mail/tests/encoding_case.phpt
new file mode 100755
index 0000000..5f3b10d
--- /dev/null
+++ b/apps/frontend/lib/mail/tests/encoding_case.phpt
@@ -0,0 +1,14 @@
+--TEST--
+Bug #2364   Tabs in _quotedPrintableEncode()
+--SKIPIF--
+--FILE--
+<?php
+$test = "Here's\t\na tab\n";
+require_once('Mail/mimePart.php');
+$part = new Mail_mimePart();
+print $part->_quotedPrintableEncode($test, 7);
+?>
+--EXPECT--
+Here's=
+=09
+a tab
diff --git a/apps/frontend/lib/mail/tests/headers_with_mbstring.phpt b/apps/frontend/lib/mail/tests/headers_with_mbstring.phpt
new file mode 100755
index 0000000..2cc705e
--- /dev/null
+++ b/apps/frontend/lib/mail/tests/headers_with_mbstring.phpt
@@ -0,0 +1,148 @@
+--TEST--
+Multi-test for headers encoding using base64 and quoted-printable
+--SKIPIF--
+<?php
+if (!function_exists('mb_substr') || !function_exists('mb_strlen')) {
+    die "skip mbstring functions not found!";
+}
+?>
+--FILE--
+<?php
+include("Mail/mime.php");
+$mime = new Mail_mime();
+
+$headers = array(
+array('From', '<adresse@adresse.de>'),
+array('From', 'adresse@adresse.de'),
+array('From', 'Frank Do <adresse@adresse.de>'),
+array('To', 'Frank Do <adresse@adresse.de>, James Clark <james@domain.com>'),
+array('From', '"Frank Do" <adresse@adresse.de>'),
+array('Cc', '"Frank Do" <adresse@adresse.de>, "James Clark" <james@domain.com>'),
+array('Cc', ' <adresse@adresse.de>, "Kumiderski Jan Krzysztof Janusz Duga nazwa" <cris@domain.com>'),
+array('From', '"adresse@adresse.de" <addresse@adresse>'),
+array('From', 'adresse@adresse.de <addresse@adresse>'),
+array('From', '"German Umlauts " <adresse@adresse.de>'),
+array('Subject', 'German Umlauts  <adresse@adresse.de>'),
+array('Subject', 'Short ASCII subject'),
+array('Subject', 'Long ASCII subject - multiline space separated words - too long for one line'),
+array('Subject', 'Short Unicode  subject'),
+array('Subject', 'Long Unicode subject - za gl ja - too long for one line'),
+array('References', '<hglvja$jg7$1@nemesis.news.neostrada.pl>  <4b2e87ac$1@news.home.net.pl> <hgm5b1$3a7$1@atlantis.news.neostrada.pl>'),
+array('To', '"Frank Do" <adresse@adresse.de>,, "James Clark" <james@domain.com>'),
+array('To', '"Frank \\" \\\\Do" <adresse@adresse.de>'),
+array('To', 'Frank " \\Do <adresse@adresse.de>'),
+array('Subject', "A REALLY REALLY REALLY REALLY REALLY REALLY REALLY REALLY REALLY REALLY REALLY REALLY REALLY REALLY REALLY REALLY REALLY REALLY REALLY REALLY REALLY REALLY REALLY REALLY REALLY REALLY REALLY REALLY REALLY REALLY REALLY REALLY REALLY REALLY REALLY REALLY REALLY REALLY REALLY /REALLY/ LONG test"),
+array('Subject', "TEST Sper grse tolle gre von mir Sper grse tolle gre von mir Sper grse tolle gre von mir Sper grse tolle gre von mir Sper grse tolle gre von mir Sper grse tolle gre von mir Sper grse tolle gre von mir Sper grse tolle gre von mir Sper grse tolle gre von mir!!!?"),
+array('Subject', "Update: Microsoft Windows-Tool zum Entfernen bsartiger Software 3.6"),
+array('From', "test@nme <user@domain.com>"),
+array('From', "Test <\"test test\"@domain.com>"),
+array('From', "\"test test\"@domain.com"),
+array('From', "<\"test test\"@domain.com>"),
+array('From', "Doe<test@domain.com>"),
+array('From', "\"John Doe\"<test@domain.com>"),
+array('Mail-Reply-To', 'adresse@adresse.de <addresse@adresse>'),
+array('Mail-Reply-To', '"" <adresse@adresse.de>'),
+);
+
+$i = 1;
+foreach ($headers as $header) {
+    $hdr = $mime->encodeHeader($header[0], $header[1], 'UTF-8', 'base64');
+    printf("[%02d] %s: %s\n", $i, $header[0], $hdr);
+    $hdr = $mime->encodeHeader($header[0], $header[1], 'UTF-8', 'quoted-printable');
+    printf("[%02d] %s: %s\n", $i, $header[0], $hdr);
+    $i++;
+}
+?>
+--EXPECT--
+[01] From: <adresse@adresse.de>
+[01] From: <adresse@adresse.de>
+[02] From: adresse@adresse.de
+[02] From: adresse@adresse.de
+[03] From: Frank Do <adresse@adresse.de>
+[03] From: Frank Do <adresse@adresse.de>
+[04] To: Frank Do <adresse@adresse.de>, James Clark <james@domain.com>
+[04] To: Frank Do <adresse@adresse.de>, James Clark <james@domain.com>
+[05] From: "Frank Do" <adresse@adresse.de>
+[05] From: "Frank Do" <adresse@adresse.de>
+[06] Cc: "Frank Do" <adresse@adresse.de>, "James Clark" <james@domain.com>
+[06] Cc: "Frank Do" <adresse@adresse.de>, "James Clark" <james@domain.com>
+[07] Cc: <adresse@adresse.de>, =?UTF-8?B?S3XFm21pZGVyc2tpIEphbiBLcnp5c3p0b2Yg?=
+ =?UTF-8?B?SmFudXN6IETFgnVnYSBuYXp3YQ==?= <cris@domain.com>
+[07] Cc: <adresse@adresse.de>, =?UTF-8?Q?Ku=C5=9Bmiderski_Jan_Krzysztof_Janusz?=
+ =?UTF-8?Q?_D=C5=82uga_nazwa?= <cris@domain.com>
+[08] From: "adresse@adresse.de" <addresse@adresse>
+[08] From: "adresse@adresse.de" <addresse@adresse>
+[09] From: "adresse@adresse.de" <addresse@adresse>
+[09] From: "adresse@adresse.de" <addresse@adresse>
+[10] From: =?UTF-8?B?R2VybWFuIFVtbGF1dHMgw7bDpMO8?= <adresse@adresse.de>
+[10] From: =?UTF-8?Q?German_Umlauts_=C3=B6=C3=A4=C3=BC?= <adresse@adresse.de>
+[11] Subject: =?UTF-8?B?R2VybWFuIFVtbGF1dHMgw7bDpMO8IDxhZHJlc3NlQGFkcmVzc2Uu?=
+ =?UTF-8?B?ZGU+?=
+[11] Subject: =?UTF-8?Q?German_Umlauts_=C3=B6=C3=A4=C3=BC_=3Cadresse=40adresse?=
+ =?UTF-8?Q?=2Ede=3E?=
+[12] Subject: Short ASCII subject
+[12] Subject: Short ASCII subject
+[13] Subject: Long ASCII subject - multiline space separated words - too long for
+ one line
+[13] Subject: Long ASCII subject - multiline space separated words - too long for
+ one line
+[14] Subject: =?UTF-8?B?U2hvcnQgVW5pY29kZSDFvCBzdWJqZWN0?=
+[14] Subject: =?UTF-8?Q?Short_Unicode_=C5=BC_subject?=
+[15] Subject: =?UTF-8?B?TG9uZyBVbmljb2RlIHN1YmplY3QgLSB6YcW8w7PFgsSHIGfEmcWb?=
+ =?UTF-8?B?bMSFIGphxbrFhCAtIHRvbyBsb25nIGZvciBvbmUgbGluZQ==?=
+[15] Subject: =?UTF-8?Q?Long_Unicode_subject_-_za=C5=BC=C3=B3=C5=82=C4=87_g?=
+ =?UTF-8?Q?=C4=99=C5=9Bl=C4=85_ja=C5=BA=C5=84_-_too_long_for_one_line?=
+[16] References: <hglvja$jg7$1@nemesis.news.neostrada.pl>
+ <4b2e87ac$1@news.home.net.pl> <hgm5b1$3a7$1@atlantis.news.neostrada.pl>
+[16] References: <hglvja$jg7$1@nemesis.news.neostrada.pl>
+ <4b2e87ac$1@news.home.net.pl> <hgm5b1$3a7$1@atlantis.news.neostrada.pl>
+[17] To: "Frank Do" <adresse@adresse.de>, "James Clark" <james@domain.com>
+[17] To: "Frank Do" <adresse@adresse.de>, "James Clark" <james@domain.com>
+[18] To: "Frank \" \\Do" <adresse@adresse.de>
+[18] To: "Frank \" \\Do" <adresse@adresse.de>
+[19] To: "Frank \" \\Do" <adresse@adresse.de>
+[19] To: "Frank \" \\Do" <adresse@adresse.de>
+[20] Subject: A REALLY REALLY REALLY REALLY REALLY REALLY REALLY REALLY REALLY
+ REALLY REALLY REALLY REALLY REALLY REALLY REALLY REALLY REALLY REALLY REALLY
+ REALLY REALLY REALLY REALLY REALLY REALLY REALLY REALLY REALLY REALLY REALLY
+ REALLY REALLY REALLY REALLY REALLY REALLY REALLY REALLY /REALLY/ LONG test
+[20] Subject: A REALLY REALLY REALLY REALLY REALLY REALLY REALLY REALLY REALLY
+ REALLY REALLY REALLY REALLY REALLY REALLY REALLY REALLY REALLY REALLY REALLY
+ REALLY REALLY REALLY REALLY REALLY REALLY REALLY REALLY REALLY REALLY REALLY
+ REALLY REALLY REALLY REALLY REALLY REALLY REALLY REALLY /REALLY/ LONG test
+[21] Subject: =?UTF-8?B?VEVTVCBTw7xwZXIgZ3LDtnNlIHRvbGxlIGdyw7zDn2Ugdm9uIG1p?=
+ =?UTF-8?B?ciBTw7xwZXIgZ3LDtnNlIHRvbGxlIGdyw7zDn2Ugdm9uIG1pciBTw7xwZXIg?=
+ =?UTF-8?B?Z3LDtnNlIHRvbGxlIGdyw7zDn2Ugdm9uIG1pciBTw7xwZXIgZ3LDtnNlIHRv?=
+ =?UTF-8?B?bGxlIGdyw7zDn2Ugdm9uIG1pciBTw7xwZXIgZ3LDtnNlIHRvbGxlIGdyw7w=?=
+ =?UTF-8?B?w59lIHZvbiBtaXIgU8O8cGVyIGdyw7ZzZSB0b2xsZSBncsO8w59lIHZvbiBt?=
+ =?UTF-8?B?aXIgU8O8cGVyIGdyw7ZzZSB0b2xsZSBncsO8w59lIHZvbiBtaXIgU8O8cGVy?=
+ =?UTF-8?B?IGdyw7ZzZSB0b2xsZSBncsO8w59lIHZvbiBtaXIgU8O8cGVyIGdyw7ZzZSB0?=
+ =?UTF-8?B?b2xsZSBncsO8w59lIHZvbiBtaXIhISE/?=
+[21] Subject: =?UTF-8?Q?TEST_S=C3=BCper_gr=C3=B6se_tolle_gr=C3=BC=C3=9Fe_von_m?=
+ =?UTF-8?Q?ir_S=C3=BCper_gr=C3=B6se_tolle_gr=C3=BC=C3=9Fe_von_mir_S=C3=BCp?=
+ =?UTF-8?Q?er_gr=C3=B6se_tolle_gr=C3=BC=C3=9Fe_von_mir_S=C3=BCper_gr=C3=B6?=
+ =?UTF-8?Q?se_tolle_gr=C3=BC=C3=9Fe_von_mir_S=C3=BCper_gr=C3=B6se_tolle_gr?=
+ =?UTF-8?Q?=C3=BC=C3=9Fe_von_mir_S=C3=BCper_gr=C3=B6se_tolle_gr=C3=BC?=
+ =?UTF-8?Q?=C3=9Fe_von_mir_S=C3=BCper_gr=C3=B6se_tolle_gr=C3=BC=C3=9Fe_von?=
+ =?UTF-8?Q?_mir_S=C3=BCper_gr=C3=B6se_tolle_gr=C3=BC=C3=9Fe_von_mir_S?=
+ =?UTF-8?Q?=C3=BCper_gr=C3=B6se_tolle_gr=C3=BC=C3=9Fe_von_mir!!!=3F?=
+[22] Subject: =?UTF-8?B?VXBkYXRlOiBNaWNyb3NvZnQgV2luZG93cy1Ub29sIHp1bSBFbnRm?=
+ =?UTF-8?B?ZXJuZW4gYsO2c2FydGlnZXIgU29mdHdhcmUgMy42?=
+[22] Subject: =?UTF-8?Q?Update=3A_Microsoft_Windows-Tool_zum_Entfernen_b=C3=B6?=
+ =?UTF-8?Q?sartiger_Software_3=2E6?=
+[23] From: =?UTF-8?B?dGVzdEBuw6BtZQ==?= <user@domain.com>
+[23] From: =?UTF-8?Q?test=40n=C3=A0me?= <user@domain.com>
+[24] From: Test <"test test"@domain.com>
+[24] From: Test <"test test"@domain.com>
+[25] From: "test test"@domain.com
+[25] From: "test test"@domain.com
+[26] From: <"test test"@domain.com>
+[26] From: <"test test"@domain.com>
+[27] From: Doe <test@domain.com>
+[27] From: Doe <test@domain.com>
+[28] From: "John Doe" <test@domain.com>
+[28] From: "John Doe" <test@domain.com>
+[29] Mail-Reply-To: "adresse@adresse.de" <addresse@adresse>
+[29] Mail-Reply-To: "adresse@adresse.de" <addresse@adresse>
+[30] Mail-Reply-To: =?UTF-8?B?w7bDpMO8?= <adresse@adresse.de>
+[30] Mail-Reply-To: =?UTF-8?Q?=C3=B6=C3=A4=C3=BC?= <adresse@adresse.de>
diff --git a/apps/frontend/lib/mail/tests/headers_without_mbstring.phpt b/apps/frontend/lib/mail/tests/headers_without_mbstring.phpt
new file mode 100755
index 0000000..893847c
--- /dev/null
+++ b/apps/frontend/lib/mail/tests/headers_without_mbstring.phpt
@@ -0,0 +1,149 @@
+--TEST--
+Multi-test for headers encoding using base64 and quoted-printable
+--SKIPIF--
+<?php
+if (function_exists('mb_substr') && function_exists('mb_strlen')) {
+    die("skip mbstring functions found!");
+}
+?>
+--FILE--
+<?php
+include("Mail/mime.php");
+$mime = new Mail_mime();
+
+$headers = array(
+array('From', '<adresse@adresse.de>'),
+array('From', 'adresse@adresse.de'),
+array('From', 'Frank Do <adresse@adresse.de>'),
+array('To', 'Frank Do <adresse@adresse.de>, James Clark <james@domain.com>'),
+array('From', '"Frank Do" <adresse@adresse.de>'),
+array('Cc', '"Frank Do" <adresse@adresse.de>, "James Clark" <james@domain.com>'),
+array('Cc', ' <adresse@adresse.de>, "Kumiderski Jan Krzysztof Janusz Duga nazwa" <cris@domain.com>'),
+array('From', '"adresse@adresse.de" <addresse@adresse>'),
+array('From', 'adresse@adresse.de <addresse@adresse>'),
+array('From', '"German Umlauts " <adresse@adresse.de>'),
+array('Subject', 'German Umlauts  <adresse@adresse.de>'),
+array('Subject', 'Short ASCII subject'),
+array('Subject', 'Long ASCII subject - multiline space separated words - too long for one line'),
+array('Subject', 'Short Unicode  subject'),
+array('Subject', 'Long Unicode subject - za gl ja - too long for one line'),
+array('References', '<hglvja$jg7$1@nemesis.news.neostrada.pl>  <4b2e87ac$1@news.home.net.pl> <hgm5b1$3a7$1@atlantis.news.neostrada.pl>'),
+array('To', '"Frank Do" <adresse@adresse.de>,, "James Clark" <james@domain.com>'),
+array('To', '"Frank \\" \\\\Do" <adresse@adresse.de>'),
+array('To', 'Frank " \\Do <adresse@adresse.de>'),
+array('Subject', "A REALLY REALLY REALLY REALLY REALLY REALLY REALLY REALLY REALLY REALLY REALLY REALLY REALLY REALLY REALLY REALLY REALLY REALLY REALLY REALLY REALLY REALLY REALLY REALLY REALLY REALLY REALLY REALLY REALLY REALLY REALLY REALLY REALLY REALLY REALLY REALLY REALLY REALLY REALLY /REALLY/ LONG test"),
+array('Subject', "TEST Sper grse tolle gre von mir Sper grse tolle gre von mir Sper grse tolle gre von mir Sper grse tolle gre von mir Sper grse tolle gre von mir Sper grse tolle gre von mir Sper grse tolle gre von mir Sper grse tolle gre von mir Sper grse tolle gre von mir!!!?"),
+array('Subject', "Update: Microsoft Windows-Tool zum Entfernen bsartiger Software 3.6"),
+array('From', "test@nme <user@domain.com>"),
+array('From', "Test <\"test test\"@domain.com>"),
+array('From', "\"test test\"@domain.com"),
+array('From', "<\"test test\"@domain.com>"),
+array('From', "Doe<test@domain.com>"),
+array('From', "\"John Doe\"<test@domain.com>"),
+array('Mail-Reply-To', 'adresse@adresse.de <addresse@adresse>'),
+array('Mail-Reply-To', '"" <adresse@adresse.de>'),
+);
+
+$i = 1;
+foreach ($headers as $header) {
+    $hdr = $mime->encodeHeader($header[0], $header[1], 'UTF-8', 'base64');
+    printf("[%02d] %s: %s\n", $i, $header[0], $hdr);
+    $hdr = $mime->encodeHeader($header[0], $header[1], 'UTF-8', 'quoted-printable');
+    printf("[%02d] %s: %s\n", $i, $header[0], $hdr);
+    $i++;
+}
+?>
+--EXPECT--
+[01] From: <adresse@adresse.de>
+[01] From: <adresse@adresse.de>
+[02] From: adresse@adresse.de
+[02] From: adresse@adresse.de
+[03] From: Frank Do <adresse@adresse.de>
+[03] From: Frank Do <adresse@adresse.de>
+[04] To: Frank Do <adresse@adresse.de>, James Clark <james@domain.com>
+[04] To: Frank Do <adresse@adresse.de>, James Clark <james@domain.com>
+[05] From: "Frank Do" <adresse@adresse.de>
+[05] From: "Frank Do" <adresse@adresse.de>
+[06] Cc: "Frank Do" <adresse@adresse.de>, "James Clark" <james@domain.com>
+[06] Cc: "Frank Do" <adresse@adresse.de>, "James Clark" <james@domain.com>
+[07] Cc: <adresse@adresse.de>, =?UTF-8?B?S3XFm21pZGVyc2tpIEphbiBLcnp5c3p0b2Yg?=
+ =?UTF-8?B?SmFudXN6IETFgnVnYSBuYXp3YQ==?= <cris@domain.com>
+[07] Cc: <adresse@adresse.de>,
+ =?UTF-8?Q?Ku=C5=9Bmiderski_Jan_Krzysztof_Janusz_D?=
+ =?UTF-8?Q?=C5=82uga_nazwa?= <cris@domain.com>
+[08] From: "adresse@adresse.de" <addresse@adresse>
+[08] From: "adresse@adresse.de" <addresse@adresse>
+[09] From: "adresse@adresse.de" <addresse@adresse>
+[09] From: "adresse@adresse.de" <addresse@adresse>
+[10] From: =?UTF-8?B?R2VybWFuIFVtbGF1dHMgw7bDpMO8?= <adresse@adresse.de>
+[10] From: =?UTF-8?Q?German_Umlauts_=C3=B6=C3=A4=C3=BC?= <adresse@adresse.de>
+[11] Subject: =?UTF-8?B?R2VybWFuIFVtbGF1dHMgw7bDpMO8IDxhZHJlc3NlQGFkcmVzc2Uu?=
+ =?UTF-8?B?ZGU+?=
+[11] Subject: =?UTF-8?Q?German_Umlauts_=C3=B6=C3=A4=C3=BC_=3Cadresse=40adresse?=
+ =?UTF-8?Q?=2Ede=3E?=
+[12] Subject: Short ASCII subject
+[12] Subject: Short ASCII subject
+[13] Subject: Long ASCII subject - multiline space separated words - too long for
+ one line
+[13] Subject: Long ASCII subject - multiline space separated words - too long for
+ one line
+[14] Subject: =?UTF-8?B?U2hvcnQgVW5pY29kZSDFvCBzdWJqZWN0?=
+[14] Subject: =?UTF-8?Q?Short_Unicode_=C5=BC_subject?=
+[15] Subject: =?UTF-8?B?TG9uZyBVbmljb2RlIHN1YmplY3QgLSB6YcW8w7PFgsSHIGfEmcWb?=
+ =?UTF-8?B?bMSFIGphxbrFhCAtIHRvbyBsb25nIGZvciBvbmUgbGluZQ==?=
+[15] Subject: =?UTF-8?Q?Long_Unicode_subject_-_za=C5=BC=C3=B3=C5=82=C4=87_g=C4?=
+ =?UTF-8?Q?=99=C5=9Bl=C4=85_ja=C5=BA=C5=84_-_too_long_for_one_line?=
+[16] References: <hglvja$jg7$1@nemesis.news.neostrada.pl>
+ <4b2e87ac$1@news.home.net.pl> <hgm5b1$3a7$1@atlantis.news.neostrada.pl>
+[16] References: <hglvja$jg7$1@nemesis.news.neostrada.pl>
+ <4b2e87ac$1@news.home.net.pl> <hgm5b1$3a7$1@atlantis.news.neostrada.pl>
+[17] To: "Frank Do" <adresse@adresse.de>, "James Clark" <james@domain.com>
+[17] To: "Frank Do" <adresse@adresse.de>, "James Clark" <james@domain.com>
+[18] To: "Frank \" \\Do" <adresse@adresse.de>
+[18] To: "Frank \" \\Do" <adresse@adresse.de>
+[19] To: "Frank \" \\Do" <adresse@adresse.de>
+[19] To: "Frank \" \\Do" <adresse@adresse.de>
+[20] Subject: A REALLY REALLY REALLY REALLY REALLY REALLY REALLY REALLY REALLY
+ REALLY REALLY REALLY REALLY REALLY REALLY REALLY REALLY REALLY REALLY REALLY
+ REALLY REALLY REALLY REALLY REALLY REALLY REALLY REALLY REALLY REALLY REALLY
+ REALLY REALLY REALLY REALLY REALLY REALLY REALLY REALLY /REALLY/ LONG test
+[20] Subject: A REALLY REALLY REALLY REALLY REALLY REALLY REALLY REALLY REALLY
+ REALLY REALLY REALLY REALLY REALLY REALLY REALLY REALLY REALLY REALLY REALLY
+ REALLY REALLY REALLY REALLY REALLY REALLY REALLY REALLY REALLY REALLY REALLY
+ REALLY REALLY REALLY REALLY REALLY REALLY REALLY REALLY /REALLY/ LONG test
+[21] Subject: =?UTF-8?B?VEVTVCBTw7xwZXIgZ3LDtnNlIHRvbGxlIGdyw7zDn2Ugdm9uIG1p?=
+ =?UTF-8?B?ciBTw7xwZXIgZ3LDtnNlIHRvbGxlIGdyw7zDn2Ugdm9uIG1pciBTw7xwZXIg?=
+ =?UTF-8?B?Z3LDtnNlIHRvbGxlIGdyw7zDn2Ugdm9uIG1pciBTw7xwZXIgZ3LDtnNlIHRv?=
+ =?UTF-8?B?bGxlIGdyw7zDn2Ugdm9uIG1pciBTw7xwZXIgZ3LDtnNlIHRvbGxlIGdyw7zD?=
+ =?UTF-8?B?n2Ugdm9uIG1pciBTw7xwZXIgZ3LDtnNlIHRvbGxlIGdyw7zDn2Ugdm9uIG1p?=
+ =?UTF-8?B?ciBTw7xwZXIgZ3LDtnNlIHRvbGxlIGdyw7zDn2Ugdm9uIG1pciBTw7xwZXIg?=
+ =?UTF-8?B?Z3LDtnNlIHRvbGxlIGdyw7zDn2Ugdm9uIG1pciBTw7xwZXIgZ3LDtnNlIHRv?=
+ =?UTF-8?B?bGxlIGdyw7zDn2Ugdm9uIG1pciEhIT8=?=
+[21] Subject: =?UTF-8?Q?TEST_S=C3=BCper_gr=C3=B6se_tolle_gr=C3=BC=C3=9Fe_von_mir?=
+ =?UTF-8?Q?_S=C3=BCper_gr=C3=B6se_tolle_gr=C3=BC=C3=9Fe_von_mir_S=C3=BCper_g?=
+ =?UTF-8?Q?r=C3=B6se_tolle_gr=C3=BC=C3=9Fe_von_mir_S=C3=BCper_gr=C3=B6se_tol?=
+ =?UTF-8?Q?le_gr=C3=BC=C3=9Fe_von_mir_S=C3=BCper_gr=C3=B6se_tolle_gr=C3=BC?=
+ =?UTF-8?Q?=C3=9Fe_von_mir_S=C3=BCper_gr=C3=B6se_tolle_gr=C3=BC=C3=9Fe_von_m?=
+ =?UTF-8?Q?ir_S=C3=BCper_gr=C3=B6se_tolle_gr=C3=BC=C3=9Fe_von_mir_S=C3=BCper?=
+ =?UTF-8?Q?_gr=C3=B6se_tolle_gr=C3=BC=C3=9Fe_von_mir_S=C3=BCper_gr=C3=B6se_t?=
+ =?UTF-8?Q?olle_gr=C3=BC=C3=9Fe_von_mir!!!=3F?=
+[22] Subject: =?UTF-8?B?VXBkYXRlOiBNaWNyb3NvZnQgV2luZG93cy1Ub29sIHp1bSBFbnRm?=
+ =?UTF-8?B?ZXJuZW4gYsO2c2FydGlnZXIgU29mdHdhcmUgMy42?=
+[22] Subject: =?UTF-8?Q?Update=3A_Microsoft_Windows-Tool_zum_Entfernen_b=C3=B6sa?=
+ =?UTF-8?Q?rtiger_Software_3=2E6?=
+[23] From: =?UTF-8?B?dGVzdEBuw6BtZQ==?= <user@domain.com>
+[23] From: =?UTF-8?Q?test=40n=C3=A0me?= <user@domain.com>
+[24] From: Test <"test test"@domain.com>
+[24] From: Test <"test test"@domain.com>
+[25] From: "test test"@domain.com
+[25] From: "test test"@domain.com
+[26] From: <"test test"@domain.com>
+[26] From: <"test test"@domain.com>
+[27] From: Doe <test@domain.com>
+[27] From: Doe <test@domain.com>
+[28] From: "John Doe" <test@domain.com>
+[28] From: "John Doe" <test@domain.com>
+[29] Mail-Reply-To: "adresse@adresse.de" <addresse@adresse>
+[29] Mail-Reply-To: "adresse@adresse.de" <addresse@adresse>
+[30] Mail-Reply-To: =?UTF-8?B?w7bDpMO8?= <adresse@adresse.de>
+[30] Mail-Reply-To: =?UTF-8?Q?=C3=B6=C3=A4=C3=BC?= <adresse@adresse.de>
diff --git a/apps/frontend/lib/mail/tests/sleep_wakeup_EOL-bug3488-part1.phpt b/apps/frontend/lib/mail/tests/sleep_wakeup_EOL-bug3488-part1.phpt
new file mode 100755
index 0000000..6405cc0
--- /dev/null
+++ b/apps/frontend/lib/mail/tests/sleep_wakeup_EOL-bug3488-part1.phpt
@@ -0,0 +1,28 @@
+--TEST--
+Bug #3488   Sleep/Wakeup EOL Consistency - Part 1
+--SKIPIF--
+--FILE--
+<?php
+require_once('Mail/mime.php');
+$mm = new Mail_mime("\n");
+$mm->setHTMLBody('<html></html>');
+$mm->setTxtBody('Blah blah');
+
+if (version_compare(phpversion(), "5.0.0", '<')) {
+    $mmCopy = $mm;
+} else {
+    $mmCopy = clone($mm);
+}
+
+$mm->get();
+$x = $mm->headers();
+
+$smm = serialize(array('mm' => $mmCopy, 'header' => $x['Content-Type']));
+$fp = fopen('sleep_wakeup_data', 'w');
+fwrite($fp, $smm);
+fclose($fp);
+
+echo "Data written";
+?>
+--EXPECT--
+Data written
diff --git a/apps/frontend/lib/mail/tests/sleep_wakeup_EOL-bug3488-part2.phpt b/apps/frontend/lib/mail/tests/sleep_wakeup_EOL-bug3488-part2.phpt
new file mode 100755
index 0000000..74a8759
--- /dev/null
+++ b/apps/frontend/lib/mail/tests/sleep_wakeup_EOL-bug3488-part2.phpt
@@ -0,0 +1,27 @@
+--TEST--
+Bug #3488   Sleep/Wakeup EOL Consistency - Part 2
+--SKIPIF--
+if (!is_readable('sleep_wakeup_data')) {
+    echo "skip No data. Part 1 must run first.\n";
+}
+--FILE--
+<?php
+require_once('Mail/mime.php');
+$filename = 'sleep_wakeup_data';
+$fp = fopen($filename, 'r');
+$smm = fread($fp, filesize($filename));
+fclose($fp);
+@unlink($filename);
+
+$mmData = unserialize($smm);
+$mmData['mm']->get();
+$x = $mmData['mm']->headers();
+
+list($h1) = explode("\n", $mmData['header']);
+list($h2) = explode("\n", $x['Content-Type']);
+
+echo ($h1 == $h2) ? "Match" : "No Match";
+
+?>
+--EXPECT--
+Match
diff --git a/apps/frontend/lib/mail/tests/test_Bug_10596_1.phpt b/apps/frontend/lib/mail/tests/test_Bug_10596_1.phpt
new file mode 100755
index 0000000..769880a
--- /dev/null
+++ b/apps/frontend/lib/mail/tests/test_Bug_10596_1.phpt
@@ -0,0 +1,17 @@
+--TEST--
+Bug #10596  Incorrect handling of text and html '0' bodies
+--SKIPIF--
+--FILE--
+<?php
+include("Mail/mime.php");
+$mime = new Mail_mime();
+$mime->setTxtBody('0');
+$mime->setHTMLBody('0');
+$body = $mime->get();
+if ($body){
+    print("OK");
+}else{
+    print("NO BODY FOUND");
+}
+--EXPECT--
+OK
diff --git a/apps/frontend/lib/mail/tests/test_Bug_10816_1.phpt b/apps/frontend/lib/mail/tests/test_Bug_10816_1.phpt
new file mode 100755
index 0000000..022049c
--- /dev/null
+++ b/apps/frontend/lib/mail/tests/test_Bug_10816_1.phpt
@@ -0,0 +1,23 @@
+--TEST--
+Bug #10816  Unwanted linebreak at the end of output
+--SKIPIF--
+--FILE--
+<?php
+$eol = "#";
+include("Mail/mime.php");
+$encoder = new Mail_mime(array('eol'=>$eol));
+$encoder->setTXTBody('test');
+$encoder->setHTMLBody('<b>test</b>');
+$encoder->addAttachment('Just a test', 'application/octet-stream', 'test.txt', false);
+$body = $encoder->get();
+$taillength = -1 * strlen($eol) * 2;
+if (substr($body, $taillength) == ($eol.$eol)){
+    print("FAILED\n");
+    print("Body:\n");
+    print("..." . substr($body, -10) . "\n");
+}else{
+    print("OK\n");
+}
+--EXPECT--
+OK
+
diff --git a/apps/frontend/lib/mail/tests/test_Bug_11731.phpt b/apps/frontend/lib/mail/tests/test_Bug_11731.phpt
new file mode 100755
index 0000000..5a3d42e
--- /dev/null
+++ b/apps/frontend/lib/mail/tests/test_Bug_11731.phpt
@@ -0,0 +1,20 @@
+--TEST--
+Bug #11731  Full stops after soft line breaks are not encoded
+--SKIPIF--
+--FILE--
+<?php
+include("Mail/mime.php");
+// Second full stop will be at the start of the second line after quoted-printable
+// encoding (full stop '=2E' + 72 characters + line-continuation '=' = 76)
+$text     = '.123456789012345678901234567890123456789012345678901234567890123456789012.3456';
+$params   = Array(
+    'content_type' => 'text/plain',
+    'encoding'     => 'quoted-printable',
+);    
+$mimePart =& new Mail_mimePart($text, $params);
+$encoded  =  $mimePart->encode();
+echo $encoded['body'];
+    
+--EXPECT--
+=2E123456789012345678901234567890123456789012345678901234567890123456789012=
+=2E3456
diff --git a/apps/frontend/lib/mail/tests/test_Bug_12411.phpt b/apps/frontend/lib/mail/tests/test_Bug_12411.phpt
new file mode 100755
index 0000000..804afdd
--- /dev/null
+++ b/apps/frontend/lib/mail/tests/test_Bug_12411.phpt
@@ -0,0 +1,27 @@
+--TEST--
+Bug #12411  RFC2047 encoded attachment filenames
+--SKIPIF--
+--FILE--
+<?php
+include "Mail/mime.php";
+$m = new Mail_mime();
+
+// some text with polish Unicode letter at the beginning
+$filename = base64_decode("xZtjaWVtYQ==");
+$m->addAttachment('testfile', "text/plain", $filename, FALSE,
+    'base64', 'attachment', 'ISO-8859-1', 'pl', '',
+    'quoted-printable', 'base64');
+
+$root = $m->_addMixedPart();
+$enc = $m->_addAttachmentPart($root, $m->_parts[0]);
+
+echo $enc->_headers['Content-Type'];
+echo "\n";
+echo $enc->_headers['Content-Disposition'];
+?>
+--EXPECT--
+text/plain; charset=ISO-8859-1;
+ name="=?ISO-8859-1?Q?=C5=9Bciema?="
+attachment;
+ filename="=?ISO-8859-1?B?xZtjaWVtYQ==?=";
+ size=8
diff --git a/apps/frontend/lib/mail/tests/test_Bug_13444.phpt b/apps/frontend/lib/mail/tests/test_Bug_13444.phpt
new file mode 100755
index 0000000..a962aa3
--- /dev/null
+++ b/apps/frontend/lib/mail/tests/test_Bug_13444.phpt
@@ -0,0 +1,30 @@
+--TEST--
+Bug #9725   multipart/related & alternative wrong order
+--SKIPIF--
+--FILE--
+<?php
+include("Mail/mime.php");
+
+$mime = new Mail_mime();
+$mime->setTXTBody("test");
+$mime->setHTMLBody("test");
+$mime->addHTMLImage("test", 'application/octet-stream', '', false);
+$body = $mime->get();
+$head = $mime->headers();
+$headCT = $head['Content-Type'];
+$headCT = explode(";", $headCT);
+$headCT = $headCT[0];
+
+$ct = preg_match_all('|Content-Type: ([^;\r\n]+)|', $body, $matches);
+print($headCT);
+print("\n");
+foreach ($matches[1] as $match){
+    print($match);
+    print("\n");
+}
+--EXPECT--
+multipart/alternative
+text/plain
+multipart/related
+text/html
+application/octet-stream
diff --git a/apps/frontend/lib/mail/tests/test_Bug_13962.phpt b/apps/frontend/lib/mail/tests/test_Bug_13962.phpt
new file mode 100755
index 0000000..9f73283
--- /dev/null
+++ b/apps/frontend/lib/mail/tests/test_Bug_13962.phpt
@@ -0,0 +1,19 @@
+--TEST--
+Bug #13962  Multiple header support
+--SKIPIF--
+--FILE--
+<?php
+require_once('Mail/mime.php');
+
+$mime = new Mail_mime();
+
+$mime->setFrom('user@from.example.com');
+$r = $mime->txtHeaders(array('Received' => array('Received 1', 'Received 2')));
+
+print_r($r); 
+?>
+--EXPECT--
+Received: Received 1
+Received: Received 2
+MIME-Version: 1.0
+From: user@from.example.com
diff --git a/apps/frontend/lib/mail/tests/test_Bug_14529.phpt b/apps/frontend/lib/mail/tests/test_Bug_14529.phpt
new file mode 100755
index 0000000..063eb56
--- /dev/null
+++ b/apps/frontend/lib/mail/tests/test_Bug_14529.phpt
@@ -0,0 +1,18 @@
+--TEST--
+Bug #14529  basename() workaround
+--SKIPIF--
+--FILE--
+<?php
+include "Mail/mime.php";
+$m = new Mail_mime();
+// some text with polish Unicode letter at the beginning
+$filename = base64_decode("xZtjaWVtYQ==");
+$m->addAttachment('testfile', "text/plain", $filename, FALSE, 'base64', 'attachment', 'ISO-8859-1');
+$root = $m->_addMixedPart();
+$enc = $m->_addAttachmentPart($root, $m->_parts[0]);
+print_r($enc->_headers['Content-Disposition']);
+?>
+--EXPECT--
+attachment;
+ filename*=ISO-8859-1''%C5%9Bciema;
+ size=8
diff --git a/apps/frontend/lib/mail/tests/test_Bug_14779.phpt b/apps/frontend/lib/mail/tests/test_Bug_14779.phpt
new file mode 100755
index 0000000..90972eb
--- /dev/null
+++ b/apps/frontend/lib/mail/tests/test_Bug_14779.phpt
@@ -0,0 +1,25 @@
+--TEST--
+Bug #14779  Proper header-body separator for empty attachment
+--SKIPIF--
+--FILE--
+<?php
+include "Mail/mime.php";
+
+$m = new Mail_mime();
+$m->addAttachment('', "text/plain", 'file.txt', FALSE, 'base64', 'attachment');
+$result = $m->get();
+
+if (preg_match('/(Content.*)--=.*/s', $result, $matches)) {
+    print_r($matches[1]."END");
+}
+
+?>
+--EXPECT--
+Content-Transfer-Encoding: base64
+Content-Type: text/plain;
+ name=file.txt
+Content-Disposition: attachment;
+ filename=file.txt
+
+
+END
diff --git a/apps/frontend/lib/mail/tests/test_Bug_14780.phpt b/apps/frontend/lib/mail/tests/test_Bug_14780.phpt
new file mode 100755
index 0000000..da28a4a
--- /dev/null
+++ b/apps/frontend/lib/mail/tests/test_Bug_14780.phpt
@@ -0,0 +1,22 @@
+--TEST--
+Bug #14780  Invalid Content-Type when headers() is called before get()
+--SKIPIF--
+--FILE--
+<?php
+include("Mail/mime.php");
+
+$mime = new Mail_mime();
+$mime->setTXTBody("test");
+$mime->setHTMLBody("test");
+
+$head1 = $mime->headers();
+$body = $mime->get();
+$head2 = $mime->headers();
+
+if ($head1 === $head2) {
+    echo "OK";
+}
+
+?>
+--EXPECT--
+OK
diff --git a/apps/frontend/lib/mail/tests/test_Bug_15320.phpt b/apps/frontend/lib/mail/tests/test_Bug_15320.phpt
new file mode 100755
index 0000000..a33ca68
--- /dev/null
+++ b/apps/frontend/lib/mail/tests/test_Bug_15320.phpt
@@ -0,0 +1,16 @@
+--TEST--
+Bug #15320  Charset parameter in Content-Type of mail parts
+--SKIPIF--
+--FILE--
+<?php
+include "Mail/mime.php";
+$m = new Mail_mime();
+$m->addAttachment('testfile', "text/plain", 'file.txt', FALSE, 'base64', 'attachment', 'ISO-8859-1');
+$root = $m->_addMixedPart();
+$enc = $m->_addAttachmentPart($root, $m->_parts[0]);
+print_r($enc->_headers['Content-Type']);
+?>
+--EXPECT--
+text/plain; charset=ISO-8859-1;
+ name=file.txt
+
diff --git a/apps/frontend/lib/mail/tests/test_Bug_17025.phpt b/apps/frontend/lib/mail/tests/test_Bug_17025.phpt
new file mode 100755
index 0000000..c65ef3a
--- /dev/null
+++ b/apps/frontend/lib/mail/tests/test_Bug_17025.phpt
@@ -0,0 +1,15 @@
+--TEST--
+Bug #16539  Headers longer than 998 characters
+--SKIPIF--
+--FILE--
+<?php
+include("Mail/mime.php");
+
+$headers['From'] = 'aaaaaaaaaabbbbbbbbbbccccccccccddddddddddeeeeeeeeeeffffffffffgggggggggghhhhhhhhhh';
+# over than 76 chars
+$mime = new Mail_mime();
+$hdrs = $mime->headers($headers);
+print_r($hdrs['From']); 
+?>
+--EXPECT--
+aaaaaaaaaabbbbbbbbbbccccccccccddddddddddeeeeeeeeeeffffffffffgggggggggghhhhhhhhhh
diff --git a/apps/frontend/lib/mail/tests/test_Bug_17175.phpt b/apps/frontend/lib/mail/tests/test_Bug_17175.phpt
new file mode 100755
index 0000000..eb57f91
--- /dev/null
+++ b/apps/frontend/lib/mail/tests/test_Bug_17175.phpt
@@ -0,0 +1,24 @@
+--TEST--
+Bug #17175  Content-Description support+ecoding
+--SKIPIF--
+--FILE--
+<?php
+require_once('Mail/mime.php');
+
+$Mime = new Mail_Mime();
+$Mime->setTXTBody('Test message.');
+$Mime->addAttachment('test file contents', "text/plain",
+    'test.txt', FALSE, 'base64', NULL, 'UTF-8', NULL, NULL, NULL, NULL,
+    'desc');
+$Mime->addAttachment('test file contents', "text/plain",
+    'test2.txt', FALSE, 'base64', NULL, 'UTF-8', NULL, NULL, NULL, NULL,
+    'test unicode ');
+
+$body = $Mime->getMessage();
+preg_match_all('/Content-Description: (.*)/', $body, $matches);
+foreach ($matches[1] as $value)
+    echo $value."\n";
+?>
+--EXPECT--
+desc
+=?UTF-8?Q?test_unicode_=C5=BC=C4=85=C5=9B=C5=BA?=
diff --git a/apps/frontend/lib/mail/tests/test_Bug_18083.phpt b/apps/frontend/lib/mail/tests/test_Bug_18083.phpt
new file mode 100755
index 0000000..ecb7fe6
--- /dev/null
+++ b/apps/frontend/lib/mail/tests/test_Bug_18083.phpt
@@ -0,0 +1,26 @@
+--TEST--
+Bug #18083  Separate charset for attachment's content and headers
+--SKIPIF--
+--FILE--
+<?php
+include "Mail/mime.php";
+$m = new Mail_mime();
+
+$m->addAttachment('testfile', "text/plain",
+    base64_decode("xZtjaWVtYQ=="), FALSE,
+    'base64', 'attachment', 'ISO-8859-1', 'pl', '',
+    'quoted-printable', 'base64', '', 'UTF-8');
+
+$root = $m->_addMixedPart();
+$enc = $m->_addAttachmentPart($root, $m->_parts[0]);
+
+echo $enc->_headers['Content-Type'];
+echo "\n";
+echo $enc->_headers['Content-Disposition'];
+?>
+--EXPECT--
+text/plain; charset=ISO-8859-1;
+ name="=?UTF-8?Q?=C5=9Bciema?="
+attachment;
+ filename="=?UTF-8?B?xZtjaWVtYQ==?=";
+ size=8
diff --git a/apps/frontend/lib/mail/tests/test_Bug_3513_1.phpt b/apps/frontend/lib/mail/tests/test_Bug_3513_1.phpt
new file mode 100755
index 0000000..5183ada
--- /dev/null
+++ b/apps/frontend/lib/mail/tests/test_Bug_3513_1.phpt
@@ -0,0 +1,16 @@
+--TEST--
+Bug #3513   Support of RFC2231 in header fields. (ISO-8859-1)
+--SKIPIF--
+--FILE--
+<?php
+$test = "Fbr.txt";
+require_once('Mail/mime.php');
+$Mime=new Mail_Mime();
+$Mime->addAttachment('testfile',"text/plain", $test, FALSE, 'base64', 'attachment', 'ISO-8859-1');
+$root = $Mime->_addMixedPart();
+$enc = $Mime->_addAttachmentPart($root, $Mime->_parts[0]);
+print($enc->_headers['Content-Disposition']);
+--EXPECT--
+attachment;
+ filename*=ISO-8859-1''F%F3%F3b%E6r.txt;
+ size=8
diff --git a/apps/frontend/lib/mail/tests/test_Bug_3513_2.phpt b/apps/frontend/lib/mail/tests/test_Bug_3513_2.phpt
new file mode 100755
index 0000000..d301b9b
--- /dev/null
+++ b/apps/frontend/lib/mail/tests/test_Bug_3513_2.phpt
@@ -0,0 +1,17 @@
+--TEST--
+Bug #3513   Support of RFC2231 in header fields. (UTF-8)
+--SKIPIF--
+--FILE--
+<?php
+$test = "Sper grse tolle tolle gre.txt";
+require_once('Mail/mime.php');
+$Mime=new Mail_Mime();
+$Mime->addAttachment('testfile',"text/plain", $test, FALSE, 'base64', 'attachment', 'UTF-8', 'de');
+$root = $Mime->_addMixedPart();
+$enc = $Mime->_addAttachmentPart($root, $Mime->_parts[0]);
+print($enc->_headers['Content-Disposition']);
+--EXPECT--
+attachment;
+ filename*0*=UTF-8'de'S%C3%BCper%20gr%C3%B6se%20tolle%20tolle%20gr%C3%BC;
+ filename*1*=%C3%9Fe.txt;
+ size=8
diff --git a/apps/frontend/lib/mail/tests/test_Bug_3513_3.phpt b/apps/frontend/lib/mail/tests/test_Bug_3513_3.phpt
new file mode 100755
index 0000000..0eee306
--- /dev/null
+++ b/apps/frontend/lib/mail/tests/test_Bug_3513_3.phpt
@@ -0,0 +1,20 @@
+--TEST--
+Bug #3513   Support of RFC2231 in header fields. (ISO-2022-JP)
+--SKIPIF--
+--FILE--
+<?php
+mb_internal_encoding('ISO-2022-JP');
+$testEncoded="GyRCRnxLXDhsGyhCLnR4dA==";
+$test = base64_decode($testEncoded); // Japanese filename in ISO-2022-JP charset.
+require_once('Mail/mime.php');
+$Mime=new Mail_Mime();
+$Mime->addAttachment('testfile',"text/plain", $test, FALSE, 'base64', 'attachment', 'iso-2022-jp', '');
+$root = $Mime->_addMixedPart();
+$enc = $Mime->_addAttachmentPart($root, $Mime->_parts[0]);
+print($enc->_headers['Content-Disposition']);
+?>
+--EXPECT--
+attachment;
+ filename*=iso-2022-jp''%1B$BF|K%5C8l%1B%28B.txt;
+ size=8
+
diff --git a/apps/frontend/lib/mail/tests/test_Bug_7561_1.phpt b/apps/frontend/lib/mail/tests/test_Bug_7561_1.phpt
new file mode 100755
index 0000000..170017c
--- /dev/null
+++ b/apps/frontend/lib/mail/tests/test_Bug_7561_1.phpt
@@ -0,0 +1,26 @@
+--TEST--
+Bug #7561   Mail_mimePart::_quotedPrintableEncode() misbehavior with mbstring overload
+--SKIPIF--
+<?php
+include "PEAR.php";
+if (!extension_loaded('mbstring')){
+    if (!PEAR::loadExtension('mbstring')){
+        print('SKIP could not load mbstring module');
+    }
+}
+--FILE--
+<?php
+ini_set('mbstring.language',            'Neutral');
+// this isn't working because this option has PHP_INI_SYSTEM mode
+ini_set('mbstring.func_overload',       6);
+ini_set('mbstring.internal_encoding',   'UTF-8');
+ini_set('mbstring.http_output',         'UTF-8');
+
+include("Mail/mimePart.php");
+$part = new Mail_mimePart('', array('eol'=>"\n"));
+// string is UTF-8 encoded
+$input = "Micha\xC3\xABl \xC3\x89ric St\xC3\xA9phane";
+$rv = $part->_quotedPrintableEncode($input);
+echo $rv, "\n";
+--EXPECT--
+Micha=C3=ABl =C3=89ric St=C3=A9phane
diff --git a/apps/frontend/lib/mail/tests/test_Bug_8386_1.phpt b/apps/frontend/lib/mail/tests/test_Bug_8386_1.phpt
new file mode 100755
index 0000000..e317375
--- /dev/null
+++ b/apps/frontend/lib/mail/tests/test_Bug_8386_1.phpt
@@ -0,0 +1,22 @@
+--TEST--
+Bug #8386   HTML body not correctly encoded if attachments present
+--SKIPIF--
+--FILE--
+<?php
+$eol = "\n#";
+include("Mail/mime.php");
+$encoder = new Mail_mime(array('eol'=>$eol));
+$encoder->setTXTBody('test');
+$encoder->setHTMLBody('<b>test</b>');
+$encoder->addAttachment('Just a test', 'application/octet-stream', 'test.txt', false);
+$body = $encoder->get();
+if (strpos($body, '--' . $eol . '--=')){
+    print("FAILED\n");
+    print("Single delimiter() between 2 parts found.\n");
+    print($body);
+}else{
+    print("OK");
+}
+?>
+--EXPECT--
+OK
diff --git a/apps/frontend/lib/mail/tests/test_Bug_8541_1.phpt b/apps/frontend/lib/mail/tests/test_Bug_8541_1.phpt
new file mode 100755
index 0000000..74213b4
--- /dev/null
+++ b/apps/frontend/lib/mail/tests/test_Bug_8541_1.phpt
@@ -0,0 +1,19 @@
+--TEST--
+Bug #8541   mimePart.php line delimiter is \r
+--SKIPIF--
+--FILE--
+<?php
+$mime = file_get_contents('Mail/mime.php', 1);
+$mimePart = file_get_contents('Mail/mimePart.php', 1);
+if (strpos($mime, "\r")){
+    print("\\r found in mime.php\n");
+}elseif (strpos($mime, "\t")){
+    print("\\t found in mime.php\n");
+}elseif (strpos($mimePart, "\r")){
+    print("\\r found in mimePart.php\n");
+}elseif (strpos($mimePart, "\t")){
+    print("\\t found in mimePart.php\n");
+}
+print('OK');
+--EXPECT--
+OK
diff --git a/apps/frontend/lib/mail/tests/test_Bug_9558_1.phpt b/apps/frontend/lib/mail/tests/test_Bug_9558_1.phpt
new file mode 100755
index 0000000..a15d3cc
--- /dev/null
+++ b/apps/frontend/lib/mail/tests/test_Bug_9558_1.phpt
@@ -0,0 +1,21 @@
+--TEST--
+Bug #9558   Broken multiline headers
+--SKIPIF--
+--FILE--
+<?php
+include("Mail/mime.php");
+
+$encoder = new Mail_mime();
+$input[] = "received by me
+    at some point
+    from some server";
+
+$encoded = $encoder->_encodeHeaders($input, array('head_encoding' => 'quoted-printable'));
+print_r($encoded);
+--EXPECT--
+Array
+(
+    [0] => received by me
+    at some point
+    from some server
+)
diff --git a/apps/frontend/lib/mail/tests/test_Bug_9722_1.phpt b/apps/frontend/lib/mail/tests/test_Bug_9722_1.phpt
new file mode 100755
index 0000000..479b643
--- /dev/null
+++ b/apps/frontend/lib/mail/tests/test_Bug_9722_1.phpt
@@ -0,0 +1,25 @@
+--TEST--
+Bug #9722   _quotedPrintableEncode does not encode dot at start of line on Windows platform
+--SKIPIF--
+--FILE--
+<?php
+include("Mail/mimePart.php");
+$part = new Mail_mimePart('', array('eol'=>"\n"));
+$text = "This
+is a
+test
+...
+    It is 
+//really fun//
+to make :(";
+
+print_r($part->_quotedPrintableEncode($text));
+
+--EXPECT--
+This
+is a
+test
+=2E..
+    It is=20
+//really fun//
+to make :(
diff --git a/apps/frontend/lib/mpdf53/ttfontdata/dejavusanscondensed.cw.dat b/apps/frontend/lib/mpdf53/ttfontdata/dejavusanscondensed.cw.dat
new file mode 100755
index 0000000..a748b9a
Binary files /dev/null and b/apps/frontend/lib/mpdf53/ttfontdata/dejavusanscondensed.cw.dat differ
diff --git a/apps/frontend/lib/mpdf53/ttfontdata/dejavusanscondensed.cw127.php b/apps/frontend/lib/mpdf53/ttfontdata/dejavusanscondensed.cw127.php
new file mode 100755
index 0000000..85a2fa0
--- /dev/null
+++ b/apps/frontend/lib/mpdf53/ttfontdata/dejavusanscondensed.cw127.php
@@ -0,0 +1,163 @@
+<?php
+$rangeid=122;
+$prevcid=126;
+$prevwidth=754;
+$interval=false;
+$range=array (
+  32 => 
+  array (
+    0 => 286,
+    1 => 360,
+    2 => 414,
+    3 => 754,
+    4 => 572,
+    5 => 855,
+    6 => 702,
+    7 => 247,
+  ),
+  40 => 
+  array (
+    0 => 351,
+    1 => 351,
+    'interval' => true,
+  ),
+  42 => 
+  array (
+    0 => 450,
+    1 => 754,
+    2 => 286,
+    3 => 325,
+    4 => 286,
+    5 => 303,
+  ),
+  48 => 
+  array (
+    0 => 572,
+    1 => 572,
+    'interval' => true,
+    2 => 572,
+    3 => 572,
+    4 => 572,
+    5 => 572,
+    6 => 572,
+    7 => 572,
+    8 => 572,
+    9 => 572,
+  ),
+  58 => 
+  array (
+    0 => 303,
+    1 => 303,
+    'interval' => true,
+  ),
+  60 => 
+  array (
+    0 => 754,
+    1 => 754,
+    'interval' => true,
+    2 => 754,
+  ),
+  63 => 
+  array (
+    0 => 478,
+    1 => 900,
+    2 => 615,
+    3 => 617,
+    4 => 628,
+    5 => 693,
+    6 => 568,
+    7 => 518,
+    8 => 697,
+    9 => 677,
+  ),
+  73 => 
+  array (
+    0 => 265,
+    1 => 265,
+    'interval' => true,
+  ),
+  75 => 
+  array (
+    0 => 590,
+    1 => 501,
+    2 => 776,
+    3 => 673,
+    4 => 708,
+    5 => 542,
+    6 => 708,
+    7 => 625,
+    8 => 571,
+    9 => 549,
+    10 => 659,
+    11 => 615,
+    12 => 890,
+    13 => 616,
+    14 => 549,
+    15 => 616,
+    16 => 351,
+    17 => 303,
+    18 => 351,
+    19 => 754,
+  ),
+  95 => 
+  array (
+    0 => 450,
+    1 => 450,
+    'interval' => true,
+  ),
+  97 => 
+  array (
+    0 => 551,
+    1 => 571,
+    2 => 495,
+    3 => 571,
+    4 => 554,
+    5 => 316,
+    6 => 571,
+    7 => 570,
+  ),
+  105 => 
+  array (
+    0 => 250,
+    1 => 250,
+    'interval' => true,
+  ),
+  107 => 
+  array (
+    0 => 521,
+    1 => 250,
+    2 => 876,
+    3 => 570,
+    4 => 550,
+  ),
+  112 => 
+  array (
+    0 => 571,
+    1 => 571,
+    'interval' => true,
+  ),
+  114 => 
+  array (
+    0 => 370,
+    1 => 469,
+    2 => 353,
+    3 => 570,
+    4 => 532,
+    5 => 736,
+  ),
+  120 => 
+  array (
+    0 => 532,
+    1 => 532,
+    'interval' => true,
+  ),
+  122 => 
+  array (
+    0 => 472,
+    1 => 572,
+    2 => 303,
+    3 => 572,
+    4 => 754,
+  ),
+);
+?>
\ No newline at end of file
diff --git a/apps/frontend/lib/mpdf53/ttfontdata/dejavusanscondensed.mtx.php b/apps/frontend/lib/mpdf53/ttfontdata/dejavusanscondensed.mtx.php
new file mode 100755
index 0000000..4232904
--- /dev/null
+++ b/apps/frontend/lib/mpdf53/ttfontdata/dejavusanscondensed.mtx.php
@@ -0,0 +1,25 @@
+<?php
+$name='DejaVuSansCondensed';
+$type='TTF';
+$desc=array (
+  'Ascent' => 928,
+  'Descent' => -236,
+  'CapHeight' => 928,
+  'Flags' => 4,
+  'FontBBox' => '[-918 -415 1513 1167]',
+  'ItalicAngle' => 0,
+  'StemV' => 87,
+  'MissingWidth' => 540,
+);
+$up=-63;
+$ut=44;
+$ttffile='/opt/lampp/htdocs/frontend/apps/frontend/lib/mpdf53/ttfonts/DejaVuSansCondensed.ttf';
+$TTCfontID='0';
+$originalsize=555944;
+$sip=false;
+$smp=false;
+$BMPselected=true;
+$fontkey='dejavusanscondensed';
+$panose='0 0 2 11 6 6 3 8 4 2 2 4';
+$haskerninfo=false;
+?>
\ No newline at end of file
diff --git a/apps/frontend/lib/mpdf53/ttfontdata/dejavusanscondensedB.cw.dat b/apps/frontend/lib/mpdf53/ttfontdata/dejavusanscondensedB.cw.dat
new file mode 100755
index 0000000..a24fd29
Binary files /dev/null and b/apps/frontend/lib/mpdf53/ttfontdata/dejavusanscondensedB.cw.dat differ
diff --git a/apps/frontend/lib/mpdf53/ttfontdata/dejavusanscondensedB.cw127.php b/apps/frontend/lib/mpdf53/ttfontdata/dejavusanscondensedB.cw127.php
new file mode 100755
index 0000000..d9e4103
--- /dev/null
+++ b/apps/frontend/lib/mpdf53/ttfontdata/dejavusanscondensedB.cw127.php
@@ -0,0 +1,163 @@
+<?php
+$rangeid=114;
+$prevcid=126;
+$prevwidth=754;
+$interval=false;
+$range=array (
+  32 => 
+  array (
+    0 => 313,
+    1 => 410,
+    2 => 469,
+    3 => 754,
+    4 => 626,
+    5 => 901,
+    6 => 785,
+    7 => 275,
+  ),
+  40 => 
+  array (
+    0 => 411,
+    1 => 411,
+    'interval' => true,
+  ),
+  42 => 
+  array (
+    0 => 470,
+    1 => 754,
+    2 => 342,
+    3 => 374,
+    4 => 342,
+    5 => 329,
+  ),
+  48 => 
+  array (
+    0 => 626,
+    1 => 626,
+    'interval' => true,
+    2 => 626,
+    3 => 626,
+    4 => 626,
+    5 => 626,
+    6 => 626,
+    7 => 626,
+    8 => 626,
+    9 => 626,
+  ),
+  58 => 
+  array (
+    0 => 360,
+    1 => 360,
+    'interval' => true,
+  ),
+  60 => 
+  array (
+    0 => 754,
+    1 => 754,
+    'interval' => true,
+    2 => 754,
+  ),
+  63 => 
+  array (
+    0 => 522,
+    1 => 900,
+    2 => 696,
+    3 => 686,
+    4 => 660,
+    5 => 747,
+  ),
+  69 => 
+  array (
+    0 => 615,
+    1 => 615,
+    'interval' => true,
+  ),
+  71 => 
+  array (
+    0 => 738,
+    1 => 753,
+  ),
+  73 => 
+  array (
+    0 => 334,
+    1 => 334,
+    'interval' => true,
+  ),
+  75 => 
+  array (
+    0 => 697,
+    1 => 573,
+    2 => 896,
+    3 => 753,
+    4 => 765,
+    5 => 659,
+    6 => 765,
+    7 => 693,
+    8 => 648,
+    9 => 614,
+    10 => 730,
+    11 => 696,
+    12 => 993,
+    13 => 694,
+    14 => 651,
+    15 => 652,
+    16 => 411,
+    17 => 329,
+    18 => 411,
+    19 => 754,
+  ),
+  95 => 
+  array (
+    0 => 450,
+    1 => 450,
+    'interval' => true,
+  ),
+  97 => 
+  array (
+    0 => 607,
+    1 => 644,
+    2 => 533,
+    3 => 644,
+    4 => 610,
+    5 => 391,
+    6 => 644,
+    7 => 641,
+  ),
+  105 => 
+  array (
+    0 => 308,
+    1 => 308,
+    'interval' => true,
+  ),
+  107 => 
+  array (
+    0 => 598,
+    1 => 308,
+    2 => 938,
+    3 => 641,
+    4 => 618,
+  ),
+  112 => 
+  array (
+    0 => 644,
+    1 => 644,
+    'interval' => true,
+  ),
+  114 => 
+  array (
+    0 => 444,
+    1 => 536,
+    2 => 430,
+    3 => 641,
+    4 => 586,
+    5 => 831,
+    6 => 580,
+    7 => 586,
+    8 => 523,
+    9 => 641,
+    10 => 329,
+    11 => 641,
+    12 => 754,
+  ),
+);
+?>
\ No newline at end of file
diff --git a/apps/frontend/lib/mpdf53/ttfontdata/dejavusanscondensedB.mtx.php b/apps/frontend/lib/mpdf53/ttfontdata/dejavusanscondensedB.mtx.php
new file mode 100755
index 0000000..4a3f17d
--- /dev/null
+++ b/apps/frontend/lib/mpdf53/ttfontdata/dejavusanscondensedB.mtx.php
@@ -0,0 +1,25 @@
+<?php
+$name='DejaVuSansCondensed-Bold';
+$type='TTF';
+$desc=array (
+  'Ascent' => 928,
+  'Descent' => -236,
+  'CapHeight' => 928,
+  'Flags' => 262148,
+  'FontBBox' => '[-962 -415 1778 1174]',
+  'ItalicAngle' => 0,
+  'StemV' => 165,
+  'MissingWidth' => 540,
+);
+$up=-63;
+$ut=44;
+$ttffile='/opt/lampp/htdocs/frontend/apps/frontend/lib/mpdf53/ttfonts/DejaVuSansCondensed-Bold.ttf';
+$TTCfontID='0';
+$originalsize=545712;
+$sip=false;
+$smp=false;
+$BMPselected=true;
+$fontkey='dejavusanscondensedB';
+$panose='0 0 2 11 8 6 3 6 4 2 2 4';
+$haskerninfo=false;
+?>
\ No newline at end of file
diff --git a/apps/frontend/lib/mpdf53/ttfontdata/dejavusanscondensedBI.cw.dat b/apps/frontend/lib/mpdf53/ttfontdata/dejavusanscondensedBI.cw.dat
new file mode 100755
index 0000000..3625337
Binary files /dev/null and b/apps/frontend/lib/mpdf53/ttfontdata/dejavusanscondensedBI.cw.dat differ
diff --git a/apps/frontend/lib/mpdf53/ttfontdata/dejavusanscondensedBI.cw127.php b/apps/frontend/lib/mpdf53/ttfontdata/dejavusanscondensedBI.cw127.php
new file mode 100755
index 0000000..e3562d2
--- /dev/null
+++ b/apps/frontend/lib/mpdf53/ttfontdata/dejavusanscondensedBI.cw127.php
@@ -0,0 +1,170 @@
+<?php
+$rangeid=114;
+$prevcid=126;
+$prevwidth=754;
+$interval=false;
+$range=array (
+  32 => 
+  array (
+    0 => 313,
+    1 => 410,
+    2 => 469,
+  ),
+  35 => 
+  array (
+    0 => 626,
+    1 => 626,
+    'interval' => true,
+  ),
+  37 => 
+  array (
+    0 => 901,
+    1 => 785,
+    2 => 275,
+  ),
+  40 => 
+  array (
+    0 => 411,
+    1 => 411,
+    'interval' => true,
+  ),
+  42 => 
+  array (
+    0 => 470,
+    1 => 754,
+    2 => 342,
+    3 => 374,
+    4 => 342,
+    5 => 329,
+  ),
+  48 => 
+  array (
+    0 => 626,
+    1 => 626,
+    'interval' => true,
+    2 => 626,
+    3 => 626,
+    4 => 626,
+    5 => 626,
+    6 => 626,
+    7 => 626,
+    8 => 626,
+    9 => 626,
+  ),
+  58 => 
+  array (
+    0 => 360,
+    1 => 360,
+    'interval' => true,
+  ),
+  60 => 
+  array (
+    0 => 754,
+    1 => 754,
+    'interval' => true,
+    2 => 754,
+  ),
+  63 => 
+  array (
+    0 => 522,
+    1 => 900,
+    2 => 696,
+    3 => 686,
+    4 => 660,
+    5 => 747,
+  ),
+  69 => 
+  array (
+    0 => 615,
+    1 => 615,
+    'interval' => true,
+  ),
+  71 => 
+  array (
+    0 => 738,
+    1 => 753,
+  ),
+  73 => 
+  array (
+    0 => 334,
+    1 => 334,
+    'interval' => true,
+  ),
+  75 => 
+  array (
+    0 => 697,
+    1 => 573,
+    2 => 896,
+    3 => 753,
+    4 => 765,
+    5 => 659,
+    6 => 765,
+    7 => 693,
+    8 => 648,
+    9 => 614,
+    10 => 730,
+    11 => 696,
+    12 => 993,
+    13 => 694,
+    14 => 651,
+    15 => 652,
+    16 => 411,
+    17 => 329,
+    18 => 411,
+    19 => 754,
+  ),
+  95 => 
+  array (
+    0 => 450,
+    1 => 450,
+    'interval' => true,
+  ),
+  97 => 
+  array (
+    0 => 607,
+    1 => 644,
+    2 => 533,
+    3 => 644,
+    4 => 610,
+    5 => 391,
+    6 => 644,
+    7 => 641,
+  ),
+  105 => 
+  array (
+    0 => 308,
+    1 => 308,
+    'interval' => true,
+  ),
+  107 => 
+  array (
+    0 => 598,
+    1 => 308,
+    2 => 938,
+    3 => 641,
+    4 => 618,
+  ),
+  112 => 
+  array (
+    0 => 644,
+    1 => 644,
+    'interval' => true,
+  ),
+  114 => 
+  array (
+    0 => 444,
+    1 => 536,
+    2 => 430,
+    3 => 641,
+    4 => 586,
+    5 => 831,
+    6 => 580,
+    7 => 586,
+    8 => 523,
+    9 => 641,
+    10 => 329,
+    11 => 641,
+    12 => 754,
+  ),
+);
+?>
\ No newline at end of file
diff --git a/apps/frontend/lib/mpdf53/ttfontdata/dejavusanscondensedBI.mtx.php b/apps/frontend/lib/mpdf53/ttfontdata/dejavusanscondensedBI.mtx.php
new file mode 100755
index 0000000..b564dad
--- /dev/null
+++ b/apps/frontend/lib/mpdf53/ttfontdata/dejavusanscondensedBI.mtx.php
@@ -0,0 +1,25 @@
+<?php
+$name='DejaVuSansCondensed-BoldOblique';
+$type='TTF';
+$desc=array (
+  'Ascent' => 928,
+  'Descent' => -236,
+  'CapHeight' => 928,
+  'Flags' => 262212,
+  'FontBBox' => '[-960 -385 1799 1121]',
+  'ItalicAngle' => -11,
+  'StemV' => 165,
+  'MissingWidth' => 540,
+);
+$up=-63;
+$ut=44;
+$ttffile='/opt/lampp/htdocs/frontend/apps/frontend/lib/mpdf53/ttfonts/DejaVuSansCondensed-BoldOblique.ttf';
+$TTCfontID='0';
+$originalsize=493756;
+$sip=false;
+$smp=false;
+$BMPselected=true;
+$fontkey='dejavusanscondensedBI';
+$panose='0 0 2 11 8 6 3 3 4 11 2 4';
+$haskerninfo=false;
+?>
\ No newline at end of file
diff --git a/apps/frontend/lib/mpdf53/ttfontdata/dejavusanscondensedI.cw.dat b/apps/frontend/lib/mpdf53/ttfontdata/dejavusanscondensedI.cw.dat
new file mode 100755
index 0000000..c4fe9c4
Binary files /dev/null and b/apps/frontend/lib/mpdf53/ttfontdata/dejavusanscondensedI.cw.dat differ
diff --git a/apps/frontend/lib/mpdf53/ttfontdata/dejavusanscondensedI.cw127.php b/apps/frontend/lib/mpdf53/ttfontdata/dejavusanscondensedI.cw127.php
new file mode 100755
index 0000000..85a2fa0
--- /dev/null
+++ b/apps/frontend/lib/mpdf53/ttfontdata/dejavusanscondensedI.cw127.php
@@ -0,0 +1,163 @@
+<?php
+$rangeid=122;
+$prevcid=126;
+$prevwidth=754;
+$interval=false;
+$range=array (
+  32 => 
+  array (
+    0 => 286,
+    1 => 360,
+    2 => 414,
+    3 => 754,
+    4 => 572,
+    5 => 855,
+    6 => 702,
+    7 => 247,
+  ),
+  40 => 
+  array (
+    0 => 351,
+    1 => 351,
+    'interval' => true,
+  ),
+  42 => 
+  array (
+    0 => 450,
+    1 => 754,
+    2 => 286,
+    3 => 325,
+    4 => 286,
+    5 => 303,
+  ),
+  48 => 
+  array (
+    0 => 572,
+    1 => 572,
+    'interval' => true,
+    2 => 572,
+    3 => 572,
+    4 => 572,
+    5 => 572,
+    6 => 572,
+    7 => 572,
+    8 => 572,
+    9 => 572,
+  ),
+  58 => 
+  array (
+    0 => 303,
+    1 => 303,
+    'interval' => true,
+  ),
+  60 => 
+  array (
+    0 => 754,
+    1 => 754,
+    'interval' => true,
+    2 => 754,
+  ),
+  63 => 
+  array (
+    0 => 478,
+    1 => 900,
+    2 => 615,
+    3 => 617,
+    4 => 628,
+    5 => 693,
+    6 => 568,
+    7 => 518,
+    8 => 697,
+    9 => 677,
+  ),
+  73 => 
+  array (
+    0 => 265,
+    1 => 265,
+    'interval' => true,
+  ),
+  75 => 
+  array (
+    0 => 590,
+    1 => 501,
+    2 => 776,
+    3 => 673,
+    4 => 708,
+    5 => 542,
+    6 => 708,
+    7 => 625,
+    8 => 571,
+    9 => 549,
+    10 => 659,
+    11 => 615,
+    12 => 890,
+    13 => 616,
+    14 => 549,
+    15 => 616,
+    16 => 351,
+    17 => 303,
+    18 => 351,
+    19 => 754,
+  ),
+  95 => 
+  array (
+    0 => 450,
+    1 => 450,
+    'interval' => true,
+  ),
+  97 => 
+  array (
+    0 => 551,
+    1 => 571,
+    2 => 495,
+    3 => 571,
+    4 => 554,
+    5 => 316,
+    6 => 571,
+    7 => 570,
+  ),
+  105 => 
+  array (
+    0 => 250,
+    1 => 250,
+    'interval' => true,
+  ),
+  107 => 
+  array (
+    0 => 521,
+    1 => 250,
+    2 => 876,
+    3 => 570,
+    4 => 550,
+  ),
+  112 => 
+  array (
+    0 => 571,
+    1 => 571,
+    'interval' => true,
+  ),
+  114 => 
+  array (
+    0 => 370,
+    1 => 469,
+    2 => 353,
+    3 => 570,
+    4 => 532,
+    5 => 736,
+  ),
+  120 => 
+  array (
+    0 => 532,
+    1 => 532,
+    'interval' => true,
+  ),
+  122 => 
+  array (
+    0 => 472,
+    1 => 572,
+    2 => 303,
+    3 => 572,
+    4 => 754,
+  ),
+);
+?>
\ No newline at end of file
diff --git a/apps/frontend/lib/mpdf53/ttfontdata/dejavusanscondensedI.mtx.php b/apps/frontend/lib/mpdf53/ttfontdata/dejavusanscondensedI.mtx.php
new file mode 100755
index 0000000..bdf6a5e
--- /dev/null
+++ b/apps/frontend/lib/mpdf53/ttfontdata/dejavusanscondensedI.mtx.php
@@ -0,0 +1,25 @@
+<?php
+$name='DejaVuSansCondensed-Oblique';
+$type='TTF';
+$desc=array (
+  'Ascent' => 928,
+  'Descent' => -236,
+  'CapHeight' => 928,
+  'Flags' => 68,
+  'FontBBox' => '[-914 -350 1493 1068]',
+  'ItalicAngle' => -11,
+  'StemV' => 87,
+  'MissingWidth' => 540,
+);
+$up=-63;
+$ut=44;
+$ttffile='/opt/lampp/htdocs/frontend/apps/frontend/lib/mpdf53/ttfonts/DejaVuSansCondensed-Oblique.ttf';
+$TTCfontID='0';
+$originalsize=489032;
+$sip=false;
+$smp=false;
+$BMPselected=true;
+$fontkey='dejavusanscondensedI';
+$panose='0 0 2 11 6 6 3 3 4 11 2 4';
+$haskerninfo=false;
+?>
\ No newline at end of file
diff --git a/apps/frontend/lib/mpdf53/ttfontdata/dejavuserifcondensed.cw.dat b/apps/frontend/lib/mpdf53/ttfontdata/dejavuserifcondensed.cw.dat
new file mode 100755
index 0000000..c5a60d9
Binary files /dev/null and b/apps/frontend/lib/mpdf53/ttfontdata/dejavuserifcondensed.cw.dat differ
diff --git a/apps/frontend/lib/mpdf53/ttfontdata/dejavuserifcondensed.cw127.php b/apps/frontend/lib/mpdf53/ttfontdata/dejavuserifcondensed.cw127.php
new file mode 100755
index 0000000..21342b3
--- /dev/null
+++ b/apps/frontend/lib/mpdf53/ttfontdata/dejavuserifcondensed.cw127.php
@@ -0,0 +1,142 @@
+<?php
+$rangeid=114;
+$prevcid=126;
+$prevwidth=754;
+$interval=false;
+$range=array (
+  32 => 
+  array (
+    0 => 286,
+    1 => 361,
+    2 => 414,
+    3 => 754,
+    4 => 572,
+    5 => 855,
+    6 => 801,
+    7 => 247,
+  ),
+  40 => 
+  array (
+    0 => 351,
+    1 => 351,
+    'interval' => true,
+  ),
+  42 => 
+  array (
+    0 => 450,
+    1 => 754,
+    2 => 286,
+    3 => 304,
+    4 => 286,
+    5 => 303,
+  ),
+  48 => 
+  array (
+    0 => 572,
+    1 => 572,
+    'interval' => true,
+    2 => 572,
+    3 => 572,
+    4 => 572,
+    5 => 572,
+    6 => 572,
+    7 => 572,
+    8 => 572,
+    9 => 572,
+  ),
+  58 => 
+  array (
+    0 => 303,
+    1 => 303,
+    'interval' => true,
+  ),
+  60 => 
+  array (
+    0 => 754,
+    1 => 754,
+    'interval' => true,
+    2 => 754,
+  ),
+  63 => 
+  array (
+    0 => 482,
+    1 => 900,
+    2 => 650,
+    3 => 661,
+    4 => 688,
+    5 => 721,
+    6 => 657,
+    7 => 624,
+    8 => 719,
+    9 => 785,
+    10 => 355,
+    11 => 360,
+    12 => 672,
+    13 => 598,
+    14 => 921,
+    15 => 787,
+    16 => 738,
+    17 => 605,
+    18 => 738,
+    19 => 677,
+    20 => 616,
+    21 => 600,
+    22 => 758,
+    23 => 650,
+    24 => 925,
+    25 => 641,
+    26 => 594,
+    27 => 625,
+    28 => 351,
+    29 => 303,
+    30 => 351,
+    31 => 754,
+  ),
+  95 => 
+  array (
+    0 => 450,
+    1 => 450,
+    'interval' => true,
+  ),
+  97 => 
+  array (
+    0 => 536,
+    1 => 576,
+    2 => 504,
+    3 => 576,
+    4 => 532,
+    5 => 333,
+    6 => 576,
+    7 => 580,
+    8 => 288,
+    9 => 279,
+    10 => 545,
+    11 => 288,
+    12 => 853,
+    13 => 580,
+    14 => 542,
+  ),
+  112 => 
+  array (
+    0 => 576,
+    1 => 576,
+    'interval' => true,
+  ),
+  114 => 
+  array (
+    0 => 430,
+    1 => 461,
+    2 => 361,
+    3 => 580,
+    4 => 508,
+    5 => 770,
+    6 => 507,
+    7 => 508,
+    8 => 474,
+    9 => 572,
+    10 => 303,
+    11 => 572,
+    12 => 754,
+  ),
+);
+?>
\ No newline at end of file
diff --git a/apps/frontend/lib/mpdf53/ttfontdata/dejavuserifcondensed.mtx.php b/apps/frontend/lib/mpdf53/ttfontdata/dejavuserifcondensed.mtx.php
new file mode 100755
index 0000000..82fbb7f
--- /dev/null
+++ b/apps/frontend/lib/mpdf53/ttfontdata/dejavuserifcondensed.mtx.php
@@ -0,0 +1,25 @@
+<?php
+$name='DejaVuSerifCondensed';
+$type='TTF';
+$desc=array (
+  'Ascent' => 928,
+  'Descent' => -236,
+  'CapHeight' => 928,
+  'Flags' => 4,
+  'FontBBox' => '[-693 -347 1512 1242]',
+  'ItalicAngle' => 0,
+  'StemV' => 87,
+  'MissingWidth' => 540,
+);
+$up=-63;
+$ut=44;
+$ttffile='/opt/lampp/htdocs/frontend/apps/frontend/lib/mpdf53/ttfonts/DejaVuSerifCondensed.ttf';
+$TTCfontID='0';
+$originalsize=296976;
+$sip=false;
+$smp=false;
+$BMPselected=true;
+$fontkey='dejavuserifcondensed';
+$panose='0 0 2 6 6 6 5 6 5 2 2 4';
+$haskerninfo=false;
+?>
\ No newline at end of file
diff --git a/apps/frontend/lib/mpdf53/ttfontdata/dejavuserifcondensedB.cw.dat b/apps/frontend/lib/mpdf53/ttfontdata/dejavuserifcondensedB.cw.dat
new file mode 100755
index 0000000..ac354dd
Binary files /dev/null and b/apps/frontend/lib/mpdf53/ttfontdata/dejavuserifcondensedB.cw.dat differ
diff --git a/apps/frontend/lib/mpdf53/ttfontdata/dejavuserifcondensedB.cw127.php b/apps/frontend/lib/mpdf53/ttfontdata/dejavuserifcondensedB.cw127.php
new file mode 100755
index 0000000..879da00
--- /dev/null
+++ b/apps/frontend/lib/mpdf53/ttfontdata/dejavuserifcondensedB.cw127.php
@@ -0,0 +1,142 @@
+<?php
+$rangeid=114;
+$prevcid=126;
+$prevwidth=754;
+$interval=false;
+$range=array (
+  32 => 
+  array (
+    0 => 313,
+    1 => 395,
+    2 => 469,
+    3 => 754,
+    4 => 626,
+    5 => 855,
+    6 => 813,
+    7 => 275,
+  ),
+  40 => 
+  array (
+    0 => 426,
+    1 => 426,
+    'interval' => true,
+  ),
+  42 => 
+  array (
+    0 => 470,
+    1 => 754,
+    2 => 313,
+    3 => 374,
+    4 => 313,
+    5 => 329,
+  ),
+  48 => 
+  array (
+    0 => 626,
+    1 => 626,
+    'interval' => true,
+    2 => 626,
+    3 => 626,
+    4 => 626,
+    5 => 626,
+    6 => 626,
+    7 => 626,
+    8 => 626,
+    9 => 626,
+  ),
+  58 => 
+  array (
+    0 => 332,
+    1 => 332,
+    'interval' => true,
+  ),
+  60 => 
+  array (
+    0 => 754,
+    1 => 754,
+    'interval' => true,
+    2 => 754,
+  ),
+  63 => 
+  array (
+    0 => 527,
+    1 => 900,
+    2 => 698,
+    3 => 760,
+    4 => 716,
+    5 => 780,
+    6 => 686,
+    7 => 639,
+    8 => 769,
+    9 => 850,
+    10 => 421,
+    11 => 426,
+    12 => 782,
+    13 => 633,
+    14 => 996,
+    15 => 822,
+    16 => 784,
+    17 => 677,
+    18 => 784,
+    19 => 748,
+    20 => 650,
+    21 => 669,
+    22 => 785,
+    23 => 698,
+    24 => 1011,
+    25 => 698,
+    26 => 642,
+    27 => 657,
+    28 => 426,
+    29 => 329,
+    30 => 426,
+    31 => 754,
+  ),
+  95 => 
+  array (
+    0 => 450,
+    1 => 450,
+    'interval' => true,
+  ),
+  97 => 
+  array (
+    0 => 583,
+    1 => 629,
+    2 => 548,
+    3 => 629,
+    4 => 572,
+    5 => 387,
+    6 => 629,
+    7 => 654,
+    8 => 342,
+    9 => 325,
+    10 => 624,
+    11 => 342,
+    12 => 952,
+    13 => 654,
+    14 => 600,
+  ),
+  112 => 
+  array (
+    0 => 629,
+    1 => 629,
+    'interval' => true,
+  ),
+  114 => 
+  array (
+    0 => 474,
+    1 => 506,
+    2 => 416,
+    3 => 654,
+    4 => 523,
+    5 => 774,
+    6 => 536,
+    7 => 523,
+    8 => 511,
+    9 => 579,
+    10 => 327,
+    11 => 579,
+    12 => 754,
+  ),
+);
+?>
\ No newline at end of file
diff --git a/apps/frontend/lib/mpdf53/ttfontdata/dejavuserifcondensedB.mtx.php b/apps/frontend/lib/mpdf53/ttfontdata/dejavuserifcondensedB.mtx.php
new file mode 100755
index 0000000..ba97a7e
--- /dev/null
+++ b/apps/frontend/lib/mpdf53/ttfontdata/dejavuserifcondensedB.mtx.php
@@ -0,0 +1,25 @@
+<?php
+$name='DejaVuSerifCondensed-Bold';
+$type='TTF';
+$desc=array (
+  'Ascent' => 939,
+  'Descent' => -236,
+  'CapHeight' => 939,
+  'Flags' => 262148,
+  'FontBBox' => '[-752 -389 1617 1235]',
+  'ItalicAngle' => 0,
+  'StemV' => 165,
+  'MissingWidth' => 540,
+);
+$up=-63;
+$ut=44;
+$ttffile='/opt/lampp/htdocs/frontend/apps/frontend/lib/mpdf53/ttfonts/DejaVuSerifCondensed-Bold.ttf';
+$TTCfontID='0';
+$originalsize=283140;
+$sip=false;
+$smp=false;
+$BMPselected=true;
+$fontkey='dejavuserifcondensedB';
+$panose='0 0 2 6 8 6 5 6 5 2 2 4';
+$haskerninfo=false;
+?>
\ No newline at end of file
diff --git a/apps/frontend/lib/mpdf53/ttfontdata/dejavuserifcondensedBI.cw.dat b/apps/frontend/lib/mpdf53/ttfontdata/dejavuserifcondensedBI.cw.dat
new file mode 100755
index 0000000..515541f
Binary files /dev/null and b/apps/frontend/lib/mpdf53/ttfontdata/dejavuserifcondensedBI.cw.dat differ
diff --git a/apps/frontend/lib/mpdf53/ttfontdata/dejavuserifcondensedBI.cw127.php b/apps/frontend/lib/mpdf53/ttfontdata/dejavuserifcondensedBI.cw127.php
new file mode 100755
index 0000000..879da00
--- /dev/null
+++ b/apps/frontend/lib/mpdf53/ttfontdata/dejavuserifcondensedBI.cw127.php
@@ -0,0 +1,142 @@
+<?php
+$rangeid=114;
+$prevcid=126;
+$prevwidth=754;
+$interval=false;
+$range=array (
+  32 => 
+  array (
+    0 => 313,
+    1 => 395,
+    2 => 469,
+    3 => 754,
+    4 => 626,
+    5 => 855,
+    6 => 813,
+    7 => 275,
+  ),
+  40 => 
+  array (
+    0 => 426,
+    1 => 426,
+    'interval' => true,
+  ),
+  42 => 
+  array (
+    0 => 470,
+    1 => 754,
+    2 => 313,
+    3 => 374,
+    4 => 313,
+    5 => 329,
+  ),
+  48 => 
+  array (
+    0 => 626,
+    1 => 626,
+    'interval' => true,
+    2 => 626,
+    3 => 626,
+    4 => 626,
+    5 => 626,
+    6 => 626,
+    7 => 626,
+    8 => 626,
+    9 => 626,
+  ),
+  58 => 
+  array (
+    0 => 332,
+    1 => 332,
+    'interval' => true,
+  ),
+  60 => 
+  array (
+    0 => 754,
+    1 => 754,
+    'interval' => true,
+    2 => 754,
+  ),
+  63 => 
+  array (
+    0 => 527,
+    1 => 900,
+    2 => 698,
+    3 => 760,
+    4 => 716,
+    5 => 780,
+    6 => 686,
+    7 => 639,
+    8 => 769,
+    9 => 850,
+    10 => 421,
+    11 => 426,
+    12 => 782,
+    13 => 633,
+    14 => 996,
+    15 => 822,
+    16 => 784,
+    17 => 677,
+    18 => 784,
+    19 => 748,
+    20 => 650,
+    21 => 669,
+    22 => 785,
+    23 => 698,
+    24 => 1011,
+    25 => 698,
+    26 => 642,
+    27 => 657,
+    28 => 426,
+    29 => 329,
+    30 => 426,
+    31 => 754,
+  ),
+  95 => 
+  array (
+    0 => 450,
+    1 => 450,
+    'interval' => true,
+  ),
+  97 => 
+  array (
+    0 => 583,
+    1 => 629,
+    2 => 548,
+    3 => 629,
+    4 => 572,
+    5 => 387,
+    6 => 629,
+    7 => 654,
+    8 => 342,
+    9 => 325,
+    10 => 624,
+    11 => 342,
+    12 => 952,
+    13 => 654,
+    14 => 600,
+  ),
+  112 => 
+  array (
+    0 => 629,
+    1 => 629,
+    'interval' => true,
+  ),
+  114 => 
+  array (
+    0 => 474,
+    1 => 506,
+    2 => 416,
+    3 => 654,
+    4 => 523,
+    5 => 774,
+    6 => 536,
+    7 => 523,
+    8 => 511,
+    9 => 579,
+    10 => 327,
+    11 => 579,
+    12 => 754,
+  ),
+);
+?>
\ No newline at end of file
diff --git a/apps/frontend/lib/mpdf53/ttfontdata/dejavuserifcondensedBI.mtx.php b/apps/frontend/lib/mpdf53/ttfontdata/dejavuserifcondensedBI.mtx.php
new file mode 100755
index 0000000..0b51cf8
--- /dev/null
+++ b/apps/frontend/lib/mpdf53/ttfontdata/dejavuserifcondensedBI.mtx.php
@@ -0,0 +1,25 @@
+<?php
+$name='DejaVuSerifCondensed-BoldItalic';
+$type='TTF';
+$desc=array (
+  'Ascent' => 939,
+  'Descent' => -236,
+  'CapHeight' => 939,
+  'Flags' => 262212,
+  'FontBBox' => '[-815 -389 1579 1235]',
+  'ItalicAngle' => -11,
+  'StemV' => 165,
+  'MissingWidth' => 540,
+);
+$up=-63;
+$ut=44;
+$ttffile='/opt/lampp/htdocs/frontend/apps/frontend/lib/mpdf53/ttfonts/DejaVuSerifCondensed-BoldItalic.ttf';
+$TTCfontID='0';
+$originalsize=294584;
+$sip=false;
+$smp=false;
+$BMPselected=true;
+$fontkey='dejavuserifcondensedBI';
+$panose='0 0 2 6 8 6 5 3 5 11 2 4';
+$haskerninfo=false;
+?>
\ No newline at end of file
diff --git a/apps/frontend/lib/mpdf53/ttfontdata/dejavuserifcondensedI.cw.dat b/apps/frontend/lib/mpdf53/ttfontdata/dejavuserifcondensedI.cw.dat
new file mode 100755
index 0000000..2038a39
Binary files /dev/null and b/apps/frontend/lib/mpdf53/ttfontdata/dejavuserifcondensedI.cw.dat differ
diff --git a/apps/frontend/lib/mpdf53/ttfontdata/dejavuserifcondensedI.cw127.php b/apps/frontend/lib/mpdf53/ttfontdata/dejavuserifcondensedI.cw127.php
new file mode 100755
index 0000000..21342b3
--- /dev/null
+++ b/apps/frontend/lib/mpdf53/ttfontdata/dejavuserifcondensedI.cw127.php
@@ -0,0 +1,142 @@
+<?php
+$rangeid=114;
+$prevcid=126;
+$prevwidth=754;
+$interval=false;
+$range=array (
+  32 => 
+  array (
+    0 => 286,
+    1 => 361,
+    2 => 414,
+    3 => 754,
+    4 => 572,
+    5 => 855,
+    6 => 801,
+    7 => 247,
+  ),
+  40 => 
+  array (
+    0 => 351,
+    1 => 351,
+    'interval' => true,
+  ),
+  42 => 
+  array (
+    0 => 450,
+    1 => 754,
+    2 => 286,
+    3 => 304,
+    4 => 286,
+    5 => 303,
+  ),
+  48 => 
+  array (
+    0 => 572,
+    1 => 572,
+    'interval' => true,
+    2 => 572,
+    3 => 572,
+    4 => 572,
+    5 => 572,
+    6 => 572,
+    7 => 572,
+    8 => 572,
+    9 => 572,
+  ),
+  58 => 
+  array (
+    0 => 303,
+    1 => 303,
+    'interval' => true,
+  ),
+  60 => 
+  array (
+    0 => 754,
+    1 => 754,
+    'interval' => true,
+    2 => 754,
+  ),
+  63 => 
+  array (
+    0 => 482,
+    1 => 900,
+    2 => 650,
+    3 => 661,
+    4 => 688,
+    5 => 721,
+    6 => 657,
+    7 => 624,
+    8 => 719,
+    9 => 785,
+    10 => 355,
+    11 => 360,
+    12 => 672,
+    13 => 598,
+    14 => 921,
+    15 => 787,
+    16 => 738,
+    17 => 605,
+    18 => 738,
+    19 => 677,
+    20 => 616,
+    21 => 600,
+    22 => 758,
+    23 => 650,
+    24 => 925,
+    25 => 641,
+    26 => 594,
+    27 => 625,
+    28 => 351,
+    29 => 303,
+    30 => 351,
+    31 => 754,
+  ),
+  95 => 
+  array (
+    0 => 450,
+    1 => 450,
+    'interval' => true,
+  ),
+  97 => 
+  array (
+    0 => 536,
+    1 => 576,
+    2 => 504,
+    3 => 576,
+    4 => 532,
+    5 => 333,
+    6 => 576,
+    7 => 580,
+    8 => 288,
+    9 => 279,
+    10 => 545,
+    11 => 288,
+    12 => 853,
+    13 => 580,
+    14 => 542,
+  ),
+  112 => 
+  array (
+    0 => 576,
+    1 => 576,
+    'interval' => true,
+  ),
+  114 => 
+  array (
+    0 => 430,
+    1 => 461,
+    2 => 361,
+    3 => 580,
+    4 => 508,
+    5 => 770,
+    6 => 507,
+    7 => 508,
+    8 => 474,
+    9 => 572,
+    10 => 303,
+    11 => 572,
+    12 => 754,
+  ),
+);
+?>
\ No newline at end of file
diff --git a/apps/frontend/lib/mpdf53/ttfontdata/dejavuserifcondensedI.mtx.php b/apps/frontend/lib/mpdf53/ttfontdata/dejavuserifcondensedI.mtx.php
new file mode 100755
index 0000000..5c5d168
--- /dev/null
+++ b/apps/frontend/lib/mpdf53/ttfontdata/dejavuserifcondensedI.mtx.php
@@ -0,0 +1,25 @@
+<?php
+$name='DejaVuSerifCondensed-Italic';
+$type='TTF';
+$desc=array (
+  'Ascent' => 928,
+  'Descent' => -236,
+  'CapHeight' => 928,
+  'Flags' => 68,
+  'FontBBox' => '[-755 -347 1480 1227]',
+  'ItalicAngle' => -11,
+  'StemV' => 87,
+  'MissingWidth' => 540,
+);
+$up=-63;
+$ut=44;
+$ttffile='/opt/lampp/htdocs/frontend/apps/frontend/lib/mpdf53/ttfonts/DejaVuSerifCondensed-Italic.ttf';
+$TTCfontID='0';
+$originalsize=302444;
+$sip=false;
+$smp=false;
+$BMPselected=true;
+$fontkey='dejavuserifcondensedI';
+$panose='0 0 2 6 6 6 5 3 5 11 2 4';
+$haskerninfo=false;
+?>
\ No newline at end of file
diff --git a/apps/frontend/lib/s3upload/S3.php b/apps/frontend/lib/s3upload/S3.php
old mode 100644
new mode 100755
diff --git a/apps/frontend/lib/s3upload/image_check.php b/apps/frontend/lib/s3upload/image_check.php
old mode 100644
new mode 100755
diff --git a/apps/frontend/lib/s3upload/s3_config.php b/apps/frontend/lib/s3upload/s3_config.php
old mode 100644
new mode 100755
diff --git a/apps/frontend/lib/subida.txt b/apps/frontend/lib/subida.txt
new file mode 100755
index 0000000..facee5f
--- /dev/null
+++ b/apps/frontend/lib/subida.txt
@@ -0,0 +1 @@
+hola!!
diff --git a/apps/frontend/modules/cars/actions/actions.class.php b/apps/frontend/modules/cars/actions/actions.class.php
index b6711cb..770eb1c 100755
--- a/apps/frontend/modules/cars/actions/actions.class.php
+++ b/apps/frontend/modules/cars/actions/actions.class.php
@@ -72,7 +72,7 @@ class carsActions extends sfActions {
         $this->velocidadMensajes = $this->user->getVelocidadRespuesta_mensajes();
         //var_dump($this->velocidadMensajes);
         //die();
-        $this->nombreAcortado =	$this->recortar_texto($this->user->getFirstname()." ". $this->user->getLastname(), 20);
+        $this->nombreAcortado =	$this->recortar_texto($this->user->getFirstname()." ". $this->user->getLastname(), 15);
     	//Modificacin para llevar el conteo de la cantidad de consulas que recibe el perfil del auto
     	$q= Doctrine_Query::create()
     	    ->update("car")
diff --git a/apps/frontend/modules/cars/templates/carSuccess.php b/apps/frontend/modules/cars/templates/carSuccess.php
index 2436af9..392882e 100755
--- a/apps/frontend/modules/cars/templates/carSuccess.php
+++ b/apps/frontend/modules/cars/templates/carSuccess.php
@@ -196,9 +196,9 @@ a{text-decoration:none;}
 		<div class="texto_normal precios">A&ntilde;o | <strong><?php echo $car->getYear(); ?></strong></div>
 		<div class="texto_normal precios">Tipo de Bencina | <strong><?php echo strtoupper($car->getTipoBencina()); ?></strong></div>
 
-		<div class="subtitulos punteado espaciado"><p>Due&ntilde;o - <a class="colorSub" href="<?php echo url_for('profile/publicprofile?id=' . $user->getId()) ?>" title="Ir al perfil de <?php echo $user->getFirstname().' '.$user->getLastname(); ?>"><?php echo $nombreAcortado?></a></p><a href="<?php echo url_for('messages/new?id='.$user->getId()) ?>" style="" title="Enviar e-mail a <?php echo $user->getFirstname().' '.$user->getLastname(); ?>"><?php echo image_tag('mail_24.png',"class=boton2"); ?></a></div>
+		<div class="subtitulos punteado espaciado"><p>Due&ntilde;o - <a class="colorSub" href="<?php echo url_for('profile/publicprofile?id=' . $user->getId()) ?>" title="Ir al perfil de <?php echo ucwords($user->getFirstname()).' '.ucwords($user->getLastname()); ?>"><?=ucwords($nombreAcortado);?></a></p><a href="<?php echo url_for('messages/new?id='.$user->getId()) ?>" style="" title="Enviar e-mail a <?php echo ucwords($user->getFirstname()).' '.ucwords($user->getLastname()); ?>"><?php echo image_tag('img_msj/EnviarMsjSinSombraChico.png',"class=boton2"); ?></a></div>
 		<div class="texto_normal precios">Calificaciones Positivas | <strong><?=$aprobacionDuenio['porcentaje'];?>%</strong></div>
-		<div class="texto_normal precios">Velocidad de Respuesta | <strong><?=$velocidadMensajes;?></strong></div>
+		<div class="texto_normal precios">Velocidad de Respuesta | <strong><?php if($velocidadMensajes == ""){ echo "<span style='font-style: italic; color:#BCBEB0;'>No tiene mensajes</span>";}else{ echo $velocidadMensajes;}?></strong></div>
 		<div class="texto_normal precios"><a class="colorSub" href="<?php echo url_for('profile/publicprofile?id=' . $user->getId()) ?>" title="Ver calificaciones hechas a <?php echo $user->getFirstname().' '.$user->getLastname(); ?>">Ver Calificaciones</a></div>
 		
 		<?php if($car->getDescription() != null){ ?>
@@ -206,7 +206,7 @@ a{text-decoration:none;}
 			<div class="texto_normal precios"><?php echo $car->getDescription(); ?></div>
 		<?php } ?>
 		<div class="subtitulos punteado espaciado">Da&ntilde;os del auto</div>
-			<div class="texto_normal precios"><a class="colorSub" title="Ver los daos del auto" href="<?php echo url_for('http://www.arriendas.cl/main/informeDanios?idAuto='.$car->getId()) ?>">Ver los daos del auto</a></div>
+			<div class="texto_normal precios"><a  target="_blank" class="colorSub" title="Ver los daos del auto" href="<?php echo url_for('http://www.arriendas.cl/main/informeDanios/idAuto/'.$car->getId()) ?>">Ver los daos del auto</a></div>
 	</div>
   
 </div>
diff --git a/apps/frontend/modules/main/actions/actions.class.php b/apps/frontend/modules/main/actions/actions.class.php
index a575467..ff01a14 100755
--- a/apps/frontend/modules/main/actions/actions.class.php
+++ b/apps/frontend/modules/main/actions/actions.class.php
@@ -95,8 +95,8 @@ public function executeGenerarFormularioEntregaDevolucion(sfWebRequest $request)
 
 public function executeFormularioEntrega(sfWebRequest $request){
     //se asume que se recibe el id de la tabla reserva desde la pgina anterior
-        $idReserve = 605;
-        //$idReserve= $request->getParameter("idReserve");
+        //$idReserve = 605;
+        $idReserve= $request->getParameter("idReserve");
 
         //id del usuario que accede al sitio
         $idUsuario = sfContext::getInstance()->getUser()->getAttribute('userid');
@@ -1220,7 +1220,7 @@ public function executeNotificacion(sfWebRequest $request) {
 		$this->getUser()->setAuthenticated(true);
 		$this->getUser()->setAttribute("logged", true);
 		$this->getUser()->setAttribute("userid", $user->getId());
-		$this->getUser()->setAttribute("name", $user->getFirstName() . " " . substr($user->getLastName(), 0, 1) . '.');
+		$this->getUser()->setAttribute("name", current(explode(' ' , $user->getFirstName())) . " " . substr($user->getLastName(), 0, 1) . '.');
 		$this->getUser()->setAttribute("picture_url", $user->getFileName());
 		//Modificacion para identificar si el usuario es propietario o no de vehiculo
 		if($user->isPropietario()) {
@@ -1618,7 +1618,7 @@ El equipo de Arriendas.cl
 	                $this->getUser()->setAuthenticated(true);
 	                $this->getUser()->setAttribute("logged", true);
 	                $this->getUser()->setAttribute("userid", $user->getId());
-	                $this->getUser()->setAttribute("name", $user->getFirstName() . " " . substr($user->getLastName(), 0, 1) . '.');
+	                $this->getUser()->setAttribute("name", current(explode(' ' , $user->getFirstName())) . " " . substr($user->getLastName(), 0, 1) . '.');
 	                $this->getUser()->setAttribute("picture_url", $user->getFileName());
 			//Modificacion para identificar si el usuario es propietario o no de vehiculo
 			if($user->isPropietario()) {
@@ -2016,7 +2016,7 @@ Con tu '.htmlentities($brand).' '.htmlentities($model).' del '.$year.' puedes ga
                 $this->getUser()->setAuthenticated(true);
                 $this->getUser()->setAttribute("logged", true);
                 $this->getUser()->setAttribute("userid", $userdb->getId());
-                $this->getUser()->setAttribute("name", $userdb->getFirstName() . " " . substr($userdb->getLastName(), 0, 1) . '.');
+                $this->getUser()->setAttribute("name", current(explode(' ' , $userdb->getFirstName())) . " " . substr($userdb->getLastName(), 0, 1) . '.');
                 $this->getUser()->setAttribute("picture_url", $userdb->getPictureFile());
                 $this->getUser()->setAttribute("fb", true);	
 		//Modificacion para identificar si el usuario es propietario o no de vehiculo
diff --git a/apps/frontend/modules/main/actions/actions.class.php.new.php b/apps/frontend/modules/main/actions/actions.class.php.new.php
index bd42281..4ddfcd4 100755
--- a/apps/frontend/modules/main/actions/actions.class.php.new.php
+++ b/apps/frontend/modules/main/actions/actions.class.php.new.php
@@ -1217,9 +1217,9 @@ El equipo de Arriendas.cl
 	                $this->getUser()->setAuthenticated(true);
 	                $this->getUser()->setAttribute("logged", true);
 	                $this->getUser()->setAttribute("userid", $user->getId());
-	                $this->getUser()->setAttribute("name", $user->getFirstName() . " " . substr($user->getLastName(), 0, 1) . '.');
+	                $this->getUser()->setAttribute("name", current(explode(' ' , $user->getFirstName())) . " " . substr($user->getLastName(), 0, 1) . '.');
 	                $this->getUser()->setAttribute("picture_url", $user->getFileName());
-	
+	                
 	                if ($this->getUser()->getAttribute('lastview') != null) {
 	                    $this->redirect($this->getUser()->getAttribute('lastview'));
 	                }
@@ -1613,7 +1613,7 @@ Con tu '.htmlentities($brand).' '.htmlentities($model).' del '.$year.' puedes ga
                 $this->getUser()->setAuthenticated(true);
                 $this->getUser()->setAttribute("logged", true);
                 $this->getUser()->setAttribute("userid", $userdb->getId());
-                $this->getUser()->setAttribute("name", $userdb->getFirstName() . " " . substr($userdb->getLastName(), 0, 1) . '.');
+                $this->getUser()->setAttribute("name", current(explode(' ' , $userdb->getFirstName())) . " " . substr($userdb->getLastName(), 0, 1) . '.');
                 $this->getUser()->setAttribute("picture_url", $userdb->getPictureFile());
                 $this->getUser()->setAttribute("fb", true);
                 $this->getUser()->setAttribute('geolocalizacion', true);
diff --git a/apps/frontend/modules/main/config/layout.php b/apps/frontend/modules/main/config/layout.php
index a5dd42d..832331a 100755
--- a/apps/frontend/modules/main/config/layout.php
+++ b/apps/frontend/modules/main/config/layout.php
@@ -219,8 +219,8 @@
                         ?>" title="Sube tu Auto">
                                     <span>Sube tu Auto</span></a></li>
                                     
-							<li><a href="<?php echo url_for('profile/rental') ?>" class="item_5<?php
-							if (inModuleAndAction("profile", "rental")) {
+							<li><a href="<?php echo url_for('profile/pedidos') ?>" class="item_5<?php
+							if (inModuleAndAction("profile", "pedidos")) {
 								echo "_in";
 							}
  							?>" title="Reservas de mis Autos"><span>Reservas de mis Autos</span></a></li>                                    
@@ -263,7 +263,7 @@
                         <ul class="enlaces_box">
                             <li class="enlaces_titulo">Acciones</li>
                             <li><a href="<?php echo url_for('profile/addCar') ?>" title="Sube tu auto">Sube tu auto</a></li>
-                            <li><a href="<?php echo url_for('profile/rental') ?>" title="Busca un auto">Busca un auto</a></li>
+                            <li><a href="<?php echo url_for('profile/pedidos') ?>" title="Busca un auto">Busca un auto</a></li>
                         </ul>
 
                     </div><!-- footer_enlaces -->
diff --git a/apps/frontend/modules/main/templates/indexSuccess.php b/apps/frontend/modules/main/templates/indexSuccess.php
index f81a437..f5db31f 100755
--- a/apps/frontend/modules/main/templates/indexSuccess.php
+++ b/apps/frontend/modules/main/templates/indexSuccess.php
@@ -420,22 +420,26 @@
                 var dataCar = data.cars[i];
 				
                 var latLng = new google.maps.LatLng(dataCar.latitude,dataCar.longitude);
-		if (dataCar.verificado) {
-		    var verificado="<img src='images/verificado.png' class='img_verificado' title='Auto Asegurado'/>";
-		} else {
-		    var verificado="";
-		}
-        if(dataCar.cantidadCalificacionesPositivas == 0){
-            var calificacionesPositivas = "";
-        }else{
-            var calificacionesPositivas = "- " + dataCar.cantidadCalificacionesPositivas + "<img src='../images/Medalla.png' class='medallita'/>";
-        }
+    		if (dataCar.verificado) {
+    		    var verificado="<img src='images/verificado.png' class='img_verificado' title='Auto Asegurado'/>";
+    		} else {
+    		    var verificado="";
+    		}
+            if(dataCar.cantidadCalificacionesPositivas == 0){
+                var calificacionesPositivas = "";
+            }else{
+                var calificacionesPositivas = "- " + dataCar.cantidadCalificacionesPositivas + "<img src='../images/Medalla.png' class='medallita'/>";
+            }
+            if(dataCar.userVelocidadRespuesta == ""){
+                velocidadDeRespuesta = "<span style='font-style: italic; color:#BCBEB0;font-weight: normal;'>No tiene mensajes</span>";
+            }else{
+                velocidadDeRespuesta = dataCar.userVelocidadRespuesta;
+            }
                 //var precioPorDia = formatNumber(dataCar.price_per_day);
                 //var precioPorHora = formatNumber(dataCar.price_per_hour);
                 var contentString = '<div style="width:363px; height:159px;" class="mapcar_box" id="' + dataCar.id + '">' +
                     '<div class="mapcar_frame">' +
-                    '<a href="' + dataCar.photo + '"  class="thickbox"  ><img class="imagemark" width="112" height="84" src="<?php echo url_for("main/s3thumb"); ?>?alto=84&ancho=112&urlFoto=' + dataCar.photo  + '"/></a>' +					
-                    '</div><div class="detalles_car"><div class="titulo"><a href="<?php echo url_for('cars/car?id=') ?>'+dataCar.id + '">' + dataCar.brand + ' ' + dataCar.model + " " + verificado + calificacionesPositivas +'</a></div><div class="datos_car"><p>Dia: <b>$' + dataCar.price_per_day + ' CLP</b></p><p>Hora: <b>$'+ dataCar.price_per_hour +' CLP</b></p><p>Transmisin: <b>'+ dataCar.typeTransmission +'</b></p></div><div class="detalles_user"><a href="http://www.arriendas.cl/profile/publicprofile/id/' + dataCar.userid + '" class="mapcar_user_titulo" title="Ir al perfil de '+dataCar.username+'">' + dataCar.username + '</a><a href="http://www.arriendas.cl/messages/new/id/' +dataCar.userid + '" class="mapcar_user_message" title="Env&iacute;ale un mensaje a '+ dataCar.username +'"></a></div><div class="datos_user"><div class="img_vel_resp"></div><p>Velocidad de Respuesta: <br><b>'+dataCar.userVelocidadRespuesta+'</b></p><div class="img_reservas_resp"></div><p>Reservas Respondidas: <b>' + dataCar.reservasRespondidas + '</b></p></div></div><a href="<?php echo url_for('cars/car?id=') ?>' + dataCar.id + '" class="mapcar_btn_detalle"></a></div>';
+                    '<a href="' + dataCar.photo + '"  class="thickbox"  ><img class="imagemark" width="112" height="84" src="<?php echo url_for("main/s3thumbs").'?alto=112&ancho=84&urlFoto='; ?> + dataCar.photo  + '"/></a>' + '</div><div class="detalles_car"><div class="titulo"><a href="<?php echo url_for('cars/car?id=') ?>'+dataCar.id + '">' + dataCar.brand + ' ' + dataCar.model + " " + verificado + calificacionesPositivas +'</a></div><div class="datos_car"><p>Dia: <b>$' + dataCar.price_per_day + ' CLP</b></p><p>Hora: <b>$'+ dataCar.price_per_hour +' CLP</b></p><p>Transmisin: <b>'+ dataCar.typeTransmission +'</b></p></div><div class="detalles_user"><a href="http://www.arriendas.cl/profile/publicprofile/id/' + dataCar.userid + '" class="mapcar_user_titulo" title="Ir al perfil de '+dataCar.username+'">' + dataCar.username + '</a><a href="http://www.arriendas.cl/messages/new/id/' +dataCar.userid + '" class="mapcar_user_message" title="Env&iacute;ale un mensaje a '+ dataCar.username +'"></a></div><div class="datos_user"><div class="img_vel_resp"></div><p>Velocidad de Respuesta: <br><b>'+velocidadDeRespuesta+'</b></p><div class="img_reservas_resp"></div><p>Reservas Respondidas: <b>' + dataCar.reservasRespondidas + '</b></p></div></div><a href="<?php echo url_for('cars/car?id=') ?>' + dataCar.id + '" class="mapcar_btn_detalle"></a></div>';
 					
                 /*var contentString = 
                         '<div id="InfoCar">'+
@@ -1048,12 +1052,13 @@ $('#hour_to').datetimepicker({
     <div class="search_sector1">      
         <!--  busqueda avanzada -->
         <div class="search_box_1">
-            <input class="buton_more_options"/>
-            <div class="search_box_1_header">
+            <input type="button" class="buton_more_options"/>
+            <div class="search_box_1_title">
                 <!--<a href="#" class="search_form_calendar_1"><?php echo image_tag("img_search/land_form_ico_calendar.png") ?></a>-->
                 <!--<a href="#" class="search_form_calendar_2"><?php echo image_tag("img_search/land_form_ico_calendar.png") ?></a>-->
                 <p class="txt_buscador">Busca de automviles cerca de tu ubicacin <span>(bsqueda automtica)</span></p>
-                
+            </div>
+            <div class="search_box_1_header">    
                 <div class="search_box_ubica">
                 	<span class="group_desde">Ubicacin</span>
                 	<input id="searchTextField" type="text" size="50" placeholder="Introduce una ubicacin" autocomplete="off"/>
diff --git a/apps/frontend/modules/main/templates/thumbS3Success.php b/apps/frontend/modules/main/templates/thumbS3Success.php
old mode 100644
new mode 100755
diff --git a/apps/frontend/modules/messages/templates/_alerts.php b/apps/frontend/modules/messages/templates/_alerts.php
index fdd322f..12b9534 100755
--- a/apps/frontend/modules/messages/templates/_alerts.php
+++ b/apps/frontend/modules/messages/templates/_alerts.php
@@ -3,7 +3,8 @@
 <div id="info_alert_menu">
     <div class="alerts_submenu">
         <div class="dialog" id="globe"></div>
-        <div class="info_alert_menu" id="globe_menu" style="display:none">
+        <div class="info_alert_menu" id="globe_menu" style="display:none;margin-left: -90px;">
+            <div class="puntaNotificacion"></div>
             <div class="alert_header" style="background-color:#<?php echo $color ?>;">Transacciones pendientes</div>
             <div class="alert_content">
                 <?php include_component('messages', 'globe', array("color" => $color)); ?>
@@ -15,18 +16,20 @@
 
     <div class="alerts_submenu">
         <div class="dialog" id="car"></div>
-        <div class="info_alert_menu" id="car_menu" style="display: none; width: 300px;">
+        <div class="info_alert_menu" id="car_menu" style="display: none;margin-left: -90px;">
+            <div class="puntaNotificacion"></div>
             <div class="alert_header" style="background-color:#<?php echo $color ?>;">Alquileres en curso</div>
             <div class="alert_content">
                 <?php include_component('messages', 'car', array("color" => $color)); ?>
             </div>
-            <div class="alert_footer"><?= link_to("Ver mis pedidos de reserva", "profile/rental") ?></div>
+            <div class="alert_footer"><?= link_to("Ver mis pedidos de reserva", "profile/pedidos") ?></div>
         </div>
     </div><!--item2-->
 
     <div class="alerts_submenu">
         <div class="dialog" id="mail"></div>
-        <div class="info_alert_menu" id="mail_menu" style="display: none;margin-left: 6px;">
+        <div class="info_alert_menu" id="mail_menu" style="display: none;margin-top:30px;margin-left: -90px;">
+            <div class="puntaNotificacion" style="margin-left:97px;"></div>
             <div class="alert_header" style="background-color:#<?php echo $color ?>;">Mensajes recibidos</div>
             <div class="alert_content">
                 <?php include_component('messages', 'mail', array("color" => $color)); ?>
diff --git a/apps/frontend/modules/messages/templates/_car.php b/apps/frontend/modules/messages/templates/_car.php
index db324ca..a54cfa0 100755
--- a/apps/frontend/modules/messages/templates/_car.php
+++ b/apps/frontend/modules/messages/templates/_car.php
@@ -14,7 +14,7 @@
                     <?= $car->getUser()->getFirstName() ?> <?= substr($car->getUser()->getLastName(), 0, 1) ?>.
                 </div>
                 <div class="user_body">
-                    <b>Auto:</b> <?= $car->getBrand() ?> <?= $car->getModel() ?> (<?= $car->getYear() ?>)<br/>
+                    <b>Auto:</b> <?= $car->getBrand() ?> <?= $car->getModel() ?><br/>
                 </div>
                 <div class="user_fecha"><?= $car->getDate() ?></div>
             </div><!-- msg_user_post -->
@@ -37,7 +37,7 @@
                 <?= $car->getUser()->getFirstName() ?> <?= substr($car->getUser()->getLastName(), 0, 1) ?>.
             </div>
             <div class="user_body">
-                <b>Auto:</b> <?= $car->getBrand() ?> <?= $car->getModel() ?> (<?= $car->getYear() ?>)<br/>
+                <b>Auto:</b> <?= $car->getBrand() ?> <?= $car->getModel() ?><br/>
             </div>
             <div class="user_fecha"><?= $car->getDate() ?></div>
         </div><!-- msg_user_post -->
@@ -46,7 +46,7 @@
     <?php $cont++; ?>
 <?php endforeach; ?>
 <?php foreach ($porconfirmarkmsfinales as $car) : ?>
-    <div class="car_item user_item <?= ($car->getComplete() == 0) ? "alert_mess_unread" : "" ?>"  onclick="window.location='<?= url_for("profile/rental") ?>'">
+    <div class="car_item user_item <?= ($car->getComplete() == 0) ? "alert_mess_unread" : "" ?>"  onclick="window.location='<?= url_for("profile/pedidos") ?>'">
         <div class="user_frame">
             <?php if ($car->getCar()->getPhotoFile('main') != null): ?>
                 <?php echo image_tag("cars/" . $car->getCar()->getPhotoFile('main')->getFileName()) ?>
@@ -59,7 +59,7 @@
                 <?= $car->getUser()->getFirstName() ?> <?= substr($car->getUser()->getLastName(), 0, 1) ?>.
             </div>
             <div class="user_body">
-                <b>Auto:</b> <?= $car->getBrand() ?> <?= $car->getModel() ?> (<?= $car->getYear() ?>)<br/>
+                <b>Auto:</b> <?= $car->getBrand() ?> <?= $car->getModel() ?><br/>
             </div>
             <div class="user_fecha"><?= $car->getDate() ?></div>
         </div><!-- msg_user_post -->
@@ -81,7 +81,7 @@
                 <?= $car->getUser()->getFirstName() ?> <?= substr($car->getUser()->getLastName(), 0, 1) ?>.
             </div>
             <div class="user_body">
-                <b>Auto:</b> <?= $car->getBrand() ?> <?= $car->getModel() ?> (<?= $car->getYear() ?>)<br/>
+                <b>Auto:</b> <?= $car->getBrand() ?> <?= $car->getModel() ?><br/>
             </div>
             <div class="user_fecha"><?= $car->getDate() ?></div>
         </div><!-- msg_user_post -->
@@ -103,7 +103,7 @@
                 <?= $car->getUser()->getFirstName() ?> <?= substr($car->getUser()->getLastName(), 0, 1) ?>.
             </div>
             <div class="user_body">
-                <b>Auto:</b> <?= $car->getBrand() ?> <?= $car->getModel() ?> (<?= $car->getYear() ?>)<br/>
+                <b>Auto:</b> <?= $car->getBrand() ?> <?= $car->getModel() ?><br/>
             </div>
             <div class="user_fecha"><?= $car->getDate() ?></div>
         </div><!-- msg_user_post -->
@@ -112,9 +112,9 @@
     <?php $cont++; ?>
 <?php endforeach; ?>
 <ul class="notif_validado">
-    <?php if($user->getAutosSinVerificar() && $user->isPropietario()): ?><li style="width: 280px; padding-left: 22px; background-repeat: no-repeat; height: 22px; font-size: 12px; background-image: url('http://www.arriendas.cl/images/img_registro/regis_ico_sinverif.png')"><a href="#"><a href="<?php echo url_for("profile/cars"); ?>">Tienes autos sin verificar</a></a></li><?php $cont++; endif; ?>
-    <?php if($user->getEstadoVerificacion() && $user->isPropietario()): ?><li style="width: 280px; padding-left: 22px; background-repeat: no-repeat; height: 22px; font-size: 12px; background-image: url('http://www.arriendas.cl/images/img_registro/regis_ico_sinverif.png')"><a href="#"><a href="<?php echo url_for("profile/cars"); ?>">Verificaci&oacute;n incompleta</a></li><?php $cont++; endif; ?>
-    <?php if($user->getAutosPendientesVerificar() && $user->isPropietario()): ?><li style="width: 280px; padding-left: 22px; background-repeat: no-repeat; height: 22px; font-size: 12px; background-image: url('http://www.arriendas.cl/images/img_registro/regis_ico_sinverif.png')"><a href="#"><a href="<?php echo url_for("profile/cars"); ?>">Tienes autos en espera de verificacion</a></li><?php $cont++; endif; ?>
+    <?php if($user->getAutosSinVerificar() && $user->isPropietario()): ?><li><a href="<?php echo url_for("profile/cars"); ?>">Tienes autos sin verificar</a></a></li><?php $cont++; endif; ?>
+    <?php if($user->getEstadoVerificacion() && $user->isPropietario()): ?><li><a href="<?php echo url_for("profile/cars"); ?>">Verificaci&oacute;n incompleta</a></li><?php $cont++; endif; ?>
+    <?php if($user->getAutosPendientesVerificar() && $user->isPropietario()): ?><li><a href="#"><a href="<?php echo url_for("profile/cars"); ?>">Tienes autos en espera de verificacion</a></li><?php $cont++; endif; ?>
 </ul>
 
 <div id="dialog_car" style="display: none"><?php echo $cont; ?></div>
diff --git a/apps/frontend/modules/messages/templates/_credito.php b/apps/frontend/modules/messages/templates/_credito.php
old mode 100644
new mode 100755
diff --git a/apps/frontend/modules/paypal/actions/actions.class.php b/apps/frontend/modules/paypal/actions/actions.class.php
index 1cb0295..b0d0c32 100755
--- a/apps/frontend/modules/paypal/actions/actions.class.php
+++ b/apps/frontend/modules/paypal/actions/actions.class.php
@@ -147,6 +147,7 @@ class paypalActions extends sfActions
 			
 				$q = Doctrine::getTable('Transaction')->createQuery('t')->where('t.id = ? ', $_SESSION["tid"]);
 				$t = $q->fetchOne();
+				$t->setFechaPago(strftime("%Y%m%d%H%M%S"));
 				$t->setCompleted(true);
 				$t->save();
 			
diff --git a/apps/frontend/modules/profile/actions/actions.class.php b/apps/frontend/modules/profile/actions/actions.class.php
index 74818ca..5c7eddf 100755
--- a/apps/frontend/modules/profile/actions/actions.class.php
+++ b/apps/frontend/modules/profile/actions/actions.class.php
@@ -16,11 +16,38 @@ class profileActions extends sfActions {
      * @param sfRequest $request A request object
      */
 
+    public function executeEliminarCarAjax(sfWebRequest $request){
+        $idCar = $request ->getPostParameter('idCar');
+
+        $car = Doctrine_Core::getTable("car")->findOneById($idCar);
+        $car->setActivo(0);
+        $car->save();
+
+        die();
+    }
+
+    public function executePruebaMail(sfWebRequest $request){
+        require sfConfig::get('sf_app_lib_dir')."/mail/mail.php";
+
+        $path = sfConfig::get("sf_web_dir");
+
+        $mail = new Email();
+        $mail->setBody('<p>Hola esto es nuevo!!</p>');
+        //$mail->setTo('mex_ici89@hotmail.com');
+        //$mail->setTo('mauri-tkd@hotmail.com');
+        $mail->setTo('mauricio@arriendas.cl');
+        $mail->setFile($path.'/subida.txt');
+        $mail->setFile($path.'/subida.pdf');
+        $mail->setFile($path.'/subida.jpg');
+        $mail->setFile($path.'/subida.pdf');
+        echo $mail->submit();
+        die();
+    }
+
      
      public function executeEnviarConfirmacionSMS(sfWebRequest $request) {
 	$token=rand(1000,9999);
-	http://api.clickatell.com/http/sendmsg?user=patricio.lopez&password=PASSWORD&api_id=3412175&to=56996996794&text=Message
-	$url="http://api.clickatell.com/http/sendmsg?user=patricio.lopez&password=lxJIgTVX&api_id=34108612&MO=1&from=134752347&to=56996996794&text=Tu Codigo es el ".$token;
+	$url="http://api.clickatell.com/http/sendmsg?user=patricio.lopez&password=l30nr@c!ng&api_id=3412175&from=13475234779&mo=1&to=569".$request->getParameter("numero")."&text=".$token;
 	$ch= curl_init();
 	curl_setopt($ch,CURLOPT_URL,$url);
 	curl_exec($ch);
@@ -50,6 +77,63 @@ class profileActions extends sfActions {
 	
 	
      }
+
+    public function executeExtenderReservaAjax(sfWebRequest $request){
+        
+        $id = $request ->getPostParameter('id');
+        $fechaHasta = $request ->getPostParameter('fechaHasta');
+        $horaHasta = $request ->getPostParameter('horaHasta');
+
+        //$fechaHasta = '28-03-2013';
+        //$horaHasta = '15:30:00';
+        //$id = '605';
+
+        //otros campos se obtienen de la reserva anterior
+        $reserveAnterior = Doctrine_Core::getTable('reserve')->findOneById($id);
+        $dateAnterior = $reserveAnterior->getDate();
+        $duracionAnterior = $reserveAnterior->getDuration();
+        $userId = $reserveAnterior->getUserId();
+        $carId = $reserveAnterior->getCarId();
+
+        //calcular date y duration
+        $date = strtotime($dateAnterior);
+        $date = $date+($duracionAnterior*60*60);
+
+        //formatea la fechaHasta
+        $fechaHasta = explode('-', $fechaHasta);
+        $fechaHasta = $fechaHasta[2]."-".$fechaHasta[1]."-".$fechaHasta[0];
+        $fechaHasta = strtotime($fechaHasta." ".$horaHasta);
+
+        $duracion = ($fechaHasta-$date)/3600;
+
+        $date = date("Y-m-d H:i:s",$date);
+        $fechaHasta = date("Y-m-d H:i:s",$fechaHasta);
+        //echo $date." ".$fechaHasta;
+
+        //calcula el precio (obtiene el precio completo de las 2 reservas y le quita el precio de la reserva original)
+        $car = Doctrine_Core::getTable('car')->findOneById($carId);
+        $valorHora = $car -> getPricePerHour();
+        $valorDia = $car -> getPricePerDay();
+        $precioCompleto = $this -> calcularMontoTotal($duracionAnterior+$duracion, $valorHora, $valorDia);
+        $precioNuevo = $this -> calcularMontoTotal($duracion, $valorHora, $valorDia);
+        //echo $duracionAnterior." ".$duracion."<br>";
+        //echo $precioCompleto." ".$precioNuevo;
+
+        //almacena la extensin de la reserva
+        $reserve = new Reserve();
+        $reserve->setDate($date);
+        $reserve->setDuration($duracion);
+        $reserve->setUserId($userId);
+        $reserve->setCarId($carId);
+        $reserve->setPrice($precioNuevo);
+        $reserve->setIdPadre($id);
+        $reserve->setComentario('Reserva extendida');
+        $reserve->setFechaReserva(strftime("%Y%m%d%H%M%S"));
+        $reserve->save();
+
+        die();
+        
+    }
      
     public function executeEditarFechaPedidosAjax(sfWebRequest $request){
         
@@ -102,12 +186,16 @@ class profileActions extends sfActions {
         $idReserve = $request ->getPostParameter('idReserve');
         $accion = $request ->getPostParameter('accion');
 
+        //$accion = 'preaprobar';
+        //$idReserve = 661;
+
         $reserve = Doctrine_Core::getTable('reserve')->findOneById($idReserve);
 
         if($accion == 'preaprobar'){
             //echo "pre aprobar";
             $reserve->setConfirmed(1);
             $reserve->setCanceled(0);
+            $reserve->setFechaConfirmacion(strftime("%Y%m%d%H%M%S"));
         }else if($accion == 'rechazar'){
             //echo "rechazar";
             $reserve->setConfirmed(0);
@@ -116,11 +204,31 @@ class profileActions extends sfActions {
 
         $reserve->save();
 
+        //obtiene fecha inicio, fecha termino, marca y modelo del auto
+        $fechaInicio = $reserve->getFechaInicio();
+        $horaInicio = $reserve->getHoraInicio();
+        $fechaTermino = $reserve->getFechaTermino();
+        $horaTermino = $reserve->getHoraTermino();
+        $marcaModelo = $reserve->getMarcaModelo();
+        $correo = $reserve->getEmailRenter();
+
         if($accion == 'preaprobar'){
             //crea la fila en la tabla transaction
             $this->executeConfirmReserve($idReserve);
+
+            //enva mail de preaprobacin al arrendatario
+            $body = "La reserva del vehculo $marcaModelo con fecha $fechaInicio $horaInicio hasta $fechaTermino $horaTermino ha sido pre-aprobada por su propietario. Debe proceder a pagarla.";
+        }else if($accion == 'rechazar'){
+            //enva mail de rechazo al arrendatario
+            $body = "La reserva del vehculo $marcaModelo con fecha $fechaInicio $horaInicio hasta $fechaTermino $horaTermino ha sido rechazada por su propietario. Recuerda que puedes realizar multiples reservas a distintos vehculos para asegurar una aprobacin";
         }
 
+        require sfConfig::get('sf_app_lib_dir')."/mail/mail.php";
+        $mail = new Email();
+        $mail->setBody($body);
+        $mail->setTo($correo);
+        echo $mail->submit();
+
         die();
     }
 
@@ -148,9 +256,37 @@ class profileActions extends sfActions {
         }
 
         $reserve->save();
+
+        //enva correo a arrendatario, si es arrendatario no enva correo
+        $idRenter = $reserve->getUserId();
+
+
+        $fechaInicio = $reserve->getFechaInicio();
+        $horaInicio = $reserve->getHoraInicio();
+        $fechaTermino = $reserve->getFechaTermino();
+        $horaTermino = $reserve->getHoraTermino();
+        $marcaModelo = $reserve->getMarcaModelo();
+
+        if($idRenter!=$idUsuario){
+            $correo = $reserve->getEmailRenter();
+
+            $body = "La reserva del vehculo $marcaModelo con fecha $fechaInicio $horaInicio hasta $fechaTermino $horaTermino ha sido rechazada por su propietario. Recuerda que puedes realizar multiples reservas a distintos vehculos para asegurar una aprobacin.";
+
+        }else{
+            $correo = $reserve->getEmailOwner();
+
+            $body = "La reserva del vehculo $marcaModelo con fecha $fechaInicio $horaInicio hasta $fechaTermino $horaTermino ha sido rechazada por el arrendatario.";
+        }
+
+        require sfConfig::get('sf_app_lib_dir')."/mail/mail.php";
+        $mail = new Email();
+        $mail->setBody($body);
+        $mail->setTo($correo);
+        $mail->submit();
         
         echo $idReserve;
         die();
+        
     }
 
     public function executeFormularioEntregaAjax(sfWebRequest $request){
@@ -1087,9 +1223,16 @@ class profileActions extends sfActions {
         $this->cantidadTransacciones = $claseUsuario->getCantidadTransacciones();
         
         //obtiene los comentarios (texto, nombre, fecha, fotoPerfil)
-        $this->comentarios = $claseUsuario->getMyComments_aboutMe();
-        
+        $misComentarios = $claseUsuario->getMyComments_aboutMe();
+        $comentariosOrd = array();
+        for($y=0;$y<count($misComentarios);$y++){ //Ordeno del mas actual, al mas antiguo
+            $comentariosOrd[$y] = $misComentarios[(count($misComentarios)-1)-$y];
+        }
+        $this->comentarios = $comentariosOrd;
 
+        //autos columna derecha
+        //$user = Doctrine_Core::getTable('user')->find(array($publicUserId));
+        $this->carsPublicProfile = $this->user->getCars();
     }
 
     public function executeEdit(sfWebRequest $request) {
@@ -1156,8 +1299,8 @@ class profileActions extends sfActions {
         $to = $request->getParameter('dateto');
         $carid = $request->getParameter('id');
 
-		$reserve_id = '';
-		if( $request->getParameter('reserve_id') ) $reserve_id = $request->getParameter('reserve_id');
+        $reserve_id = '';
+        if( $request->getParameter('reserve_id') ) $reserve_id = $request->getParameter('reserve_id');
 
         $hourdesde = $request->getParameter('hour_from');
         $hourhasta = $request->getParameter('hour_to');
@@ -1165,7 +1308,7 @@ class profileActions extends sfActions {
         if (preg_match('/^\d{1,2}\-\d{1,2}\-\d{4}$/', $from) && preg_match('/^\d{1,2}\-\d{1,2}\-\d{4}$/', $to)) {
 
 
-			try {
+            try {
 //CORROBORAR SI SE SOLICITO ANTES PERO TIENE DURACION DURANTE EL PEDIDO
 
             $startDate = date("Y-m-d H:i:s", strtotime($from . ' ' . $hourdesde));
@@ -1215,13 +1358,13 @@ class profileActions extends sfActions {
                 }
                 //echo count($reservasEnEspera);
                 //die;
-				*/	
-				
+                */  
+                
 
                 if (count($has_reserve) == 0) {
 
-                    if (count($reservasEnEspera) < 5) {
-                    	
+                    //if (count($reservasEnEspera) < 5) {
+                        
                         $reserve = new Reserve();
                         $reserve->setDuration($duration);
                         $reserve->setDate($startDate);
@@ -1232,55 +1375,60 @@ class profileActions extends sfActions {
                         $reserve->setCar($car);
 
                         if ($car->getUser()->getAutoconfirm()) {
-                        	
+                            
                             $reserve->setConfirmed(true);
                         }
-						
-						//Formato para Chile Ej: 10000.00
-						$reserve->setPrice( number_format( $this->calcularMontoTotal($duration, $car->getPricePerHour(), $car->getPricePerDay()) , 2, '.', '') );
-						
-						if($reserve_id) $reserve->setExtend($reserve_id);
-						
-                        $reserve->save();
+                        
+                        //Formato para Chile Ej: 10000.00
+                        $reserve->setPrice( number_format( $this->calcularMontoTotal($duration, $car->getPricePerHour(), $car->getPricePerDay()) , 2, '.', '') );
+                        
+                        //if($reserve_id) $reserve->setExtend($reserve_id);
+                        
+                        $reserve->setFechaReserva(strftime("%Y%m%d%H%M%S"));
 
-                        if ($car->getUser()->getAutoconfirm()) {
-                        	
-                            $this->sendConfirmEmail($reserve);
-                        } else {
-                        	
-                            $this->sendReserveEmail($reserve);
-                        }
+                        $reserve->save();
 
-                        if ($car->getUser()->getAutoconfirm()) {
-                        	
-                            $this->forward('profile', 'reserveConfirmed');
-                        } else {
-                        	
-                            $this->redirect('profile/reserveSend');
-                        }
-						
+                        //enva correo al propietario del auto
+                        $fechaInicio = $reserve->getFechaInicio();
+                        $horaInicio = $reserve->getHoraInicio();
+                        $fechaTermino = $reserve->getFechaTermino();
+                        $horaTermino = $reserve->getHoraTermino();
+                        $marcaModelo = $reserve->getMarcaModelo();
+                        $correo = $reserve->getEmailOwner();
+
+                        $body = "Su vehculo $marcaModelo quiere ser reservado con fecha $fechaInicio $horaInicio hasta $fechaTermino $horaTermino. Ingrese a la seccin de \"reserva\" en nuestro sitio web www.arriendas.cl para continuar con la reserva.";
+
+                        require sfConfig::get('sf_app_lib_dir')."/mail/mail.php";
+                        $mail = new Email();
+                        $mail->setBody($body);
+                        $mail->setTo($correo);
+                        $mail->submit();
+                            
+                        $this->redirect('profile/reserveSend');
+                    /*
                     } else {
-                    	
+                        
                         $this->getUser()->setFlash('msg', 'Ya tienes 5 reservas en espera de confirmacin para este perodo');
-						$this->forward('profile', 'reserve');
+                        $this->forward('profile', 'reserve');
                     }
+                    */
                 }
-				
+                
                 $this->getUser()->setFlash('msg', 'Ya hay una reserva confirmada para ese horario');
                 $this->getRequest()->setParameter('carid', $carid);
-				$this->getRequest()->setParameter('idreserve', $reserve_id);
-				
+                $this->getRequest()->setParameter('idreserve', $reserve_id);
+                
             } else {
-            	
+                
                 $this->getUser()->setFlash('msg', 'Fecha de entrega debe ser mayor a fecha inicial');
             }
-			
-			$this->forward('profile', 'reserve');
-			
-			} catch(Exception $e) { die($e); }
-			
+            
+            $this->forward('profile', 'reserve');
+            
+            } catch(Exception $e) { die($e); }
+            
         } else {
-        	
+            
             $this->redirect('profile/reserve?id=' . $request->getParameter('id'));
         }
     }
@@ -1590,7 +1738,7 @@ class profileActions extends sfActions {
 
     public function executeTransactions(sfWebRequest $request) {
         $idUsuario = sfContext::getInstance()->getUser()->getAttribute('userid');
-        $idUsuario = 885;
+        //$idUsuario = 885;
 
         $transaction = Doctrine_Core::getTable("Transaction")->findByUserId($idUsuario);
 
@@ -2205,6 +2353,13 @@ public function executeAgreePdf2(sfWebRequest $request)
             }
         }
 
+        /*
+        foreach ($reservasRealizadasAux as $reserva) {
+            echo $reserva['idReserve']." ".$reserva['estado']."<br>";
+        }
+        die();
+        */
+        
         $this->fechaReservasRealizadas = $fechaReservasRealizadas;
         $this->reservasRealizadas = $reservasRealizadasAux;
         $this->reservasRecibidas = $reservasRecibidasAux;
@@ -2269,6 +2424,7 @@ public function executeAgreePdf2(sfWebRequest $request)
         $this->brand = Doctrine_Core::getTable('Brand')->createQuery('a')->execute();
 
         $this->comunas = Doctrine_Core::getTable('Comunas')->createQuery('a')->execute();
+	$this->getResponse()->setHttpHeader('Access-Control-Allow-Origin', 'http://maps.googleapis.com/');
     }
 
     public function executeAddAvailability(sfWebRequest $request) {
@@ -2754,7 +2910,7 @@ public function executeAgreePdf2(sfWebRequest $request)
             $transaction->setReserve($reserve);
             $transaction->setCompleted(false);
             $transaction->save();
-        } else {
+        } /*else {
 
             $q = Doctrine_Query::create()
                     ->update('Transaction t')
@@ -2786,6 +2942,7 @@ public function executeAgreePdf2(sfWebRequest $request)
         }
 
         //$this->redirect('profile/pedidos');
+        */
     }
 
     public function executeCompleteReserve(sfWebRequest $request) {
diff --git a/apps/frontend/modules/profile/config/security.yml b/apps/frontend/modules/profile/config/security.yml
index f83124e..bcd0392 100755
--- a/apps/frontend/modules/profile/config/security.yml
+++ b/apps/frontend/modules/profile/config/security.yml
@@ -1,5 +1,3 @@
-publicprofile:
-  is_secure: false
 myReserves:
   is_secure: false
 confirmReserve:
diff --git a/apps/frontend/modules/profile/main/actions/actions.class.php b/apps/frontend/modules/profile/main/actions/actions.class.php
index 1c05bc3..1e8db2e 100755
--- a/apps/frontend/modules/profile/main/actions/actions.class.php
+++ b/apps/frontend/modules/profile/main/actions/actions.class.php
@@ -1258,7 +1258,7 @@ El equipo de Arriendas.cl
 	                $this->getUser()->setAuthenticated(true);
 	                $this->getUser()->setAttribute("logged", true);
 	                $this->getUser()->setAttribute("userid", $user->getId());
-	                $this->getUser()->setAttribute("name", $user->getFirstName() . " " . substr($user->getLastName(), 0, 1) . '.');
+	                $this->getUser()->setAttribute("name", current(explode(' ' , $user->getFirstName())) . " " . substr($user->getLastName(), 0, 1) . '.');
 	                $this->getUser()->setAttribute("picture_url", $user->getFileName());
 			//Modificacion para identificar si el usuario es propietario o no de vehiculo
 			if($user->isPropietario()) {
@@ -1648,7 +1648,7 @@ Con tu '.htmlentities($brand).' '.htmlentities($model).' del '.$year.' puedes ga
                 $this->getUser()->setAuthenticated(true);
                 $this->getUser()->setAttribute("logged", true);
                 $this->getUser()->setAttribute("userid", $userdb->getId());
-                $this->getUser()->setAttribute("name", $userdb->getFirstName() . " " . substr($userdb->getLastName(), 0, 1) . '.');
+                $this->getUser()->setAttribute("name", current(explode(' ' , $userdb->getFirstName())) . " " . substr($userdb->getLastName(), 0, 1) . '.');
                 $this->getUser()->setAttribute("picture_url", $userdb->getPictureFile());
                 $this->getUser()->setAttribute("fb", true);	
 		//Modificacion para identificar si el usuario es propietario o no de vehiculo
diff --git a/apps/frontend/modules/profile/main/actions/actions.class.php.new.php b/apps/frontend/modules/profile/main/actions/actions.class.php.new.php
index 49fc1cf..a860724 100755
--- a/apps/frontend/modules/profile/main/actions/actions.class.php.new.php
+++ b/apps/frontend/modules/profile/main/actions/actions.class.php.new.php
@@ -1217,7 +1217,7 @@ El equipo de Arriendas.cl
 	                $this->getUser()->setAuthenticated(true);
 	                $this->getUser()->setAttribute("logged", true);
 	                $this->getUser()->setAttribute("userid", $user->getId());
-	                $this->getUser()->setAttribute("name", $user->getFirstName() . " " . substr($user->getLastName(), 0, 1) . '.');
+	                $this->getUser()->setAttribute("name", current(explode(' ' , $user->getFirstName())) . " " . substr($user->getLastName(), 0, 1) . '.');
 	                $this->getUser()->setAttribute("picture_url", $user->getFileName());
 	
 	                if ($this->getUser()->getAttribute('lastview') != null) {
@@ -1613,7 +1613,7 @@ Con tu '.htmlentities($brand).' '.htmlentities($model).' del '.$year.' puedes ga
                 $this->getUser()->setAuthenticated(true);
                 $this->getUser()->setAttribute("logged", true);
                 $this->getUser()->setAttribute("userid", $userdb->getId());
-                $this->getUser()->setAttribute("name", $userdb->getFirstName() . " " . substr($userdb->getLastName(), 0, 1) . '.');
+                $this->getUser()->setAttribute("name", current(explode(' ' , $userdb->getFirstName())) . " " . substr($userdb->getLastName(), 0, 1) . '.');
                 $this->getUser()->setAttribute("picture_url", $userdb->getPictureFile());
                 $this->getUser()->setAttribute("fb", true);
                 $this->getUser()->setAttribute('geolocalizacion', true);
diff --git a/apps/frontend/modules/profile/main/config/layout.php b/apps/frontend/modules/profile/main/config/layout.php
index 32902d7..773fbcb 100755
--- a/apps/frontend/modules/profile/main/config/layout.php
+++ b/apps/frontend/modules/profile/main/config/layout.php
@@ -220,8 +220,8 @@
                         ?>" title="Sube tu Auto">
                                     <span>Sube tu Auto</span></a></li>
                                     
-							<li><a href="<?php echo url_for('profile/rental') ?>" class="item_5<?php
-							if (inModuleAndAction("profile", "rental")) {
+							<li><a href="<?php echo url_for('profile/pedidos') ?>" class="item_5<?php
+							if (inModuleAndAction("profile", "pedidos")) {
 								echo "_in";
 							}
  							?>" title="Reservas de mis Autos"><span>Reservas de mis Autos</span></a></li>                                    
@@ -264,7 +264,7 @@
                         <ul class="enlaces_box">
                             <li class="enlaces_titulo">Acciones</li>
                             <li><a href="<?php echo url_for('profile/addCar') ?>" title="Sube tu auto">Sube tu auto</a></li>
-                            <li><a href="<?php echo url_for('profile/rental') ?>" title="Busca un auto">Busca un auto</a></li>
+                            <li><a href="<?php echo url_for('profile/pedidos') ?>" title="Busca un auto">Busca un auto</a></li>
                         </ul>
 
                     </div><!-- footer_enlaces -->
diff --git a/apps/frontend/modules/profile/templates/_autos.php b/apps/frontend/modules/profile/templates/_autos.php
index 8039761..e54394c 100755
--- a/apps/frontend/modules/profile/templates/_autos.php
+++ b/apps/frontend/modules/profile/templates/_autos.php
@@ -1,4 +1,6 @@
 <?php
+if(strpos(sfContext::getInstance()->getRouting()->getCurrentInternalUri(), 'publicprofile') == false){
+
 if(count($cars)>0){
 ?>
 
@@ -17,5 +19,28 @@ if(count($cars)>0){
 </div>
 
 <?php
-}//cierre if
+}//cierre count
+}else{//pgina publicProfile
+
+	if(count($cars)>0){
+	?>
+
+	<div class="main_col_right">
+	<div class="barraSuperior"><p>AUTOS <?php echo strtoupper($userPublicProfile->getFirstname())." (".count($cars).")"; ?></p></div>
+
+	<?php 
+		foreach ($carsPublicProfile as $c){
+			echo "<div class=marcoFoto>";
+			echo "<a href='".url_for('cars/car?id='.$c->getId())."' title='Ver ficha de auto'>";
+			echo image_tag($c->getFoto(),array("width"=>"140px","height"=>"140px","class"=>"foto"));
+			echo "</a></div>";
+		}
+	?>
+
+	</div>
+
+	<?php
+	}//cierre count
+	
+}
 ?>
\ No newline at end of file
diff --git a/apps/frontend/modules/profile/templates/_colDer.php b/apps/frontend/modules/profile/templates/_colDer.php
index 689f2b0..4047a27 100755
--- a/apps/frontend/modules/profile/templates/_colDer.php
+++ b/apps/frontend/modules/profile/templates/_colDer.php
@@ -1,6 +1,6 @@
 <div id="colDer">
-	<!--
+	
 	<?php include_component('profile', 'preguntasFrecuentes') ?>
-	-->
+	
     <?php include_component('profile', 'autos') ?>
 </div>
\ No newline at end of file
diff --git a/apps/frontend/modules/profile/templates/_preguntasFrecuentes.php b/apps/frontend/modules/profile/templates/_preguntasFrecuentes.php
index bf44a09..52368cd 100755
--- a/apps/frontend/modules/profile/templates/_preguntasFrecuentes.php
+++ b/apps/frontend/modules/profile/templates/_preguntasFrecuentes.php
@@ -1,4 +1,144 @@
 
+
+<!-- PEDIDOS -->
+<?php
+	if(strpos(sfContext::getInstance()->getRouting()->getCurrentInternalUri(), 'pedidos') == true){
+?>
+<div class="main_col_right">
+<div class="barraSuperior"><p>PREGUNTAS FRECUENTES</p></div>
+
+<div class="pregunta primera">
+	<p><a href="https://arriendascl.zendesk.com/entries/23073011--Qu%C3%A9-pasa-si-el-veh%C3%ADculo-presenta-fallas-permanentes-cuando-lo-est%C3%A9-utilizando-" target="_blank">Qu pasa si el vehculo presenta fallas permanentes cuando lo est utilizando?</a></p>
+</div>
+<div class="pregunta">
+	<p><a href="https://arriendascl.zendesk.com/entries/23095428--Puedo-ver-el-auto-f%C3%ADsicamente-antes-de-reservarlo-" target="_blank">Puedo ver el auto fsicamente antes de reservarlo?</a></p>
+</div>
+<div class="pregunta">
+	<p><a href="https://arriendascl.zendesk.com/entries/23073301--De-qu%C3%A9-forma-se-incluye-el-sistema-TAG-" target="_blank">De qu forma se incluye el sistema TAG?</a></p>
+</div>
+<div class="pregunta">
+	<p><a href="https://arriendascl.zendesk.com/entries/23085767--Cu%C3%A1les-son-las-condiciones-para-recibir-un-GPS-gratuito-" target="_blank">Cules son las condiciones para recibir un GPS gratuito?</a></p>
+</div>
+<div class="pregunta ultima">
+	<p><a href="https://arriendascl.zendesk.com/entries/23070612--Me-hacen-una-devoluci%C3%B3n-de-dinero-si-ocupo-menos-tiempo-horas-d%C3%ADas-el-veh%C3%ADculo-que-arrende-" target="_blank">Me hacen una devolucin de dinero si ocupo menos tiempo (horas/das) el vehculo que arrende?</a></p>
+</div>
+
+</div>
+<?php
+	}
+?>
+
+<!-- MENSAJES -->
+<?php
+	if(strpos(sfContext::getInstance()->getRouting()->getCurrentInternalUri(), 'inbox') == true){
+?>
 <div class="main_col_right">
 <div class="barraSuperior"><p>PREGUNTAS FRECUENTES</p></div>
-</div>
\ No newline at end of file
+
+<div class="pregunta primera">
+	<p><a href="https://arriendascl.zendesk.com/entries/23087683--A-partir-de-qu%C3%A9-momento-recibo-los-datos-del-contacto-del-due%C3%B1o-del-veh%C3%ADculo-" target="_blank">A partir de qu momento recibo los datos del contacto del dueo del vehculo?</a></p>
+</div>
+<div class="pregunta ultima">
+	<p><a href="https://arriendascl.zendesk.com/entries/23087773--Las-notificaciones-de-solicitud-de-arriendo-y-las-aprobaciones-de-un-arriendo-ser%C3%A1n-enviadas-v%C3%ADa-ma" target="_blank">Las notificaciones de solicitud de arriendo y las aprobaciones de un arriendo sern enviadas va mail?</a></p>
+</div>
+
+</div>
+<?php
+	}
+?>
+
+<!-- CALIFICACIONES -->
+<?php
+	if(strpos(sfContext::getInstance()->getRouting()->getCurrentInternalUri(), 'calificaciones') == true){
+?>
+<div class="main_col_right">
+<div class="barraSuperior"><p>PREGUNTAS FRECUENTES</p></div>
+
+<div class="pregunta primera">
+	<p><a href="https://arriendascl.zendesk.com/entries/23087833--C%C3%B3mo-califico-el-veh%C3%ADculo-que-tuve-en-arriendo-" target="_blank">Cmo califico el vehculo que tuve en arriendo?</a></p>
+</div>
+<div class="pregunta ultima">
+	<p><a href="https://arriendascl.zendesk.com/entries/23088217--Debo-calificar-la-forma-en-que-funciono-el-veh%C3%ADculo-" target="_blank">Debo calificar la forma en que funciono el vehculo?</a></p>
+</div>
+
+</div>
+<?php
+	}
+?>
+
+<!-- TRANSACCIONES -->
+<?php
+	if(strpos(sfContext::getInstance()->getRouting()->getCurrentInternalUri(), 'transactions') == true){
+?>
+<div class="main_col_right">
+<div class="barraSuperior"><p>PREGUNTAS FRECUENTES</p></div>
+
+<div class="pregunta primera">
+	<p><a href="https://arriendascl.zendesk.com/entries/23090006--Puedo-pagar-en-efectivo-" target="_blank">Puedo pagar en efectivo?</a></p>
+</div>
+<div class="pregunta ultima">
+	<p><a href="https://arriendascl.zendesk.com/entries/23074121--C%C3%B3mo-compruebo-que-el-pago-fue-efectuado-" target="_blank">Cmo compruebo que el pago fue efectuado?</a></p>
+</div>
+
+</div>
+<?php
+	}
+?>
+
+<!-- REGSTRATE 
+<?php
+	if(strpos(sfContext::getInstance()->getRouting()->getCurrentInternalUri(), 'pedidos') == true){
+?>
+<div class="main_col_right">
+<div class="barraSuperior"><p>PREGUNTAS FRECUENTES</p></div>
+
+<div class="pregunta primera">
+	<p><a href="https://arriendascl.zendesk.com/entries/23073011--Qu%C3%A9-pasa-si-el-veh%C3%ADculo-presenta-fallas-permanentes-cuando-lo-est%C3%A9-utilizando-" target="_blank">Qu pasa si el vehculo presenta fallas permanentes cuando lo est utilizando?</a></p>
+</div>
+<div class="pregunta">
+	<p><a href="https://arriendascl.zendesk.com/entries/23095428--Puedo-ver-el-auto-f%C3%ADsicamente-antes-de-reservarlo-" target="_blank">Puedo ver el auto fsicamente antes de reservarlo?</a></p>
+</div>
+<div class="pregunta">
+	<p><a href="https://arriendascl.zendesk.com/entries/23073301--De-qu%C3%A9-forma-se-incluye-el-sistema-TAG-" target="_blank">De qu forma se incluye el sistema TAG?</a></p>
+</div>
+<div class="pregunta">
+	<p><a href="https://arriendascl.zendesk.com/entries/23085767--Cu%C3%A1les-son-las-condiciones-para-recibir-un-GPS-gratuito-" target="_blank">Cules son las condiciones para recibir un GPS gratuito?</a></p>
+</div>
+<div class="pregunta ultima">
+	<p><a href="https://arriendascl.zendesk.com/entries/23070612--Me-hacen-una-devoluci%C3%B3n-de-dinero-si-ocupo-menos-tiempo-horas-d%C3%ADas-el-veh%C3%ADculo-que-arrende-" target="_blank">Me hacen una devolucin de dinero si ocupo menos tiempo (horas/das) el vehculo que arrende?</a></p>
+</div>
+
+</div>
+<?php
+	}
+?>
+-->
+
+<!-- VERIFICACIN -->
+<?php
+	if(strpos(sfContext::getInstance()->getRouting()->getCurrentInternalUri(), 'aseguraTuAuto') == true){
+?>
+<div class="main_col_right">
+<div class="barraSuperior"><p>PREGUNTAS FRECUENTES</p></div>
+
+<div class="pregunta primera">
+	<p><a href="https://arriendascl.zendesk.com/entries/23073011--Qu%C3%A9-pasa-si-el-veh%C3%ADculo-presenta-fallas-permanentes-cuando-lo-est%C3%A9-utilizando-" target="_blank">Qu pasa si el vehculo presenta fallas permanentes cuando lo est utilizando?</a></p>
+</div>
+<div class="pregunta">
+	<p><a href="https://arriendascl.zendesk.com/entries/23095428--Puedo-ver-el-auto-f%C3%ADsicamente-antes-de-reservarlo-" target="_blank">Puedo ver el auto fsicamente antes de reservarlo?</a></p>
+</div>
+<div class="pregunta">
+	<p><a href="https://arriendascl.zendesk.com/entries/23073301--De-qu%C3%A9-forma-se-incluye-el-sistema-TAG-" target="_blank">De qu forma se incluye el sistema TAG?</a></p>
+</div>
+<div class="pregunta">
+	<p><a href="https://arriendascl.zendesk.com/entries/23085767--Cu%C3%A1les-son-las-condiciones-para-recibir-un-GPS-gratuito-" target="_blank">Cules son las condiciones para recibir un GPS gratuito?</a></p>
+</div>
+<div class="pregunta ultima">
+	<p><a href="https://arriendascl.zendesk.com/entries/23070612--Me-hacen-una-devoluci%C3%B3n-de-dinero-si-ocupo-menos-tiempo-horas-d%C3%ADas-el-veh%C3%ADculo-que-arrende-" target="_blank">Me hacen una devolucin de dinero si ocupo menos tiempo (horas/das) el vehculo que arrende?</a></p>
+</div>
+
+</div>
+<?php
+	}
+?>
+
diff --git a/apps/frontend/modules/profile/templates/_tabsmenu.php b/apps/frontend/modules/profile/templates/_tabsmenu.php
index 5fad0e8..00459ad 100755
--- a/apps/frontend/modules/profile/templates/_tabsmenu.php
+++ b/apps/frontend/modules/profile/templates/_tabsmenu.php
@@ -27,7 +27,7 @@
 	  <ul>
 		<li><a href="<?php echo url_for('profile/index') ?>">Perfil</a></li>
 		<li><a href="<?php echo url_for('profile/rentings') ?>">Los Que Alquile</a></li>
-		<li><a href="<?php echo url_for('profile/rental') ?>">Mis Alquilados</a></li>
+		<li><a href="<?php echo url_for('profile/pedidos') ?>">Mis Alquilados</a></li>
 		<li><a href="<?php echo url_for('profile/cars') ?>">Mis Autos</a></li>
 		<li><a href="<?php echo url_for('profile/messages') ?>">Mensajes</a></li>
 		<li><a href="<?php echo url_for('profile/ratings') ?>">Calificaciones</a></li>
diff --git a/apps/frontend/modules/profile/templates/carsSuccess.php b/apps/frontend/modules/profile/templates/carsSuccess.php
index c43188d..7122534 100755
--- a/apps/frontend/modules/profile/templates/carsSuccess.php
+++ b/apps/frontend/modules/profile/templates/carsSuccess.php
@@ -1,10 +1,13 @@
 
 <?php use_stylesheet('calendario.css') ?>
+<?php use_stylesheet('comunes.css') ?>
 <?php use_stylesheet('mis_autos.css') ?>
 <?php use_stylesheet('registro.css') ?>
+<?php use_javascript('cars.js') ?>
 
-
-
+<script type="text/javascript">
+    var urlEliminarCarAjax = <?php echo "'".url_for("profile/eliminarCarAjax")."';" ?>
+</script>
 
 <div class="main_box_1">
 <div class="main_box_2">
@@ -28,28 +31,25 @@
 
 <div class="misautos_box">
 
-<?php foreach ($cars as $c): ?>
+<?php 
+	foreach ($cars as $c): 
+		if($c->getActivo()){
+?>
 	
 	<!-- auto_publicado -->
-	<div class="misautos_user_item">
+	<div class="misautos_user_item" id="item_<?php echo $c->getId() ?>">
 	    
 	<div class="misautos_user_post">
 	<div class="misautos_marca">
 		<a href="<?php echo url_for('profile/addCar?id=' . $c->getId() )?>" ><span><?=$c->getModel()->getBrand()->getName()?> <?=$c->getModel()->getName()?></span></a>
 	</div><!-- misautos_marca -->
 	
-	<!--
-	<p class="misautos_info">Kilometraje: <b><?=$c->getKm()?> km</b></p>
-	-->
 	
 	<div class="misautos_btn_sector">
 	   <!-- <a href="#" class="misautos_btn_disp"></a>
 	   -->
-	    <a href="<?php echo url_for('profile/rental') ?>" class="misautos_btn_alqui">Mis Arriendos</a>
-	    <!--
-	    <a href="#" class="misautos_btn_denun"></a>
-	      -->
-	    <!-- Se imprime el botn Verificar -->
+	    <a href="<?php echo url_for('profile/pedidos') ?>" class="misautos_btn_alqui">Mis Arriendos</a>
+	    
 	    <?php
 	    	//Obtener variable $ok del Auto, rescatandolo de la DB, por mientras se usar de variable
 		    //$ok = 0;
@@ -70,24 +70,29 @@
 	    ?>
 	</div><!-- misautos_btn_sector -->
 	
-	
+	<div class='cargando'><?php echo image_tag('../images/ajax-loader.gif', 'class=img_cargando'); ?></div>
+
 	<div class="misautos_user_item_flecha"></div>
 	</div><!-- misautos_user_post -->
 	
 	<div class="misautos_user_frame">
 	
 	<a href="<?php echo url_for('profile/addCar?id=' . $c->getId() )?>" >
-	
-	<?php echo image_tag($c->getFoto(),array("width"=>"84px","height"=>"84px")); ?>
+		<?php echo image_tag($c->getFoto(),array("width"=>"84px","height"=>"84px")); ?>
 	</a>
 
+	<p class='textoEliminar'><a href="#" class='eliminar' id="<?php echo $c->getId() ?>">(Eliminar)</a></p>
+
 	</div>
 	
 	<div class="clear"></div>
 	</div><!-- auto_publicado -->
 
 
-<?php endforeach; ?>  
+<?php
+}//end if 
+endforeach; 
+?>  
     
 </div><!-- misautos_box -->
 
diff --git a/apps/frontend/modules/profile/templates/confirmarSMSSuccess.php b/apps/frontend/modules/profile/templates/confirmarSMSSuccess.php
old mode 100644
new mode 100755
index 134a8cc..a166354
--- a/apps/frontend/modules/profile/templates/confirmarSMSSuccess.php
+++ b/apps/frontend/modules/profile/templates/confirmarSMSSuccess.php
@@ -5,7 +5,7 @@
         $("#ingresoCodigo").show();
         $.ajax({
         type: "GET",
-        url: "<?php echo url_for("profile/enviarConfirmacionSMS"); ?>",
+        url: "<?php echo url_for("profile/enviarConfirmacionSMS")."?numero="; ?>" + $("#fono_ingresado").html(),
         });
     }
         
diff --git a/apps/frontend/modules/profile/templates/detalleReservaSuccess.php b/apps/frontend/modules/profile/templates/detalleReservaSuccess.php
index 0f02322..e42f787 100755
--- a/apps/frontend/modules/profile/templates/detalleReservaSuccess.php
+++ b/apps/frontend/modules/profile/templates/detalleReservaSuccess.php
@@ -162,7 +162,7 @@
                         </div>
                     </div><!-- auto -->
                     <div class="vertodos">
-                        <a href="<?=url_for("profile/rental")?>">Ver todos</a>
+                        <a href="<?=url_for("profile/pedidos")?>">Ver todos</a>
                     </div>
                 <?php endforeach; ?> 
             <?php else: ?>
diff --git a/apps/frontend/modules/profile/templates/indexSuccess.php b/apps/frontend/modules/profile/templates/indexSuccess.php
index 0a3caeb..579910e 100755
--- a/apps/frontend/modules/profile/templates/indexSuccess.php
+++ b/apps/frontend/modules/profile/templates/indexSuccess.php
@@ -163,7 +163,7 @@
                                     <div class="misautos_btn_sector">
                                         <!-- <a href="#" class="misautos_btn_disp"></a>
                                         -->
-                                        <a href="<?php echo url_for('profile/rental') ?>" class="misautos_btn_alqui">Mis Arriendos</a>
+                                        <a href="<?php echo url_for('profile/pedidos') ?>" class="misautos_btn_alqui">Mis Arriendos</a>
                                         <!--
                                         <a href="#" class="misautos_btn_denun"></a>
                                         -->
diff --git a/apps/frontend/modules/profile/templates/modificarArriendoSuccess.php b/apps/frontend/modules/profile/templates/modificarArriendoSuccess.php
index 6335c8d..cda153b 100755
--- a/apps/frontend/modules/profile/templates/modificarArriendoSuccess.php
+++ b/apps/frontend/modules/profile/templates/modificarArriendoSuccess.php
@@ -95,7 +95,7 @@
             success: function(data){
                 if(data == '0'){
                     alert('Su reserva ha sido modificada exitosamente');
-                    var url = <?php echo "'" . url_for('profile/rental') . "'"; ?>;
+                    var url = <?php echo "'" . url_for('profile/pedidos') . "'"; ?>;
                     location.href = url;
                 } else {
                     alert(data);
@@ -156,7 +156,7 @@
                     </div>
                 </div><!-- auto -->
                 <div class="vertodos">
-                    <a href="<?= url_for("profile/rental") ?>">Ver todos</a>
+                    <a href="<?= url_for("profile/pedidos") ?>">Ver todos</a>
                 </div>
             <?php else: ?>
                 <?php echo '<p class="mensaje_alerta">No tienes arriendos</p>'; ?>
diff --git a/apps/frontend/modules/profile/templates/pedidosSuccess.php b/apps/frontend/modules/profile/templates/pedidosSuccess.php
index 234da5d..e16d6a0 100755
--- a/apps/frontend/modules/profile/templates/pedidosSuccess.php
+++ b/apps/frontend/modules/profile/templates/pedidosSuccess.php
@@ -10,6 +10,8 @@
     var urlCambiarEstadoPedido = <?php echo "'".url_for("profile/cambiarEstadoPedidoAjax")."';" ?>
     var urlEditarFecha = <?php echo "'".url_for("profile/editarFechaPedidosAjax")."';" ?>
     var urlPedidos = <?php echo "'".url_for("profile/pedidos")."';" ?>
+    var urlPago = <?php echo "'".url_for("profile/payReserve")."';" ?>
+    var urlExtenderReserva = <?php echo "'".url_for("profile/extenderReservaAjax")."';" ?>
 </script>
 
 <div class="main_box_1">
@@ -21,10 +23,44 @@
         <!--  contenido de la seccion -->
         <div class="main_contenido">
 
-            <div class="barraSuperior">
-                <p>PEDIDOS REALIZADOS</p>
-            </div>
+            <?php
+
+            $mostrarReservasRealizadas = false;
+            $mostrarReservasRecibidas = false;
+            $mostrarBarra = false;
+
+            if($reservasRealizadas){
+                foreach ($reservasRealizadas as $reserva) {
+                    $mostrarReservasRealizadas = true;
+                }
+            }
+
+            if($reservasRecibidas){
+                foreach ($reservasRecibidas as $reserva) {
+                    $mostrarReservasRecibidas = true;
+                }
+            }
+
+            if(!$mostrarReservasRealizadas && !$mostrarReservasRecibidas){
+                echo "<div class='barraSuperior'><p>PEDIDOS</p></div>";
+            }else if($mostrarReservasRealizadas && !$mostrarReservasRecibidas){
+                echo "<div class='barraSuperior'><p>PEDIDOS REALIZADOS</p></div>";
+            }else if(!$mostrarReservasRealizadas && $mostrarReservasRecibidas){
+                echo "<div class='barraSuperior'><p>PEDIDOS RECIBIDOS</p></div>";
+            }else{
+                echo "<div class='barraSuperior'><p>PEDIDOS</p></div>";
+                $mostrarBarra = true;
+            }
 
+            ?>
+            <?php if($mostrarBarra){ ?>
+            <div class="barraNavegadora">
+                <div id="boton1" class='oscuro'>Pedidos Realizados</div>
+                <div id="intermedio" class='intOscCla'></div>
+                <div id="boton2" class='claro'>Pedidos Recibidos</div>
+            </div>
+            <?php } ?>
+            
             <div style="display:none">
                 <div id='confirmarEditarHora'>
                     <p>Desea editar la fecha y hora de todos los pedidos realizados para la fecha <span id='textoFecha'>seleccionada</span>?</p>
@@ -66,8 +102,30 @@
                     <input type="checkbox" name="contratoPropietario3" id="contratoPropietario3" class='checkboxContrato'><p> Si el arriendo es por menos de un da, el arrendatario me pagar en efectivo la bencina utilizada segn los kilmetros manejados. Si el arriendo es por un da o ms, el arrendatario me devolver el auto con el marcador de bencina en el mismo nivel con el que lo se lo entregu.</p>
                 </div>
 
+                <div id='extender'>
+                    <p>La extensin de la reserva queda condicional a la aprobacin del propietario del vehculo, en ningn caso reemplaza la reserva original ni permite la devolucin del dinero pagado.</p>
+                    <div class='izq'>
+                        <p class='titulo'>Desde</p>
+                        <p><label>Fecha</label>
+                        <input id="datefrom_extender" name="datefrom_extender" type="text" readonly="readonly" value=""/></p>
+                        <p><label>Hora</label>
+                        <input readonly="readonly" type="text" id="hour_from_extender" name="hour_from_extender" readonly="readonly" value=""/></p>
+                    </div>
+
+                    <div class='der'>
+                        <p class='titulo'>Hasta</p>
+                        <p><label>Fecha</label>
+                        <input id="dateto_extender" name="dateto_extender" type="text" class="datepicker" readonly="readonly" value="Da de entrega"/></p>
+                        <p><label>Hora</label>
+                        <input readonly="readonly" type="text" id="hour_to_extender" name="hour_to_extender" value="Hora de entrega"/></p>
+                    </div>
+                </div>
+
             </div>
     
+            <?php if($mostrarBarra){ ?>
+            <div id="conten_opcion1">
+            <?php } ?>
 
             <?php
             $mostrar = false;
@@ -120,10 +178,10 @@
                                 echo "<div class='img'>".image_tag('img_pedidos/IconoAutoAprobado.png')."</div>";
                                 echo "<span class='textoColor'>APROBADO!</span>";
                             echo "</div>";
-                            echo "<a href='http://admin.arriendas.cl/api.php/contrato/generarContrato/idReserva/".$reserva['idReserve']."' class='descargarContrato'>Descargar Contratos</a>";
+                            echo "<a href='#' id='contrato_".$reserva['idReserve']."_".$reserva['carId']."' class='descargarContrato'>Descargar Contratos</a>";
                         echo "</div>";
                         echo "<div class='pago'>";
-                            echo "<a href=''>".image_tag('img_pedidos/BotonExtender.png','class=boton_extender')."</a>";
+                            echo "<a href='#' id='extender_".$reserva['idReserve']."' class='boton_extender ".$reserva['fechaInicio']."_".$reserva['horaInicio']."_".$reserva['fechaTermino']."_".$reserva['horaTermino']."'>".image_tag('img_pedidos/BotonExtender.png')."</a>";
                         echo "</div>";
                     echo "</div>";
                 }
@@ -135,8 +193,8 @@
                 echo"</div>";
                 echo "<div class='mensajeContacto'><p>Si necesita modificar su reserva pagada, escr&iacutebanos a <i>soporte@arriendas.cl</i></p></div>";
             }else{
-                echo "<h3>APROBADOS (PAGADO)</h3>";
-                echo "<p class='alerta'>No registra pedidos aprobados</p>";
+                //echo "<h3>APROBADOS (PAGADO)</h3>";
+                //echo "<p class='alerta'>No registra pedidos aprobados</p>";
             }
 
             
@@ -206,8 +264,8 @@
             echo"</div>";
 
             }else{
-                echo "<h3>PRE APROBADOS (PENDIENTE DE PAGO)</h3>";
-                echo "<p class='alerta'>No registra resultados";
+                //echo "<h3>PRE APROBADOS (PENDIENTE DE PAGO)</h3>";
+                //echo "<p class='alerta'>No registra resultados";
             }
             
 
@@ -289,7 +347,7 @@
                             echo"</div>";
                         }
                     }
-                    echo "<div class='masArriendos'><a href='".url_for('profile/pedidos')."'>".image_tag('MasAgregar.png','class=img_masArriendos')." Agrega m&aacute;s reservas</a></div>";
+                    echo "<div class='masArriendos'>".image_tag('MasAgregar.png','class=img_masArriendos')." Agrega m&aacute;s reservas</div>";
                     ?>
                     <!-- fin contenido del acorden -->
                 </div>
@@ -310,16 +368,22 @@
                 echo"</div>";
                 */
             }else{
-                echo "<h3>EN ESPERA</h3>";
-                echo "<p class='alerta' style='margin-bottom: 30px;'>No registra pedidos en espera de confirmaci&oacute;n";
+                //echo "<h3>EN ESPERA</h3>";
+                //echo "<p class='alerta' style='margin-bottom: 30px;'>No registra pedidos en espera de confirmaci&oacute;n";
             }
             
+            ?>
+
+            <?php if($mostrarBarra){ ?>
+            </div>
+            <div id="conten_opcion2">
+            <?php } ?>
+
+            <?php
             
             //PROPIETARIO
-            echo "<div class='barraSuperior barraBaja'>
-                <p>PEDIDOS RECIBIDOS</p>
-            </div>";
-            //echo "<p class='tiutlo'>PEDIDOS RECIBIDOS</p>";
+            //muestra la barra de pedidos recibidos solo si tiene algn pedido que mostrar
+            
 
             $mostrar = false;
 
@@ -373,7 +437,7 @@
                             echo "<div class='der'>";
                                 echo "<div class='cargando'>".image_tag('../images/ajax-loader.gif')."</div>";
                                 echo "<div class='img'>".image_tag('img_pedidos/IconoAutoAprobado.png')."</div>";
-                                echo "<span class='textoColor'>APROBADO!</span><br><a href=''>Extender</a>";
+                                echo "<span class='textoColor'>APROBADO!</span>";
                             echo "</div>";
                         echo "</div>";
                         echo "<div class='precioPagados'>";
@@ -389,8 +453,8 @@
             echo"</div>";
 
             }else{
-                echo "<h3>APROBADO (PAGADO)</h3>";
-                echo "<p class='alerta'>No registra pedidos pagados";
+                //echo "<h3>APROBADO (PAGADO)</h3>";
+                //echo "<p class='alerta'>No registra pedidos pagados";
             }
             
             $mostrar = false;
@@ -467,8 +531,8 @@
             echo"</div>";
 
             }else{
-                echo "<h3>PRE APROBADOS (PENDIENTE DE PAGO)</h3>";
-                echo "<p class='alerta'>No registra pedidos pre aprobados";
+                //echo "<h3>PRE APROBADOS (PENDIENTE DE PAGO)</h3>";
+                //echo "<p class='alerta'>No registra pedidos pre aprobados";
             }
 
             //---------------------------------BLOQUE  EN ESPERA-----------
@@ -601,12 +665,17 @@
             echo"</div>";
 
             }else{
-                echo "<h3>EN ESPERA</h3>";
-                echo "<p class='alerta'>No registra pedidos en espera de confirmaci&oacute;n";
+                //echo "<h3>EN ESPERA</h3>";
+                //echo "<p class='alerta'>No registra pedidos en espera de confirmaci&oacute;n";
             }
 
             ?>
 
+            <?php if($mostrarBarra){ ?>
+            </div>
+            <?php } ?>
+
+
         </div><!-- main_contenido -->
 
         <?php include_component('profile', 'colDer') ?>  
@@ -614,9 +683,3 @@
         <div class="clear"></div>
     </div><!-- main_box_2 -->
 </div>
-
-<!--
-    Agrega ms reservas
-    letra rosado oscuro
-    fondo rosado claro
--->
\ No newline at end of file
diff --git a/apps/frontend/modules/profile/templates/publicprofileSuccess.php b/apps/frontend/modules/profile/templates/publicprofileSuccess.php
index c3a7799..46591e1 100755
--- a/apps/frontend/modules/profile/templates/publicprofileSuccess.php
+++ b/apps/frontend/modules/profile/templates/publicprofileSuccess.php
@@ -8,7 +8,6 @@
 
 <?php include_component('profile', 'profile') ?>
 
-
 <div class="main_contenido">
 
     <div class="barraSuperior">
@@ -20,7 +19,7 @@
 
     </div><!-- usuario_foto_frame -->
 
-    <div id="iconoEnviarMensaje"><a href="<?php echo url_for('messages/new?id='.$user->getId()) ?>" title="Enviar mensaje a <?php echo $user->getFirstname().' '.$user->getLastname(); ?>"><?php echo image_tag('img_evaluaciones/IconoEnviarMensaje.png','class=img_iconoEnviarMensaje') ?></a></div>
+    <div id="iconoEnviarMensaje"><a href="<?php echo url_for('messages/new?id='.$user->getId()) ?>" title="Enviar mensaje a <?php echo $user->getFirstname().' '.$user->getLastname(); ?>"><?php echo image_tag('img_msj/EnviarMsjSombra.png','class=img_iconoEnviarMensaje') ?></a></div>
 
     <div id="datosPerfil">
 
@@ -29,7 +28,7 @@
         
         <div id="lineaNTransacciones"><?php echo image_tag('img_evaluaciones/IconoNumeroTransacciones.png','class=nTransacciones') ?><p><span>N. Transacciones | </span><?php echo $cantidadTransacciones; ?></p></div>
         
-        <div id="lineaTiempoDemora"><?php echo image_tag('img_evaluaciones/IconoTiempoDemora.png','class=velocidadRespuesta') ?><p><span>Velocidad de repuesta | </span><?php echo $velocidadRespuesta ?></p></div>
+        <div id="lineaTiempoDemora"><?php echo image_tag('img_evaluaciones/IconoTiempoDemora.png','class=velocidadRespuesta') ?><p><span>Velocidad de repuesta | </span><?=$velocidadRespuesta;?></p></div>
 
     </div>
     <div id="evaluacionesPublicProfile">
@@ -173,10 +172,10 @@
 
 <div id="colDer">
 <?php include_component('profile', 'publico', array('user' => $user, 'verificacionAutos' => $verificacionAutos, 'telefonoConfirmado' => $telefonoConfirmado, 'telefono' => $telefono, 'facebookConfirmado' => $facebookConfirmado, 'emailConfirmado' => $emailConfirmado, 'email' => $email));?>
-<?php include_component('profile', 'autos') ?>
-<!--
-<?php include_component('profile', 'preguntasFrecuentes') ?>
--->
+<?php include_component('profile', 'autos', array('carsPublicProfile' => $carsPublicProfile, 'userPublicProfile' => $user)); ?>
+
+<?php //include_component('profile', 'preguntasFrecuentes') ?>
+
 </div>
 </div><!-- main_box_2 -->
 </div><!-- main_box_1 -->
\ No newline at end of file
diff --git a/apps/frontend/modules/profile/templates/transactionsSuccess.php b/apps/frontend/modules/profile/templates/transactionsSuccess.php
index 062d6d3..c7bb54a 100755
--- a/apps/frontend/modules/profile/templates/transactionsSuccess.php
+++ b/apps/frontend/modules/profile/templates/transactionsSuccess.php
@@ -1,5 +1,6 @@
 <?php use_stylesheet('transacciones.css') ?>
 <?php use_stylesheet('registro.css') ?>
+<?php use_stylesheet('comunes.css') ?>
 <?php use_stylesheet('calendario.css') ?>
 
 
diff --git a/apps/frontend/templates/layout.php b/apps/frontend/templates/layout.php
old mode 100644
new mode 100755
index 05d8fe1..b30944b
--- a/apps/frontend/templates/layout.php
+++ b/apps/frontend/templates/layout.php
@@ -24,6 +24,7 @@
                         e.preventDefault();
                         $(".invitar_amigos").fadeOut("slow");
                     });
+                    $(".invitar_amigos").delay(5000).fadeIn("slow");
 				});
 			</script>
 			
@@ -131,7 +132,7 @@
             ?>
 
             
-           <div class="invitar_amigos">
+           <div class="invitar_amigos" style="display:none;">
                     <div class="fondo_invitar"> 
                         <a href="#" title="Cerrar" class="enlaceCerrarInvitar"><div class="cerrarInvitar"></div></a>
                         <a href="<?php echo url_for('main/referidos')?>" title="Invita a tus amigos" class="enlaceInvitar"><div class="botonInvitar"></div></a>
@@ -166,7 +167,7 @@
                                 <div class="LadoDer">
                                     <div class="group_name">                               
                                     	<div class="hola"></div><br/>
-                                    <span class="name_user"><?php echo $sf_user->getAttribute('name') ?></span>
+                                    <span class="name_user"><?php echo ucwords($sf_user->getAttribute('name')) ?></span>
                                     </div>
                                     <a class="link_logout">
                                         <?php echo image_tag('Home/FlechaDespliega.png', 'id=logout') ?>
diff --git a/apps/frontend/templates/profile.php b/apps/frontend/templates/profile.php
old mode 100644
new mode 100755
index 801e143..5c4461c
--- a/apps/frontend/templates/profile.php
+++ b/apps/frontend/templates/profile.php
@@ -129,7 +129,7 @@
                                 <div class="LadoDer">
                                     <div class="group_name">                               
                                 	<div class="hola"></div><br/>
-                                    <span class="name_user"><?php echo $sf_user->getAttribute('name') ?></span>
+                                    <span class="name_user"><?php echo ucwords($sf_user->getAttribute('name')) ?></span>
                                     </div>
                                     <a class="link_logout">
                                         <?php echo image_tag('Home/FlechaDespliega.png', 'id=logout') ?>
diff --git a/cache/frontend/prod/config/config_app.yml.php b/cache/frontend/prod/config/config_app.yml.php
old mode 100644
new mode 100755
diff --git a/cache/frontend/prod/config/config_autoload.yml.php b/cache/frontend/prod/config/config_autoload.yml.php
old mode 100644
new mode 100755
diff --git a/cache/frontend/prod/config/config_config_handlers.yml.php b/cache/frontend/prod/config/config_config_handlers.yml.php
old mode 100644
new mode 100755
diff --git a/cache/frontend/prod/config/config_core_compile.yml.php b/cache/frontend/prod/config/config_core_compile.yml.php
old mode 100644
new mode 100755
diff --git a/cache/frontend/prod/config/config_databases.yml.php b/cache/frontend/prod/config/config_databases.yml.php
old mode 100644
new mode 100755
diff --git a/cache/frontend/prod/config/config_factories.yml.php b/cache/frontend/prod/config/config_factories.yml.php
old mode 100644
new mode 100755
diff --git a/cache/frontend/prod/config/config_routing.yml.php b/cache/frontend/prod/config/config_routing.yml.php
old mode 100644
new mode 100755
diff --git a/cache/frontend/prod/config/config_settings.yml.php b/cache/frontend/prod/config/config_settings.yml.php
old mode 100644
new mode 100755
diff --git a/cache/frontend/prod/config/modules_main_config_filters.yml.php b/cache/frontend/prod/config/modules_main_config_filters.yml.php
old mode 100644
new mode 100755
diff --git a/cache/frontend/prod/config/modules_main_config_module.yml.php b/cache/frontend/prod/config/modules_main_config_module.yml.php
old mode 100644
new mode 100755
diff --git a/cache/frontend/prod/config/modules_main_config_security.yml.php b/cache/frontend/prod/config/modules_main_config_security.yml.php
old mode 100644
new mode 100755
diff --git a/cache/frontend/prod/config/modules_main_config_view.yml.php b/cache/frontend/prod/config/modules_main_config_view.yml.php
old mode 100644
new mode 100755
diff --git a/config/doctrine/schema.yml b/config/doctrine/schema.yml
index 983671c..98dd4db 100755
--- a/config/doctrine/schema.yml
+++ b/config/doctrine/schema.yml
@@ -187,6 +187,10 @@ Car:
       type: string(255)
     accesorio2:
       type: string(255)
+    activo:
+      type: boolean
+      notnull: true
+      default: 1
   relations:
     User:
       class: User
@@ -718,6 +722,16 @@ Reserve:
         type: string(300)
         notnull: false
         default: null
+    id_padre:
+      type: integer(11)
+      notnull: false
+      default: null
+    fecha_reserva:
+      type: timestamp
+    fecha_confirmacion:
+      type: timestamp
+    fecha_pago:
+      type: timestamp
   relations:
     User:
       class: User
diff --git a/lib/model/doctrine/Reserve.class.php b/lib/model/doctrine/Reserve.class.php
index 5465ec5..be3bab3 100755
--- a/lib/model/doctrine/Reserve.class.php
+++ b/lib/model/doctrine/Reserve.class.php
@@ -151,4 +151,21 @@ class Reserve extends BaseReserve
 
 		return $duracion;
 	}
+
+	public function getMarcaModelo(){
+		$car = Doctrine_Core::getTable('car')->findOneById($this->getCarId());
+		return $car->getMarcaModelo();
+	}
+
+	public function getEmailRenter(){
+		$user = Doctrine_Core::getTable('user')->findOneById($this->getUserId());
+		return $user->getEmail();
+	}
+
+	public function getEmailOwner(){
+		$q = "SELECT u.email FROM user u, car c, reserve r WHERE u.id=c.user_id and c.id=r.car_id and r.id=".$this->getId();
+        $query = Doctrine_Query::create()->query($q);
+        $owner = $query->toArray();
+        return $owner[0]['email'];
+	}
 }
diff --git a/lib/model/doctrine/SecurityTokens.class.php b/lib/model/doctrine/SecurityTokens.class.php
old mode 100644
new mode 100755
diff --git a/lib/model/doctrine/User.class.php b/lib/model/doctrine/User.class.php
index f2bddac..0b27f19 100755
--- a/lib/model/doctrine/User.class.php
+++ b/lib/model/doctrine/User.class.php
@@ -112,7 +112,7 @@ class User extends BaseUser {
                 return "Error";
             }
         }else{
-            return "<span style='font-style: italic; color:#BCBEB0; font-weight: normal;'>No tiene mensajes</span>";
+            return "";
         }
     }//fin getVelocidadRespuesta_mensajes()
 
@@ -724,9 +724,9 @@ class User extends BaseUser {
 
 
 		if($tiempo == 1){
-			return utf8_encode($tiempo." da");
+			return $tiempo." da";
 		}else{
-			return utf8_encode($tiempo." das");
+			return $tiempo." das";
 		}
 
 	}
diff --git a/lib/model/doctrine/base/BaseCar.class.php b/lib/model/doctrine/base/BaseCar.class.php
index 7692a54..346aa07 100755
--- a/lib/model/doctrine/base/BaseCar.class.php
+++ b/lib/model/doctrine/base/BaseCar.class.php
@@ -340,6 +340,11 @@ abstract class BaseCar extends sfDoctrineRecord
              'type' => 'string',
              'length' => 255,
              ));
+        $this->hasColumn('activo', 'boolean', null, array(
+             'type' => 'boolean',
+             'notnull' => true,
+             'default' => 1,
+             ));
     
         $this->index('fk_Car_User', array(
              'fields' => 
diff --git a/lib/model/doctrine/base/BaseReserve.class.php b/lib/model/doctrine/base/BaseReserve.class.php
index 8404129..7a66239 100755
--- a/lib/model/doctrine/base/BaseReserve.class.php
+++ b/lib/model/doctrine/base/BaseReserve.class.php
@@ -61,7 +61,7 @@
  * @method Reserve             setEndKmConfirmed() Sets the current record's "end_km_confirmed" value
  * @method Reserve             setKminicial()   Sets the current record's "kminicial" value 
  * @method Reserve             setKmfinal()     Sets the current record's "kmfinal" value
- * @method Reserve     		   setPrice()       Sets the current record's "price" value
+ * @method Reserve             setPrice()       Sets the current record's "price" value
  * @method Integer             setExtend()      Sets the current record's "extend" value
 
  * 
@@ -211,6 +211,20 @@ abstract class BaseReserve extends sfDoctrineRecord
             'length' => 300,
             'default' => 'null',
         ));
+        $this->hasColumn('id_padre', 'integer', 11, array(
+             'type' => 'integer',
+             'length' => 11,
+             'default' => 'null',
+        ));
+        $this->hasColumn('fecha_reserva', 'timestamp', null, array(
+             'type' => 'timestamp',
+        ));
+        $this->hasColumn('fecha_confirmacion', 'timestamp', null, array(
+             'type' => 'timestamp',
+        ));
+        $this->hasColumn('fecha_pago', 'timestamp', null, array(
+             'type' => 'timestamp',
+        ));
 
         $this->index('fk_Reserve_User1', array(
              'fields' => 
diff --git a/lib/model/doctrine/base/BaseSecurityTokens.class.php b/lib/model/doctrine/base/BaseSecurityTokens.class.php
old mode 100644
new mode 100755
diff --git a/mail b/mail
old mode 100644
new mode 100755
diff --git a/web/.htaccess b/web/.htaccess
index 72b4f45..42807a4 100755
--- a/web/.htaccess
+++ b/web/.htaccess
@@ -8,7 +8,7 @@ Options +SymLinksIfOwnerMatch +ExecCGI
 
   # uncomment the following line, if you are having trouble
   # getting no_script_name to work
-  #RewriteBase /
+  RewriteBase /frontend/web/
 
   #RewriteRule ^images/(.*)$ http://arriendas.assets.s3-website-sa-east-1.amazonaws.com/images/$1 [L,R=301]
   #RewriteRule ^css/(.*)$ http://arriendas.assets.s3-website-sa-east-1.amazonaws.com/css/$1 [L,R=301]
diff --git a/web/.htaccess copia b/web/.htaccess copia
new file mode 100755
index 0000000..385eae2
--- /dev/null
+++ b/web/.htaccess copia	
@@ -0,0 +1,30 @@
+<IfModule mod_rewrite.c>
+  RewriteEngine On
+
+  # uncomment the following line, if you are having trouble
+  # getting no_script_name to work
+  #RewriteBase /
+
+  #RewriteRule ^images/(.*)$ http://arriendas.assets.s3-website-sa-east-1.amazonaws.com/images/$1 [L,R=301]
+  #RewriteRule ^css/(.*)$ http://arriendas.assets.s3-website-sa-east-1.amazonaws.com/css/$1 [L,R=301]
+  #RewriteRule ^js/(.*)$ http://arriendas.assets.s3-website-sa-east-1.amazonaws.com/js/$1 [L,R=301]
+  #RewriteRule ^json/(.*)$ http://arriendas.assets.s3-website-sa-east-1.amazonaws.com/json/$1 [L,R=301]
+
+  # we skip all files with .something
+  RewriteCond %{REQUEST_URI} \..+$
+  RewriteCond %{REQUEST_URI} !\.html$
+  RewriteRule .* - [L]
+
+  # we check if the .html version is here (caching)
+  RewriteRule ^$ index.html [QSA]
+  RewriteRule ^([^.]+)$ $1.html [QSA]
+  RewriteCond %{REQUEST_FILENAME} !-f
+
+  # no, so we redirect to our front web controller
+  RewriteRule ^(.*)$ index.php [QSA,L]
+</IfModule>
+AddOutputFilterByType DEFLATE text/css
+AddOutputFilterByType DEFLATE text/html
+<files *.js>
+SetOutputFilter DEFLATE
+</files>
\ No newline at end of file
diff --git a/web/.htaccess.swp b/web/.htaccess.swp
new file mode 100755
index 0000000..8f5a341
Binary files /dev/null and b/web/.htaccess.swp differ
diff --git a/web/css/calendario.css b/web/css/calendario.css
index d450715..c20a9af 100755
--- a/web/css/calendario.css
+++ b/web/css/calendario.css
@@ -1,5 +1,3 @@
-@import url("comunes.css");
-
 
 .calen_box_1 {
 	float: left;
diff --git a/web/css/comunes.css b/web/css/comunes.css
index 267bcb0..eb2a8ad 100755
--- a/web/css/comunes.css
+++ b/web/css/comunes.css
@@ -262,6 +262,33 @@ span.usuario_nombre {
 	margin-bottom: 35px;
 }
 
+.main_col_right .pregunta {
+    border-bottom: 1px solid #A4A4A4;
+    font-size: 12px;
+    font-weight: normal;
+    line-height: 17px;
+    margin-left: 10px;
+    margin-right: 10px;
+    padding-bottom: 15px;
+    padding-top: 15px;
+    text-align: left;
+    text-decoration: underline;
+    margin-top: 0;
+}
+
+.main_col_right .primera {
+    margin-top: -15px;
+}
+
+
+.main_col_right .ultima {
+    border-bottom: medium none;
+}
+
+.main_col_right .pregunta a{
+	color: black;
+}
+
 .box_menu_izq {
 	display:table;
 }
@@ -423,4 +450,44 @@ ul.list_der li a:visited {
 
 #verificaciones .noVinculo{
 	text-decoration: none;
+}
+
+@media screen and (max-width: 480px) {
+    .main_col_izq {
+	display: none;
+    }
+    .main_col_right {
+	display: none;
+    }
+    .colDer {
+	display:none;
+    }
+    .footer {
+	display: none;
+    }
+    
+    .main_contenido {
+	width: 100%;
+    }
+    .header_menu {
+	display: none;
+    }
+    .header {
+	width: 100%;
+    }
+    .mis_autos_marca {
+	font-size: large;
+    }
+    span {
+	font-size: large;
+    }
+    .header_logo {
+	display: none;
+    }
+    .header_image {
+	display: none;
+    }
+    .misautos_user_item {
+	width: 100%;
+    }
 }
\ No newline at end of file
diff --git a/web/css/conversaciones.css b/web/css/conversaciones.css
old mode 100644
new mode 100755
index c43afea..d1fdbe5
--- a/web/css/conversaciones.css
+++ b/web/css/conversaciones.css
@@ -287,7 +287,7 @@ textarea.textoMensaje{
 	background: url('../images/TrianguloMsjBlanco.png') no-repeat;
 	width: 24px;
 	height: 12px;
-	z-index: 100;
+	z-index: 1;
 	margin-top: 16px;
 	margin-left: 58px;
 }
@@ -296,7 +296,7 @@ textarea.textoMensaje{
 	background: url('../images/TrianguloMensajeCeleste.png') no-repeat;
 	width: 24px;
 	height: 12px;
-	z-index: 100;
+	z-index: 1;
 	margin-top: 16px;
 	margin-left: 398px;
 }
\ No newline at end of file
diff --git a/web/css/jquery.lightbox-0.5.css b/web/css/jquery.lightbox-0.5.css
index a7e3ff1..0900849 100755
--- a/web/css/jquery.lightbox-0.5.css
+++ b/web/css/jquery.lightbox-0.5.css
@@ -24,7 +24,7 @@
 	top: 0;
 	left: 0;
 	width: 100%;
-	z-index: 100;
+	z-index: 210;
 	text-align: center;
 	line-height: 0;
 }
@@ -102,7 +102,7 @@
 #gallery {
 	margin-top: 20px;
 	padding: 5px;
-	width: 189px;
+	width: 190px;
 	float: left;
 	margin-left: 20px;
 	-webkit-box-shadow: 0px 0px 9px rgba(50, 50, 50, 0.32);
diff --git a/web/css/main.css b/web/css/main.css
index d8b8fb9..3f9e9e7 100755
--- a/web/css/main.css
+++ b/web/css/main.css
@@ -81,12 +81,13 @@
 }  
 div.info_alert_menu{
     position: absolute;
-    width: 270px;
+    width: 230px;
     z-index: 5;
-    margin-left:-60px;
-    margin-top:31px;
-    border: 1px solid #ccc;
-    background-color: #CCCCCC;
+    margin-top: 25px;
+    background-color: white;
+    -webkit-box-shadow: 1px 1px 10px rgba(50, 50, 50, 0.4);
+    -moz-box-shadow: 1px 1px 10px rgba(50, 50, 50, 0.4);
+    box-shadow: 1px 1px 10px rgba(50, 50, 50, 0.4);
 }
 div.info_alert_menu div.alert_header{
     height: 34px;
@@ -124,14 +125,17 @@ div.info_alert_menu div.alert_footer a:hover {
 }  
 
 div.info_alert_menu div.alert_content .user_item:hover {
-    background-color: #4380BC;
+    background-color: #00AEEF;
 }  
 div.info_alert_menu div.alert_content .user_item {
     padding: 5px;
     cursor: pointer;
     border-bottom: 1px solid #efefef;
-    height: 45px;
-} 
+    height: 56px;
+}
+div#globe_menu div.alert_content div.user_item{
+    padding-left: 10px;
+}
 div.info_alert_menu div.alert_content .car_item{
     height: 62px;
 }
@@ -142,7 +146,6 @@ div.info_alert_menu div.alert_content .user_frame {
     width: 60px;
     height: 60px;
     float: left;
-    border: 1px solid #ccc;
     vertical-align: middle;
     text-align: center;
     margin-right: 5px;
@@ -158,21 +161,26 @@ div.info_alert_menu div.alert_content .user_post{
 }  
 div.info_alert_menu div.alert_content .user_nombre {
     font-size: 13px;
-    font-weight: bold;
     width: auto;
     text-decoration: none;
     color: #000;
     height: 15px;
+    margin-top: 7px;
 }
 div.alert_mess_unread {
-    background-color: #ccc;
+    background-color: #FFFBCC;
 }
 div.info_alert_menu div.alert_content .user_body{
     margin-top: 2px;
-    margin-bottom: 2px;
-    font-size:11px;
+    margin-bottom: 6px;
+    font-size: 13px;
+    font-weight: bold;
+    text-decoration: underline;
 }  
 div.info_alert_menu div.alert_content .user_fecha{
+    font-size: 10px;
+    color: #72726E;
+    font-style: italic;
 }  
 div.user_info ul.regis_validado li{
     float: none;
@@ -206,4 +214,13 @@ div.user_info ul.regis_validado li{
 .main_col_izq .btn_editar{
     display:none;
 }
-.terminosycondiciones { padding: 5px; }
\ No newline at end of file
+.terminosycondiciones { padding: 5px; }
+
+.puntaNotificacion{
+    width: 18px;
+    height: 15px;
+    position: absolute;
+    margin-left: 102px;
+    margin-top: -14px;
+    background-image: url("../images/TrianguloHomeLogIn.png");
+}
\ No newline at end of file
diff --git a/web/css/mis_arriendos.css b/web/css/mis_arriendos.css
index 365ec2f..7831aa5 100755
--- a/web/css/mis_arriendos.css
+++ b/web/css/mis_arriendos.css
@@ -352,25 +352,29 @@ h3 a{
     padding-top: 8px;
     text-align: center;
     width: 410px;
+    color: #EC008C;
+    font-weight: bold;
+    text-decoration: none;
+    font-size: 11px;
 }
 
 .img_masArriendos {
     vertical-align: -35%;
 }
 
-#editarHora .izq {
+#editarHora .izq, #extender .izq{
     float: left;
     width: 250px;
     text-align: center;
 }
 
-#editarHora .der {
+#editarHora .der, #extender .der {
     float: right;
     width: 250px;
     text-align: center;
 }
 
-#editarHora .titulo {
+#editarHora .titulo, #extender .titulo {
     color: #00AEEF;
     font-size: 15px;
     font-weight: bold;
@@ -379,16 +383,10 @@ h3 a{
     margin-top: 20px;
 }
 
-#editarHora p{
+#editarHora p, #extender p{
     margin-bottom: 20px;
 }
 
-.masArriendos a {
-    color: #EC008C;
-    font-weight: bold;
-    text-decoration: none;
-}
-
 #confirmarEditarHora p {
     font-size: 14px;
     margin-top: 10px;
@@ -437,4 +435,60 @@ h3 a{
 
 */
 div.time-picker{z-index: 1100;}
-.no-close .ui-dialog-titlebar-close {display: none }
\ No newline at end of file
+.no-close .ui-dialog-titlebar-close {display: none }
+
+
+/*################################## BARRA NAVEGADORA ###########################*/
+.barraNavegadora{
+    float: left;
+    width: 100%;
+    height: 30px;
+    border-bottom: 2px solid #BDBDBD;
+    margin-top: 20px;
+}
+
+#intermedio {
+    float: left;
+    height: 100%;
+    width: 36px
+}
+
+#boton1, #boton2 {
+    float: left;
+    font-size: 12px;
+    height: 100%;
+    padding-top: 10px;
+    width: 242px;
+    cursor: pointer;
+    text-align: center;
+}
+
+.claro {
+    background-image: url('../images/img_evaluaciones/pest_calificaciones/BarraClaraEvaluaciones.png');
+    background-repeat: repeat-x;
+}
+
+.oscuro {
+    background-image: url('../images/img_evaluaciones/pest_calificaciones/BarraEvaluaciones.png');
+    background-repeat: repeat-x;
+}
+
+
+.intOscCla{
+    background-image: url('../images/img_evaluaciones/pest_calificaciones/osc_cla.png');
+    background-repeat: no-repeat; 
+}
+
+.intClaOsc{
+    background-image: url('../images/img_evaluaciones/pest_calificaciones/cla_osc.png');
+    background-repeat: no-repeat;
+}
+
+.intOscOsc{
+    background-image: url('../images/img_evaluaciones/pest_calificaciones/osc_osc.png');
+    background-repeat: no-repeat;  
+}
+
+#conten_opcion2{
+    display: none;
+}
\ No newline at end of file
diff --git a/web/css/mis_autos.css b/web/css/mis_autos.css
index 8d00ca9..a1565a3 100755
--- a/web/css/mis_autos.css
+++ b/web/css/mis_autos.css
@@ -1,4 +1,3 @@
-@import url("comunes.css");
 
 h1.misautos_titulo_seccion {
 	float: left;
@@ -148,4 +147,20 @@ p.misautos_info {
 }
 .divBotonVerificar a.mis_autos_verificado:hover{
 	text-decoration:underline;
+}
+
+.textoEliminar{
+    font-size: 11px;
+    margin-top: 5px;
+    text-align: center;
+}
+
+.cargando{
+	float: right;
+	display: none;
+}
+
+.img_cargando{
+	width: 60px;
+	height: 60px;
 }
\ No newline at end of file
diff --git a/web/css/registro.css b/web/css/registro.css
index 8a1bcc1..ac08c19 100755
--- a/web/css/registro.css
+++ b/web/css/registro.css
@@ -93,15 +93,17 @@ ul.regis_validado li {
     padding-left: 22px;
 }
 ul.notif_validado li {
-    background-image: url("http://www.arriendas.cl/images/img_registro/regis_ico_sinverif.png");
-    background-color:#EDEDED;
+    background-image: url("../images/CruzFaltaHomeLogIn.png");
+    background-color: white;
     background-position: left center;
     background-repeat: no-repeat;
     border-bottom: 1px solid #EFEFEF;
     height: 22px;
     line-height: 16px;
+    margin-left: 8px;
+    width: 200px;
+    padding-top: 6px;
     padding-left: 22px;
-    width: 248px;
 }
 
 
diff --git a/web/css/search.css b/web/css/search.css
index 72683f4..89654b3 100755
--- a/web/css/search.css
+++ b/web/css/search.css
@@ -280,14 +280,15 @@ a.returncar_btn_detalle span {
 input.buton_more_options{
 	margin: 0px;
 	border: 0px;
-	padding: 0px;
+	padding: 5px;
 	cursor: pointer;
-	position: absolute;
+	float: right;
 	background-image: url('../images/Home/AgregarFiltros.png');
-    background-repeat: repeat-x;
-    width: 20px;
-    height: 20px;
-    margin-left: 620px;
+	background-repeat: repeat-x;
+	width: 20px;
+	height: 20px;
+	z-index: 20;
+	margin-right: 15px;
 	margin-top: 10px;
 }
 
@@ -357,6 +358,14 @@ ul.search_arecomend_info li.search_arecomend_marca a {
 .txt_buscador span {
 	font-weight:normal;font-size:12px;font-style:italic;
 }
+.search_box_1_title{
+	width: 610px;
+	font-family: Arial, Helvetica, sans-serif;
+	color: #fff;
+	font-size: 13px;
+	margin-top: 1px;
+	position: relative;
+}
 .search_box_1_header {
 	width: 650px;
 	font-family: Arial, Helvetica, sans-serif;
@@ -365,7 +374,7 @@ ul.search_arecomend_info li.search_arecomend_marca a {
 	margin-top: 1px;
 	position: relative;
 }
-.search_box_1_header h2 {
+.search_box_1_header h2, .search_box_1_title h2 {
 	margin-left: 20px;
 	padding-top: 8px;
 }
@@ -642,8 +651,8 @@ a.mapcar_btn_detalle span {
 a.mapcar_user_message{
 	float: left;
 	width: 24px;
-	height: 24px;
-	background-image: url('../images/Home/mail_24.png');
+	height: 22px;
+	background-image: url('../images/img_msj/EnviarMsjSinSombraChico.png');
 	margin-left: 10px;
 	margin-top: -3px;
 }
diff --git a/web/css/style_ui.css b/web/css/style_ui.css
index 72b12b5..a11118f 100755
--- a/web/css/style_ui.css
+++ b/web/css/style_ui.css
@@ -532,7 +532,8 @@ ul.footer_social li.footer_tw {
 }
 ul.notif_validado li a{
     display: inline;
-    color: #05a4e7;
+    color: black;
+    text-decoration: underline;
 }
 ul.notif_validado li a:hover {
     display: inline;
diff --git a/web/error b/web/error
old mode 100644
new mode 100755
diff --git a/web/error500.html b/web/error500.html
old mode 100644
new mode 100755
diff --git a/web/errors/error500.php b/web/errors/error500.php
old mode 100644
new mode 100755
diff --git a/web/images/BotonEnviar.png b/web/images/BotonEnviar.png
old mode 100644
new mode 100755
diff --git a/web/images/BotonVolverBandejaEntrada.png b/web/images/BotonVolverBandejaEntrada.png
old mode 100644
new mode 100755
diff --git a/web/images/CruzFaltaHomeLogIn.png b/web/images/CruzFaltaHomeLogIn.png
new file mode 100755
index 0000000..d84ac2f
Binary files /dev/null and b/web/images/CruzFaltaHomeLogIn.png differ
diff --git a/web/images/Flecha.png b/web/images/Flecha.png
old mode 100644
new mode 100755
diff --git a/web/images/Home/AgregarFiltros.png b/web/images/Home/AgregarFiltros.png
old mode 100644
new mode 100755
diff --git a/web/images/Home/Barra.png b/web/images/Home/Barra.png
old mode 100644
new mode 100755
diff --git a/web/images/Home/BotonCerrar.png b/web/images/Home/BotonCerrar.png
old mode 100644
new mode 100755
diff --git a/web/images/Home/BotonDescarga.png b/web/images/Home/BotonDescarga.png
old mode 100644
new mode 100755
diff --git a/web/images/Home/BotonIngresa.png b/web/images/Home/BotonIngresa.png
old mode 100644
new mode 100755
diff --git a/web/images/Home/BotonInvitar.png b/web/images/Home/BotonInvitar.png
old mode 100644
new mode 100755
diff --git a/web/images/Home/BotonReservarHome.png b/web/images/Home/BotonReservarHome.png
old mode 100644
new mode 100755
diff --git a/web/images/Home/FlechaDespliega.png b/web/images/Home/FlechaDespliega.png
old mode 100644
new mode 100755
diff --git a/web/images/Home/FondoHeader.png b/web/images/Home/FondoHeader.png
old mode 100644
new mode 100755
diff --git a/web/images/Home/FondoHeader2.png b/web/images/Home/FondoHeader2.png
old mode 100644
new mode 100755
diff --git a/web/images/Home/Header.png b/web/images/Home/Header.png
old mode 100644
new mode 100755
diff --git a/web/images/Home/HolaHomeLogIn.png b/web/images/Home/HolaHomeLogIn.png
old mode 100644
new mode 100755
diff --git a/web/images/Home/IInvitaAmigos.png b/web/images/Home/IInvitaAmigos.png
old mode 100644
new mode 100755
diff --git a/web/images/Home/IconoNumeroTransacciones.png b/web/images/Home/IconoNumeroTransacciones.png
old mode 100644
new mode 100755
diff --git a/web/images/Home/IconoPuntualidad.png b/web/images/Home/IconoPuntualidad.png
old mode 100644
new mode 100755
diff --git a/web/images/Home/IndicadorMapa.png b/web/images/Home/IndicadorMapa.png
old mode 100644
new mode 100755
diff --git a/web/images/Home/InteriorPastillaHomeLogIn.png b/web/images/Home/InteriorPastillaHomeLogIn.png
old mode 100644
new mode 100755
diff --git a/web/images/Home/LineaHeader.png b/web/images/Home/LineaHeader.png
old mode 100644
new mode 100755
diff --git a/web/images/Home/LineaMenuBlanca.png b/web/images/Home/LineaMenuBlanca.png
old mode 100644
new mode 100755
diff --git a/web/images/Home/LineaMenuHeader.png b/web/images/Home/LineaMenuHeader.png
old mode 100644
new mode 100755
diff --git a/web/images/Home/LogIn.png b/web/images/Home/LogIn.png
old mode 100644
new mode 100755
diff --git a/web/images/Home/Medalla.png b/web/images/Home/Medalla.png
old mode 100644
new mode 100755
diff --git a/web/images/Home/PorcentajeDeAprobacion.png b/web/images/Home/PorcentajeDeAprobacion.png
old mode 100644
new mode 100755
diff --git a/web/images/Home/VelocidadDeRespuesta.png b/web/images/Home/VelocidadDeRespuesta.png
old mode 100644
new mode 100755
diff --git a/web/images/Home/mail_24.png b/web/images/Home/mail_24.png
old mode 100644
new mode 100755
diff --git a/web/images/IconoMiembroDesde.png b/web/images/IconoMiembroDesde.png
old mode 100644
new mode 100755
diff --git a/web/images/IconoTiempoDemora.png b/web/images/IconoTiempoDemora.png
old mode 100644
new mode 100755
diff --git a/web/images/MasAgregar.png b/web/images/MasAgregar.png
old mode 100644
new mode 100755
diff --git a/web/images/Medalla.png b/web/images/Medalla.png
old mode 100644
new mode 100755
diff --git a/web/images/TrianguloBlancoMensajes.png b/web/images/TrianguloBlancoMensajes.png
old mode 100644
new mode 100755
diff --git a/web/images/TrianguloCelesteMensajes.png b/web/images/TrianguloCelesteMensajes.png
old mode 100644
new mode 100755
diff --git a/web/images/TrianguloHomeLogIn.png b/web/images/TrianguloHomeLogIn.png
new file mode 100755
index 0000000..dd20a72
Binary files /dev/null and b/web/images/TrianguloHomeLogIn.png differ
diff --git a/web/images/TrianguloMensajeCeleste.png b/web/images/TrianguloMensajeCeleste.png
old mode 100644
new mode 100755
diff --git a/web/images/TrianguloMsjBlanco.png b/web/images/TrianguloMsjBlanco.png
old mode 100644
new mode 100755
diff --git a/web/images/favicon.ico b/web/images/favicon.ico
old mode 100644
new mode 100755
diff --git a/web/images/img_msj/EnviarMsjChico.png b/web/images/img_msj/EnviarMsjChico.png
new file mode 100755
index 0000000..38fc8b0
Binary files /dev/null and b/web/images/img_msj/EnviarMsjChico.png differ
diff --git a/web/images/img_msj/EnviarMsjSinSombra.png b/web/images/img_msj/EnviarMsjSinSombra.png
new file mode 100755
index 0000000..e004f24
Binary files /dev/null and b/web/images/img_msj/EnviarMsjSinSombra.png differ
diff --git a/web/images/img_msj/EnviarMsjSinSombraChico.png b/web/images/img_msj/EnviarMsjSinSombraChico.png
new file mode 100755
index 0000000..b115c04
Binary files /dev/null and b/web/images/img_msj/EnviarMsjSinSombraChico.png differ
diff --git a/web/images/img_msj/EnviarMsjSombra.png b/web/images/img_msj/EnviarMsjSombra.png
new file mode 100755
index 0000000..4466d71
Binary files /dev/null and b/web/images/img_msj/EnviarMsjSombra.png differ
diff --git a/web/images/img_pedidos/BotonExtender.png b/web/images/img_pedidos/BotonExtender.png
old mode 100644
new mode 100755
diff --git a/web/images/img_pedidos/Telefono.png b/web/images/img_pedidos/Telefono.png
old mode 100644
new mode 100755
diff --git a/web/images/puntaNotificacion.png b/web/images/puntaNotificacion.png
new file mode 100755
index 0000000..d5f66a9
Binary files /dev/null and b/web/images/puntaNotificacion.png differ
diff --git a/web/js/cars.js b/web/js/cars.js
new file mode 100644
index 0000000..c929112
--- /dev/null
+++ b/web/js/cars.js
@@ -0,0 +1,34 @@
+$(document).on('ready',function(){
+
+
+	$('.eliminar').on('click',function(e){
+		e.preventDefault();
+
+		if(confirm('Desea eliminar el vehculo seleccionado?')){
+			var id = $(this).attr('id');
+			eliminarAuto(id);
+		}
+		
+	});
+
+});
+
+function eliminarAuto(id){
+
+	$('#item_'+id+' .cargando').show();
+
+	$.ajax({
+		type:'post',
+		url: urlEliminarCarAjax,
+		data:{
+			idCar:id
+		}
+	}).done(function(){
+		$('#item_'+id).hide();
+		$('#item_'+id+' .cargando').hide();
+	}).fail(function(){
+		alert('Ha ocurrido un error al eliminar el vehculo, intntelo nuevamente');
+		$('#item_'+id+' .cargando').hide();
+	});
+
+}
\ No newline at end of file
diff --git a/web/js/form_PublicaTuAuto.js b/web/js/form_PublicaTuAuto.js
index 45555e8..7047f54 100755
--- a/web/js/form_PublicaTuAuto.js
+++ b/web/js/form_PublicaTuAuto.js
@@ -187,13 +187,17 @@ $(document).on('ready',function(){
 
 			var urlDireccion = 'http://maps.googleapis.com/maps/api/geocode/json?address='+direccion+' '+comuna+' chile&sensor=false';
 			//alert(urlDireccion);
+			alert(urlDireccion);
 
 			$.ajax({  
 	            dataType: 'json',  
-	            url: urlDireccion,  
+	            url: urlDireccion,
 	            cache: false,  
 	            success: function(data){
+	            	alert('entro2');
 	            	if(data.status=='OK'){
+	            		alert('bien');
+
 	            		var lat = data.results[0].geometry.location.lat;
 	            		var lng = data.results[0].geometry.location.lng;
 
@@ -207,6 +211,8 @@ $(document).on('ready',function(){
 		                $("#confirmacionUbicacion").dialog("open");
 
 	            	}else{
+	            		alert('mal');
+
 	            		//alert('error');
 		                $("#errorUbicacion").dialog("open");
 
diff --git a/web/js/jquery.accordion.min.js b/web/js/jquery.accordion.min.js
old mode 100644
new mode 100755
diff --git a/web/js/pedidos.js b/web/js/pedidos.js
index 7119fbd..2510d61 100755
--- a/web/js/pedidos.js
+++ b/web/js/pedidos.js
@@ -86,7 +86,8 @@ $(document).on('ready',function(){
 	            	//confirmar que se aprueben los contratos
 	            	if(contratosSeleccionados('Arrendatario')){
 	            		//redirecciona
-						window.location.href = 'http://www.arriendas.cl/bcpuntopagos?id='+idReserve;
+						window.location.href = urlPago+'/id/'+idReserve;
+						//alert(urlPago);
 
 		            	//limpiar checkbox
 		            	limpiarContratos('Arrendatario');
@@ -173,6 +174,14 @@ $(document).on('ready',function(){
     
     $("#hour_from , #hour_to").timePicker();
 
+    $('#dateto_extender').datepicker({
+        dateFormat: 'dd-mm-yy',
+        buttonImageOnly: true,
+        minDate:'-0d'
+    });
+
+    $('#hour_to_extender').timePicker();
+
 
 	var ejecutarAcordeon = true;
 
@@ -522,6 +531,170 @@ $(document).on('ready',function(){
 		$('#mapa').dialog('open');
 	});
 
+	$('.descargarContrato').on('click',function(event){
+		event.preventDefault();
+
+		var contrato_id = $(this).attr('id');
+
+		contrato_id = contrato_id.split('_');
+
+		idReserve = contrato_id[1];
+		idCar = contrato_id[2];
+
+		var urlContrato1 = 'http://admin.arriendas.cl/api.php/contrato/generarContrato/idReserva/';
+		var urlContrato2 = 'http://www.arriendas.cl/main/generarFormularioEntregaDevolucion/idReserve/';
+		var urlContrato3 = 'http://www.arriendas.cl/main/generarReporte/idAuto/';
+		window.open(urlContrato1+idReserve);
+		window.open(urlContrato2+idReserve);
+		window.open(urlContrato3+idCar);
+	});
+
+	////////////////////////
+	// BARRA NAVEGADORA
+	var estado1 = '';
+	var estado2 = '';
+
+	$('#boton1').on('hover',function(){
+		//si tiene la clase clara, la quita y pone una oscura
+
+		if(estado1 != ''){
+
+			if(estado1 == 'claro'){
+				$(this).removeClass('oscuro');
+				$(this).addClass('claro');
+
+				$('#intermedio').removeClass('intOscOsc');
+				$('#intermedio').addClass('intClaOsc');
+			}
+
+			estado1 = '';
+		}else{
+
+			if($(this).hasClass('claro')){
+				estado1 = 'claro';
+				$(this).removeClass('claro');
+				$(this).addClass('oscuro');
+
+				$('#intermedio').removeClass('intClaOsc');
+				$('#intermedio').addClass('intOscOsc');
+			}else{
+				estado1 = 'oscuro';
+			}
+
+		}
+	});
+
+	$('#boton2').on('hover',function(){
+		//si tiene la clase clara, la quita y pone una oscura
+
+		if(estado2 != ''){
+
+			if(estado2 == 'claro'){
+				$(this).removeClass('oscuro').addClass('claro');				
+				$('#intermedio').removeClass('intOscOsc').addClass('intOscCla');
+			}
+
+			estado2 = '';
+		}else{
+
+			if($(this).hasClass('claro')){
+				estado2 = 'claro';
+				$(this).removeClass('claro').addClass('oscuro');
+				$('#intermedio').removeClass('intOscCla').addClass('intOscOsc');
+			}else{
+				estado2 = 'oscuro';
+			}
+
+		}
+	});
+
+	$('#boton1').on('click',function(){
+		if(estado1 == 'claro'){
+
+			$(this).removeClass('claro').addClass('oscuro');
+			$('#boton2').removeClass('oscuro').addClass('claro');
+			$('#intermedio').removeClass('intOscOsc').addClass('intOscCla');
+
+			estado1 = 'oscuro';
+
+			$('#conten_opcion2').fadeOut('fast');
+			$('#conten_opcion1').fadeIn('fast');
+		}
+
+	});
+
+	$('#boton2').on('click',function(){
+		if(estado2 == 'claro'){
+
+			$(this).removeClass('claro').addClass('oscuro');
+			$('#boton1').removeClass('oscuro').addClass('claro');
+			$('#intermedio').removeClass('intOscOsc').addClass('intClaOsc');
+
+			estado2 = 'oscuro';
+
+			$('#conten_opcion1').fadeOut('fast');
+			$('#conten_opcion2').fadeIn('fast');
+		}
+	});
+
+	$('.boton_extender').on('click',function(event){
+		event.preventDefault();
+		var extender_id = $(this).attr('id');
+		var id = obtenerId(extender_id);
+
+		var fecha = $(this).attr('class');
+		fecha = fecha.split(' ');
+		fecha = fecha[1];
+		fecha = fecha.split('_');
+
+		var fechaDesde = fecha[0];
+		fechaDesde = fechaDesde.split('/');
+		fechaDesde[2] = '20'+fechaDesde[2];
+		fechaDesde = fechaDesde.join('-');
+
+		var horaDesde = fecha[1]+':00';
+
+		var fechaHasta = fecha[2];
+		fechaHasta = fechaHasta.split('/');
+		fechaHasta[2] = '20'+fechaHasta[2];
+		fechaHasta = fechaHasta.join('-');
+
+		var horaHasta = fecha[3]+':00';
+
+		$('#datefrom_extender').val(fechaDesde);
+		$('#hour_from_extender').val(horaDesde);
+		$('#dateto_extender').val(fechaHasta);
+		$('#hour_to_extender').val(horaHasta);
+
+		$("#extender").dialog({
+	        resizable: false,
+	        width: 550,
+	        modal: false,
+	        autoOpen: false,
+	        closeOnEscape: false,
+	        title: 'Extender reserva',
+	        position: { my: "center", at: "center"},
+	        buttons: {
+	            "Aceptar": function() {
+	            	//confirmar datos
+	            	if(confirmarExtension()){
+		            	//ingresar datos a la bd
+		            	ingresarExtension(id);
+		                $( this ).dialog( "close" );
+	            	}
+	            },
+	            Cancelar: function() {
+	            	//limpiar campos de fecha
+	            	limpiarExtension();
+	                $( this ).dialog( "close" );
+	            }
+	        }
+	    });
+
+	    $('#extender').dialog('open');
+
+	})
+	
 
 });
 
@@ -903,4 +1076,72 @@ function limpiarContratos(tipo){
 	$('#contrato'+tipo+'1').removeAttr("checked");
 	$('#contrato'+tipo+'2').removeAttr("checked");
 	$('#contrato'+tipo+'3').removeAttr("checked");
+}
+
+function limpiarExtension(){
+	$('#datefrom_extender').val('');
+	$('#hour_from_extender').val('');
+	$('#dateto_extender').val('');
+	$('#hour_to_extender').val('');
+}
+
+function confirmarExtension(){
+	//todos los campos ingresados
+	var fechaDesde = $('#datefrom_extender').val();
+	var horaDesde = $('#hour_from_extender').val();
+	var fechaHasta = $('#dateto_extender').val();
+	var horaHasta = $('#hour_to_extender').val();
+
+	if(fechaDesde == ''){
+		alert('ingresar fecha');
+		return false;
+	}
+	if(horaDesde == ''){
+		alert('ingresar fecha');
+		return false;
+	}
+	if(fechaHasta == ''){
+		alert('ingresar fecha');
+		return false;
+	}
+	if(horaHasta == ''){
+		alert('ingresar fecha');
+		return false;
+	}
+
+	//fecha y hora hasta mayor que desde
+	var fechaCompletaDesde = obtenerFechaString(fechaDesde,horaDesde);
+	var fechaCompletaHasta = obtenerFechaString(fechaHasta,horaHasta);
+
+	//alert(fechaCompletaDesde);
+	//alert(fechaCompletaHasta);
+
+	if(fechaCompletaHasta<=fechaCompletaDesde){
+		alert('Debe ingresar una fecha de entrega superior a la de pedido');
+		return false;
+	}
+
+	return true;
+}
+
+function ingresarExtension(id){
+
+	var fechaHasta = $('#dateto_extender').val();
+	var horaHasta = $('#hour_to_extender').val();
+
+	$.ajax({
+		type:'post',
+		url: urlExtenderReserva,
+		data:{
+			id:id,
+			fechaHasta:fechaHasta,
+			horaHasta:horaHasta
+		}
+	}).done(function(){
+		//recargar la pgina
+		window.location.href = urlPedidos;
+
+	}).fail(function(){
+		alert('Ha ocurrido un error al extender la reserva, intntelo nuevamente');
+	});
 }
\ No newline at end of file
diff --git a/web/subida.jpg b/web/subida.jpg
new file mode 100755
index 0000000..68b85ac
Binary files /dev/null and b/web/subida.jpg differ
diff --git a/web/subida.pdf b/web/subida.pdf
new file mode 100755
index 0000000..b97e443
Binary files /dev/null and b/web/subida.pdf differ
diff --git a/web/subida.txt b/web/subida.txt
new file mode 100755
index 0000000..facee5f
--- /dev/null
+++ b/web/subida.txt
@@ -0,0 +1 @@
+hola!!
diff --git a/web/uploads/damages/1faf861f285338b42b3c2c4d5c980570.jpg b/web/uploads/damages/1faf861f285338b42b3c2c4d5c980570.jpg
old mode 100644
new mode 100755
diff --git a/web/uploads/testing.jpg b/web/uploads/testing.jpg
old mode 100644
new mode 100755
diff --git a/web/uploads/thumb_1359984711_DSC00574.JPG b/web/uploads/thumb_1359984711_DSC00574.JPG
old mode 100644
new mode 100755
diff --git a/web/uploads/thumb_1359984716_DSC00572.JPG b/web/uploads/thumb_1359984716_DSC00572.JPG
old mode 100644
new mode 100755
diff --git a/web/uploads/thumb_an100_al100__uploads_2ab19a8a7f4aec3319d99cf71a408c5d1d3fb987.jpg b/web/uploads/thumb_an100_al100__uploads_2ab19a8a7f4aec3319d99cf71a408c5d1d3fb987.jpg
old mode 100644
new mode 100755
diff --git a/web/uploads/thumb_an105_al150_1359984711_DSC00574.JPG b/web/uploads/thumb_an105_al150_1359984711_DSC00574.JPG
old mode 100644
new mode 100755
diff --git a/web/uploads/thumb_an112_al84__arriendas.testing_1359061067_mitsubishi.jpg b/web/uploads/thumb_an112_al84__arriendas.testing_1359061067_mitsubishi.jpg
old mode 100644
new mode 100755
diff --git a/web/uploads/thumb_an112_al84__arriendas.testing_1360073254_DSC00559.JPG b/web/uploads/thumb_an112_al84__arriendas.testing_1360073254_DSC00559.JPG
old mode 100644
new mode 100755
diff --git a/web/uploads/thumb_an112_al84__arriendas.testing_1360085389_nissanxtrail2.jpg b/web/uploads/thumb_an112_al84__arriendas.testing_1360085389_nissanxtrail2.jpg
old mode 100644
new mode 100755
diff --git a/web/uploads/thumb_an112_al84__arriendas.testing_1360088015_nissan-xtrail-2007_MEC-F-3075791640_082012.jpg b/web/uploads/thumb_an112_al84__arriendas.testing_1360088015_nissan-xtrail-2007_MEC-F-3075791640_082012.jpg
old mode 100644
new mode 100755
diff --git a/web/uploads/thumb_an112_al84__uploads_2ab19a8a7f4aec3319d99cf71a408c5d1d3fb987.jpg b/web/uploads/thumb_an112_al84__uploads_2ab19a8a7f4aec3319d99cf71a408c5d1d3fb987.jpg
new file mode 100755
index 0000000..fabf5e1
Binary files /dev/null and b/web/uploads/thumb_an112_al84__uploads_2ab19a8a7f4aec3319d99cf71a408c5d1d3fb987.jpg differ
diff --git a/web/uploads/thumb_an112_al84__uploads_65e0102a64360e5f961553ebef9d38577c215479.jpg b/web/uploads/thumb_an112_al84__uploads_65e0102a64360e5f961553ebef9d38577c215479.jpg
new file mode 100755
index 0000000..5954471
Binary files /dev/null and b/web/uploads/thumb_an112_al84__uploads_65e0102a64360e5f961553ebef9d38577c215479.jpg differ
diff --git a/web/uploads/thumb_an112_al84__uploads_787b5a90aeb84466900fb63fe6de976e32b2a1a2.jpg b/web/uploads/thumb_an112_al84__uploads_787b5a90aeb84466900fb63fe6de976e32b2a1a2.jpg
new file mode 100755
index 0000000..4b1ae0f
Binary files /dev/null and b/web/uploads/thumb_an112_al84__uploads_787b5a90aeb84466900fb63fe6de976e32b2a1a2.jpg differ
diff --git a/web/uploads/thumb_an112_al84__uploads_9f86c4721ec328a506b7b1c41cf2826a5e26742f.jpg b/web/uploads/thumb_an112_al84__uploads_9f86c4721ec328a506b7b1c41cf2826a5e26742f.jpg
old mode 100644
new mode 100755
diff --git a/web/uploads/thumb_an112_al84__uploads_dcced3f46e6f415c4f3fb5999c1bbd71897ce911.jpg b/web/uploads/thumb_an112_al84__uploads_dcced3f46e6f415c4f3fb5999c1bbd71897ce911.jpg
new file mode 100755
index 0000000..52c525e
Binary files /dev/null and b/web/uploads/thumb_an112_al84__uploads_dcced3f46e6f415c4f3fb5999c1bbd71897ce911.jpg differ
diff --git a/web/uploads/thumb_an112_al84__uploads_e42f6350e204119632316dc40b861baec5b1ac27.jpg b/web/uploads/thumb_an112_al84__uploads_e42f6350e204119632316dc40b861baec5b1ac27.jpg
new file mode 100755
index 0000000..aa52c5d
Binary files /dev/null and b/web/uploads/thumb_an112_al84__uploads_e42f6350e204119632316dc40b861baec5b1ac27.jpg differ
diff --git a/web/uploads/thumb_an200_al200_1359151725_DSC00514.JPG b/web/uploads/thumb_an200_al200_1359151725_DSC00514.JPG
old mode 100644
new mode 100755
diff --git a/web/uploads/thumb_an64_al61__uploads_2ab19a8a7f4aec3319d99cf71a408c5d1d3fb987.jpg b/web/uploads/thumb_an64_al61__uploads_2ab19a8a7f4aec3319d99cf71a408c5d1d3fb987.jpg
old mode 100644
new mode 100755
diff --git a/web/uploads/thumb_an64_al64__arriendas.testing_1358515099_DSC00634.JPG b/web/uploads/thumb_an64_al64__arriendas.testing_1358515099_DSC00634.JPG
old mode 100644
new mode 100755
diff --git a/web/uploads/thumb_an64_al64__arriendas.testing_1358778893_images.jpg b/web/uploads/thumb_an64_al64__arriendas.testing_1358778893_images.jpg
old mode 100644
new mode 100755
diff --git a/web/uploads/thumb_an64_al64__arriendas.testing_1358955949_1332724647_334219853_1-Hyundai-i10-12-Kappa-Sportz-for-sale-21000-KM-Anand-Vihar.jpg b/web/uploads/thumb_an64_al64__arriendas.testing_1358955949_1332724647_334219853_1-Hyundai-i10-12-Kappa-Sportz-for-sale-21000-KM-Anand-Vihar.jpg
old mode 100644
new mode 100755
diff --git a/web/uploads/thumb_an64_al64__arriendas.testing_1359061067_mitsubishi.jpg b/web/uploads/thumb_an64_al64__arriendas.testing_1359061067_mitsubishi.jpg
old mode 100644
new mode 100755
diff --git a/web/uploads/thumb_an64_al64__arriendas.testing_1359151725_DSC00514.JPG b/web/uploads/thumb_an64_al64__arriendas.testing_1359151725_DSC00514.JPG
old mode 100644
new mode 100755
diff --git a/web/uploads/thumb_an64_al64__arriendas.testing_1360073081_DSC00576.JPG b/web/uploads/thumb_an64_al64__arriendas.testing_1360073081_DSC00576.JPG
old mode 100644
new mode 100755
diff --git a/web/uploads/thumb_an64_al64__arriendas.testing_1360073254_DSC00559.JPG b/web/uploads/thumb_an64_al64__arriendas.testing_1360073254_DSC00559.JPG
old mode 100644
new mode 100755
diff --git a/web/uploads/thumb_an64_al64__arriendas.testing_1360073950_IMG_2757.JPG b/web/uploads/thumb_an64_al64__arriendas.testing_1360073950_IMG_2757.JPG
old mode 100644
new mode 100755
diff --git a/web/uploads/thumb_an64_al64__arriendas.testing_1360074823_DSC00837.JPG b/web/uploads/thumb_an64_al64__arriendas.testing_1360074823_DSC00837.JPG
old mode 100644
new mode 100755
diff --git a/web/uploads/thumb_an64_al64__arriendas.testing_1360083766_hyundai.jpg b/web/uploads/thumb_an64_al64__arriendas.testing_1360083766_hyundai.jpg
old mode 100644
new mode 100755
diff --git a/web/uploads/thumb_an64_al64__arriendas.testing_1360085389_nissanxtrail2.jpg b/web/uploads/thumb_an64_al64__arriendas.testing_1360085389_nissanxtrail2.jpg
old mode 100644
new mode 100755
diff --git a/web/uploads/thumb_an64_al64__arriendas.testing_1360088015_nissan-xtrail-2007_MEC-F-3075791640_082012.jpg b/web/uploads/thumb_an64_al64__arriendas.testing_1360088015_nissan-xtrail-2007_MEC-F-3075791640_082012.jpg
old mode 100644
new mode 100755
diff --git a/web/uploads/thumb_an64_al64__arriendas.testing_1360089318_1343674808_249796085_2-NISSAN-XTRAIL-2010-San-Felipe.jpg b/web/uploads/thumb_an64_al64__arriendas.testing_1360089318_1343674808_249796085_2-NISSAN-XTRAIL-2010-San-Felipe.jpg
old mode 100644
new mode 100755
diff --git a/web/uploads/thumb_an64_al64__arriendas.testing_1360089938_Nissan-Murano-Le-Cvt-4x-Hwo-Ao-20121027042153.jpg b/web/uploads/thumb_an64_al64__arriendas.testing_1360089938_Nissan-Murano-Le-Cvt-4x-Hwo-Ao-20121027042153.jpg
old mode 100644
new mode 100755
diff --git a/web/uploads/thumb_an64_al64__uploads_05bbf61f863e892a1fe55dc93b7e45d89f0d2f35.jpg b/web/uploads/thumb_an64_al64__uploads_05bbf61f863e892a1fe55dc93b7e45d89f0d2f35.jpg
old mode 100644
new mode 100755
diff --git a/web/uploads/thumb_an64_al64__uploads_07801f96262c838ae0154c47c5372f9b9f9685ea.jpg b/web/uploads/thumb_an64_al64__uploads_07801f96262c838ae0154c47c5372f9b9f9685ea.jpg
old mode 100644
new mode 100755
diff --git a/web/uploads/thumb_an64_al64__uploads_0d5e6f942bc0887bcafa7c1552ef4dde24173db3.jpg b/web/uploads/thumb_an64_al64__uploads_0d5e6f942bc0887bcafa7c1552ef4dde24173db3.jpg
old mode 100644
new mode 100755
diff --git a/web/uploads/thumb_an64_al64__uploads_14ffa677a72e42aa3aaca2e7706aef2ae612b309.jpg b/web/uploads/thumb_an64_al64__uploads_14ffa677a72e42aa3aaca2e7706aef2ae612b309.jpg
old mode 100644
new mode 100755
diff --git a/web/uploads/thumb_an64_al64__uploads_16353966dcb70f40c6d69bb6407d70ccb533da62.jpg b/web/uploads/thumb_an64_al64__uploads_16353966dcb70f40c6d69bb6407d70ccb533da62.jpg
old mode 100644
new mode 100755
diff --git a/web/uploads/thumb_an64_al64__uploads_1a06ca59e81895689567e0c0e3821a4a0ef5d2d8.jpg b/web/uploads/thumb_an64_al64__uploads_1a06ca59e81895689567e0c0e3821a4a0ef5d2d8.jpg
old mode 100644
new mode 100755
diff --git a/web/uploads/thumb_an64_al64__uploads_1ad342734c7859db0bf9a9b289a10bc42ba6c5f1.jpg b/web/uploads/thumb_an64_al64__uploads_1ad342734c7859db0bf9a9b289a10bc42ba6c5f1.jpg
old mode 100644
new mode 100755
diff --git a/web/uploads/thumb_an64_al64__uploads_1dc6f311731c3e8949dfa1b48547b6d4ff697fa3.jpg b/web/uploads/thumb_an64_al64__uploads_1dc6f311731c3e8949dfa1b48547b6d4ff697fa3.jpg
old mode 100644
new mode 100755
diff --git a/web/uploads/thumb_an64_al64__uploads_1f36828110b62a1b01de1d51b929058229343275.jpg b/web/uploads/thumb_an64_al64__uploads_1f36828110b62a1b01de1d51b929058229343275.jpg
old mode 100644
new mode 100755
diff --git a/web/uploads/thumb_an64_al64__uploads_265f1d7b42fbfa582b3bf06422c77b30e9f35f26.jpg b/web/uploads/thumb_an64_al64__uploads_265f1d7b42fbfa582b3bf06422c77b30e9f35f26.jpg
old mode 100644
new mode 100755
diff --git a/web/uploads/thumb_an64_al64__uploads_2ab19a8a7f4aec3319d99cf71a408c5d1d3fb987.jpg b/web/uploads/thumb_an64_al64__uploads_2ab19a8a7f4aec3319d99cf71a408c5d1d3fb987.jpg
old mode 100644
new mode 100755
diff --git a/web/uploads/thumb_an64_al64__uploads_3efe3300d38fe931afe678043baa8d07150496eb.jpg b/web/uploads/thumb_an64_al64__uploads_3efe3300d38fe931afe678043baa8d07150496eb.jpg
old mode 100644
new mode 100755
diff --git a/web/uploads/thumb_an64_al64__uploads_462dd2dd9c91ddec9eafb9305dc0d563b95864c3.jpg b/web/uploads/thumb_an64_al64__uploads_462dd2dd9c91ddec9eafb9305dc0d563b95864c3.jpg
old mode 100644
new mode 100755
diff --git a/web/uploads/thumb_an64_al64__uploads_4a1decb80764f7b4d692ba61fcd9c6599505c9ce.jpg b/web/uploads/thumb_an64_al64__uploads_4a1decb80764f7b4d692ba61fcd9c6599505c9ce.jpg
old mode 100644
new mode 100755
diff --git a/web/uploads/thumb_an64_al64__uploads_4a78317c97b99a351d4d8e8e48398220842e89c0.jpg b/web/uploads/thumb_an64_al64__uploads_4a78317c97b99a351d4d8e8e48398220842e89c0.jpg
old mode 100644
new mode 100755
diff --git a/web/uploads/thumb_an64_al64__uploads_502870413f797d8ebc9bf2d148b1265f0715bbdf.jpg b/web/uploads/thumb_an64_al64__uploads_502870413f797d8ebc9bf2d148b1265f0715bbdf.jpg
old mode 100644
new mode 100755
diff --git a/web/uploads/thumb_an64_al64__uploads_53b4a3c0fa36011983220465f05278fc318f212c.jpg b/web/uploads/thumb_an64_al64__uploads_53b4a3c0fa36011983220465f05278fc318f212c.jpg
old mode 100644
new mode 100755
diff --git a/web/uploads/thumb_an64_al64__uploads_651acc92f11c9adba0daae54dd24db398b169473.jpg b/web/uploads/thumb_an64_al64__uploads_651acc92f11c9adba0daae54dd24db398b169473.jpg
old mode 100644
new mode 100755
diff --git a/web/uploads/thumb_an64_al64__uploads_65e0102a64360e5f961553ebef9d38577c215479.jpg b/web/uploads/thumb_an64_al64__uploads_65e0102a64360e5f961553ebef9d38577c215479.jpg
old mode 100644
new mode 100755
diff --git a/web/uploads/thumb_an64_al64__uploads_6fda1bbabd5d15cac60c027175715319fa348ad2.jpg b/web/uploads/thumb_an64_al64__uploads_6fda1bbabd5d15cac60c027175715319fa348ad2.jpg
old mode 100644
new mode 100755
diff --git a/web/uploads/thumb_an64_al64__uploads_7669ee614902b5990e38eff1f8687e3b0622e6cf.jpg b/web/uploads/thumb_an64_al64__uploads_7669ee614902b5990e38eff1f8687e3b0622e6cf.jpg
old mode 100644
new mode 100755
diff --git a/web/uploads/thumb_an64_al64__uploads_787b5a90aeb84466900fb63fe6de976e32b2a1a2.jpg b/web/uploads/thumb_an64_al64__uploads_787b5a90aeb84466900fb63fe6de976e32b2a1a2.jpg
old mode 100644
new mode 100755
diff --git a/web/uploads/thumb_an64_al64__uploads_79a4550c84b8ea79d02dbd34323650e65de040b7.jpg b/web/uploads/thumb_an64_al64__uploads_79a4550c84b8ea79d02dbd34323650e65de040b7.jpg
old mode 100644
new mode 100755
diff --git a/web/uploads/thumb_an64_al64__uploads_88eb5482c49c32807f37cac4f8723912400a0dbc.jpg b/web/uploads/thumb_an64_al64__uploads_88eb5482c49c32807f37cac4f8723912400a0dbc.jpg
old mode 100644
new mode 100755
diff --git a/web/uploads/thumb_an64_al64__uploads_9869a700ad36cfd75a808bf784d1a7e210f532b8.jpg b/web/uploads/thumb_an64_al64__uploads_9869a700ad36cfd75a808bf784d1a7e210f532b8.jpg
old mode 100644
new mode 100755
diff --git a/web/uploads/thumb_an64_al64__uploads_98a46f564e5c2415d31bbb36b82770c3b4b99b15.jpg b/web/uploads/thumb_an64_al64__uploads_98a46f564e5c2415d31bbb36b82770c3b4b99b15.jpg
old mode 100644
new mode 100755
diff --git a/web/uploads/thumb_an64_al64__uploads_9c4b7d2c12cc697b51ca3858a8694916e6b52705.jpg b/web/uploads/thumb_an64_al64__uploads_9c4b7d2c12cc697b51ca3858a8694916e6b52705.jpg
old mode 100644
new mode 100755
diff --git a/web/uploads/thumb_an64_al64__uploads_9f86c4721ec328a506b7b1c41cf2826a5e26742f.jpg b/web/uploads/thumb_an64_al64__uploads_9f86c4721ec328a506b7b1c41cf2826a5e26742f.jpg
old mode 100644
new mode 100755
diff --git a/web/uploads/thumb_an64_al64__uploads_a5e016bd7049e4ee9794aa13cb4b072aeab29c86.jpg b/web/uploads/thumb_an64_al64__uploads_a5e016bd7049e4ee9794aa13cb4b072aeab29c86.jpg
old mode 100644
new mode 100755
diff --git a/web/uploads/thumb_an64_al64__uploads_a82069076a586ae9e099ebf25b7b1a2fec5ee845.jpg b/web/uploads/thumb_an64_al64__uploads_a82069076a586ae9e099ebf25b7b1a2fec5ee845.jpg
old mode 100644
new mode 100755
diff --git a/web/uploads/thumb_an64_al64__uploads_b850c6a46a3e7347df42d00d453b00d5a524f3a4.jpg b/web/uploads/thumb_an64_al64__uploads_b850c6a46a3e7347df42d00d453b00d5a524f3a4.jpg
old mode 100644
new mode 100755
diff --git a/web/uploads/thumb_an64_al64__uploads_c8d3cda22b7eb37d3108ceb5898879c628c961ad.jpg b/web/uploads/thumb_an64_al64__uploads_c8d3cda22b7eb37d3108ceb5898879c628c961ad.jpg
old mode 100644
new mode 100755
diff --git a/web/uploads/thumb_an64_al64__uploads_d2b74784c6eec248bccc6b06228b2fcc444cae78.jpg b/web/uploads/thumb_an64_al64__uploads_d2b74784c6eec248bccc6b06228b2fcc444cae78.jpg
old mode 100644
new mode 100755
diff --git a/web/uploads/thumb_an64_al64__uploads_dcced3f46e6f415c4f3fb5999c1bbd71897ce911.jpg b/web/uploads/thumb_an64_al64__uploads_dcced3f46e6f415c4f3fb5999c1bbd71897ce911.jpg
old mode 100644
new mode 100755
diff --git a/web/uploads/thumb_an64_al64__uploads_df09c6f036261c060381728b35d0589d4e54dcb3.jpg b/web/uploads/thumb_an64_al64__uploads_df09c6f036261c060381728b35d0589d4e54dcb3.jpg
old mode 100644
new mode 100755
diff --git a/web/uploads/thumb_an64_al64__uploads_e42f6350e204119632316dc40b861baec5b1ac27.jpg b/web/uploads/thumb_an64_al64__uploads_e42f6350e204119632316dc40b861baec5b1ac27.jpg
old mode 100644
new mode 100755
diff --git a/web/uploads/thumb_an64_al64__uploads_e63f58dc207380399d297a57dfef4947f6171d03.jpg b/web/uploads/thumb_an64_al64__uploads_e63f58dc207380399d297a57dfef4947f6171d03.jpg
old mode 100644
new mode 100755
diff --git a/web/uploads/thumb_an64_al64__uploads_ec7f0a7610df5ce9ede893554ff89ac89b4653b4.jpg b/web/uploads/thumb_an64_al64__uploads_ec7f0a7610df5ce9ede893554ff89ac89b4653b4.jpg
old mode 100644
new mode 100755
diff --git a/web/uploads/thumb_an64_al64__uploads_edc415ed8fb0e3ffc0b61b72efeb659cf0d84a26.jpg b/web/uploads/thumb_an64_al64__uploads_edc415ed8fb0e3ffc0b61b72efeb659cf0d84a26.jpg
old mode 100644
new mode 100755
diff --git a/web/uploads/thumb_an80_al80__uploads_2ab19a8a7f4aec3319d99cf71a408c5d1d3fb987.jpg b/web/uploads/thumb_an80_al80__uploads_2ab19a8a7f4aec3319d99cf71a408c5d1d3fb987.jpg
old mode 100644
new mode 100755
